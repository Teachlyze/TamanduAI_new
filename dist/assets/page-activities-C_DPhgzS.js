import{r as c,j as e,aY as j,F as p,aZ as w,T as g}from"./react-vendor-C2HUFn5N.js";import{s as l,B as o,C as v,b as y,d as N,e as C}from"./lazy-CreateActivityPage.jsx-DYBofU2F.js";import{g as d}from"./page-ActivitiesListPage.jsx-Cv5lq7oV.js";import{u as E}from"./vendor-react-router-B4Bn0PSh.js";const m="activity-drafts";async function b(s){const r=await d();if(!r)throw new Error("User not authenticated");const n=`${r.id}/${s}.json`,{error:a}=await l.storage.from(m).remove([n]);if(a)throw a;return!0}async function I(){const s=await d();if(!s)throw new Error("User not authenticated");const{data:r,error:n}=await l.storage.from(m).list(s.id,{limit:100,sortBy:{column:"created_at",order:"desc"}});if(n)throw n;return(r||[]).filter(a=>a.name.endsWith(".json")).map(a=>({draftId:a.name.replace(".json",""),name:a.name,created_at:a.created_at,updated_at:a.updated_at,size:a.metadata?.size||a.size}))}function T(){const[s,r]=c.useState([]),[n,a]=c.useState(!1),x=E(),i=c.useCallback(async()=>{try{a(!0);const t=await I();r(t)}catch(t){console.warn("Erro ao listar rascunhos:",t)}finally{a(!1)}},[]);c.useEffect(()=>{i()},[i]);const h=async t=>{x(`/dashboard/activities/create?draftId=${encodeURIComponent(t)}`)},u=async t=>{if(confirm("Remover este rascunho?"))try{await b(t),await i()}catch(f){console.warn("Erro ao remover rascunho:",f)}};return e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Rascunhos de Atividades"}),e.jsxs(o,{onClick:i,className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4"})," Atualizar"]})]}),e.jsxs(v,{children:[e.jsx(y,{children:e.jsx(N,{children:"Meus rascunhos"})}),e.jsx(C,{children:n?e.jsx("div",{className:"py-10 text-center text-gray-500",children:"Carregando..."}):s.length===0?e.jsx("div",{className:"py-10 text-center text-gray-500",children:"Nenhum rascunho encontrado"}):e.jsx("ul",{className:"divide-y",children:s.map(t=>e.jsxs("li",{className:"py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Atualizado: ",new Date(t.updated_at||t.created_at).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(o,{variant:"outline",onClick:()=>h(t.draftId),className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4"})," Continuar edição"]}),e.jsxs(o,{variant:"destructive",onClick:()=>u(t.draftId),className:"flex items-center gap-2",children:[e.jsx(g,{className:"w-4 h-4"})," Excluir"]})]})]},t.draftId))})})]})]})}export{T as default};
