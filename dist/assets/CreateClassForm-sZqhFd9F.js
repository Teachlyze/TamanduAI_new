import{s as d,aW as I,g as ae,u as se,r as E,a_ as re,j as e,m as N,i as S,bj as ie,J as A,K as F,N as D,B as le,O as T,Q as O,bk as u,bl as x,bm as g,bn as p,a2 as _,bo as j,aA as Y,aB as H,aC as J,aD as Q,aE as m,ay as oe,bp as K,d as ne,U as te,a3 as W,Y as ce,a4 as de,af as k}from"./main-Bujpyeg-.js";import{a as me,S as he,o as ue,b as z,s as f,n as xe}from"./separator-CTmKKSrl.js";import{t as X}from"./teacherSubscriptionService-D15xsWsN.js";import{t as R}from"./use-toast-9Xc4qRbM.js";import{B as ge}from"./badge-BFkPUQ-P.js";import{A as pe,a as je}from"./alert-mM_jJWFf.js";import{A as be}from"./arrow-left-BInWdvd2.js";import{T as Z}from"./triangle-alert-Cw-mO2fL.js";import{S as fe}from"./school-EPFUJQxG.js";import{P as ve}from"./plus-C0dvgUSL.js";import{G as we}from"./graduation-cap-Ch-mLRIV.js";const ye={async getClasses({teacherId:r,studentId:i,activeOnly:s=!0}={}){let n=d.from("classes").select(`
        *,
        members:class_members(*, user:profiles(*)),
        meetings:meetings(*)
      `).order("name",{ascending:!0});r&&(n=n.eq("created_by",r)),s&&(n=n.eq("is_active",!0));const{data:l,error:h}=await n;if(h)throw console.error("Error fetching classes:",h),h;return i?l.filter(b=>b.members?.some(v=>v.user_id===i&&v.role==="student")):l},async getClassById(r){const{data:i,error:s}=await d.from("classes").select(`
        *,
        members:class_members(*, user:profiles(*)),
        meetings:meetings(*, 
          participants:meeting_participants(*, user:profiles(*))
        )
      `).eq("id",r).single();if(s)throw console.error(`Error fetching class ${r}:`,s),s;return i},async createClass(r,i=[]){const{name:s,description:n,teacher_id:l,subject:h,course:b,period:v,grade_level:w,academic_year:q,color:y,student_capacity:M,chatbot_enabled:V,school_id:L,is_school_managed:c}=r,{data:P,error:B}=await d.from("profiles").select("id").eq("id",l).maybeSingle();if(!P&&!B){console.log("Profile not found for teacher, creating one...");const{error:t}=await d.from("profiles").insert([{id:l,role:"teacher",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]);if(t&&(console.error("Error creating teacher profile:",t),t.code!=="23505"))throw new Error(`Erro ao criar perfil do professor: ${t.message}`)}const $={name:s,description:n||null,created_by:l,subject:h||null,course:b||null,period:v||null,grade_level:w||null,academic_year:q||new Date().getFullYear(),color:y||"#6366f1",student_capacity:typeof M=="number"?M:30,chatbot_enabled:!!V,school_id:L||null,is_school_managed:!!c,is_active:!0};console.log("Creating class with data:",$);const{data:a,error:o}=await d.from("classes").insert([$]).select().single();if(o)throw console.error("Error creating class:",o),console.error("Error details:",{code:o.code,message:o.message,details:o.details,hint:o.hint}),new Error(`Erro ao criar turma: ${o.message}. Detalhes: ${o.hint||o.details||"Nenhum detalhe adicional"}`);console.log("Class created successfully:",a);try{await I.send("classCreated",{userId:l,variables:{className:s},channelOverride:"push",metadata:{classId:a.id}})}catch(t){console.warn("Falha ao notificar criação de turma:",t)}try{const{error:t}=await d.from("class_members").insert([{class_id:a.id,user_id:l,role:"teacher",joined_at:new Date().toISOString()}]);t&&t.code!=="23505"&&console.warn("Erro ao adicionar professor como membro:",t)}catch(t){console.warn("Falha ao adicionar professor como membro da turma:",t)}if(i&&i.length>0)try{await this.addStudentsToClass(a.id,i)}catch(t){console.warn("Falha ao adicionar alunos:",t)}if(V)try{const{error:t}=await d.from("chatbot_configurations").insert({class_id:a.id,enabled:!0,keywords:[],themes:[],scope_restrictions:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()});t&&t.code!=="23505"?console.warn("Erro ao criar configuração do chatbot:",t):console.log("Chatbot configuration created for class:",a.id)}catch(t){console.warn("Falha ao inicializar chatbot:",t)}return this.getClassById(a.id)},async updateClass(r,i,s){const{error:n}=await d.from("classes").update({...i,updated_at:new Date().toISOString()}).eq("id",r);if(n)throw console.error(`Error updating class ${r}:`,n),n;if(Array.isArray(s)){const{data:l}=await d.from("class_members").select("user_id").eq("class_id",r).eq("role","student"),h=(l||[]).map(w=>w.user_id),b=s.filter(w=>!h.includes(w)),v=h.filter(w=>!s.includes(w));await Promise.all([this.addStudentsToClass(r,b),this.removeStudentsFromClass(r,v)])}return this.getClassById(r)},async deleteClass(r){const{error:i}=await d.from("classes").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",r);if(i)throw console.error(`Error deleting class ${r}:`,i),i;return!0},async addStudentsToClass(r,i){if(!i||i.length===0)return[];const{data:s,error:n}=await d.from("class_members").insert(i.map(l=>({class_id:r,user_id:l,role:"student",created_at:new Date().toISOString()}))).select();if(n)throw console.error(`Error adding students to class ${r}:`,n),n;try{const[{data:l},{data:h}]=await Promise.all([d.from("classes").select("id, name, created_by").eq("id",r).single(),d.from("profiles").select("id, full_name").in("id",i)]);if(l?.created_by&&h?.length)for(const b of h)await I.send("studentAddedToClass",{userId:l.created_by,variables:{studentName:b.full_name||"Aluno",className:l.name||"Turma"},channelOverride:"push",metadata:{classId:r,studentId:b.id}})}catch(l){console.warn("Falha ao notificar alunos adicionados:",l)}return s},async removeStudentsFromClass(r,i){if(!i||i.length===0)return!0;const{error:s}=await d.from("class_members").delete().eq("class_id",r).in("user_id",i).eq("role","student");if(s)throw console.error(`Error removing students from class ${r}:`,s),s;try{const[{data:n},{data:l}]=await Promise.all([d.from("classes").select("id, name").eq("id",r).single(),d.from("profiles").select("id, full_name").in("id",i)]);for(const h of l||[])await I.send("studentRemovedFromClass",{userId:h.id,email:void 0,variables:{className:n?.name||"Turma"},metadata:{classId:r}})}catch(n){console.warn("Falha ao notificar alunos removidos:",n)}return!0},async searchClasses(r,{onlyActive:i=!0}={}){let s=d.from("classes").select("*").or(`name.ilike.%${r}%,description.ilike.%${r}%`);i&&(s=s.eq("is_active",!0));const{data:n,error:l}=await s;if(l)throw console.error("Error searching classes:",l),l;return n},subscribeToClasses(r){const i=d.channel("classes_changes").on("postgres_changes",{event:"*",schema:"public",table:"classes"},s=>{r(s)}).subscribe();return()=>{d.removeChannel(i)}}},_e=ue({name:f().min(3,"Nome da turma deve ter pelo menos 3 caracteres"),subject:f().min(2,"Matéria é obrigatória"),description:f().optional(),course:f().optional(),period:f().optional(),academic_year:f().min(1,"Ano letivo é obrigatório"),grade_level:f().min(1,"Série é obrigatória"),student_capacity:xe().min(1,"Capacidade deve ser pelo menos 1").max(100,"Capacidade máxima é 100"),color:f().min(1,"Selecione uma cor"),room_number:f().optional(),is_online:z().default(!1),meeting_link:f().optional(),chatbot_enabled:z().default(!1),school_id:f().optional(),is_school_managed:z().default(!1)}),Me=()=>{const r=ae(),{user:i}=se(),[s,n]=E.useState(!1),[l,h]=E.useState([]),[b,v]=E.useState(null),[w,q]=E.useState(!1),[y,M]=E.useState(null),V=[{name:"Azul",value:"blue",class:"bg-blue-500"},{name:"Verde",value:"green",class:"bg-green-500"},{name:"Roxo",value:"purple",class:"bg-purple-500"},{name:"Rosa",value:"pink",class:"bg-pink-500"},{name:"Laranja",value:"orange",class:"bg-orange-500"},{name:"Vermelho",value:"red",class:"bg-red-500"},{name:"Amarelo",value:"yellow",class:"bg-yellow-500"},{name:"Índigo",value:"indigo",class:"bg-indigo-500"}],L=[{id:1,name:"Ana Silva",email:"ana@email.com"},{id:2,name:"João Santos",email:"joao@email.com"},{id:3,name:"Maria Oliveira",email:"maria@email.com"},{id:4,name:"Pedro Costa",email:"pedro@email.com"},{id:5,name:"Carla Souza",email:"carla@email.com"}],c=re({resolver:me(_e),defaultValues:{name:"",subject:"",description:"",course:"",period:"",academic_year:new Date().getFullYear().toString(),grade_level:"",student_capacity:30,room_number:"",is_online:!1,meeting_link:"",color:"blue",chatbot_enabled:!1,school_id:"",is_school_managed:!1}}),P=async a=>{if(!i){R({variant:"destructive",title:"Erro de autenticação",description:"Você precisa estar logado para criar uma turma."});return}n(!0),v(null);try{if(!await X.checkCanCreateClass(i.id)){const C=await X.getUsageStats(i.id);M(C),q(!0),n(!1);return}k.info("Iniciando criação de turma",{teacherId:i.id,className:a.name,subject:a.subject});const t={name:a.name,description:a.description||"",created_by:i.id,teacher_id:i.id,subject:a.subject,course:a.course||"",period:a.period||"",grade_level:a.grade_level,academic_year:a.academic_year,color:a.color,student_capacity:a.student_capacity,room_number:a.room_number||"",is_online:a.is_online||!1,meeting_link:a.meeting_link||"",chatbot_enabled:!!a.chatbot_enabled,school_id:a.school_id||null,is_school_managed:!!a.is_school_managed,is_active:!0};k.info("Dados da turma para criação:",t);const G=await ye.createClass(t);k.info("Turma criada com sucesso",{classId:G.id,className:G.name});let U=null;try{}catch(C){k.warn("Falha ao gerar convite padrão da turma",{error:C.message})}if(l&&l.length>0){for(const C of l)if(C.email)try{}catch(ee){k.warn("Falha ao gerar convite para aluno",{email:C.email,error:ee.message})}}R({title:"✅ Turma criada com sucesso!",description:U?`Convite gerado. Copie o link para compartilhar: ${U}`:`A turma "${a.name}" foi criada e está pronta para receber alunos.`}),setTimeout(()=>r("/dashboard/classes"),1200)}catch(o){k.error("Erro ao criar turma",{error:o.message,teacherId:i.id}),v(o.message),R({variant:"destructive",title:"❌ Erro ao criar turma",description:o.message||"Não foi possível criar a turma. Verifique sua conexão e tente novamente."})}finally{n(!1)}},B=a=>{l.find(o=>o.id===a.id)||h([...l,a])},$=a=>{h(l.filter(o=>o.id!==a))};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:e.jsxs("div",{className:"w-full space-y-8 p-6",children:[e.jsxs(N.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative overflow-hidden bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 rounded-3xl p-8 text-white",children:[e.jsx("div",{className:"absolute inset-0 bg-black/10"}),e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>r("/dashboard/classes"),className:"text-white hover:bg-white/20 h-10 w-10",disabled:s,children:e.jsx(be,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Nova Turma"}),e.jsx("p",{className:"text-purple-100 text-lg",children:"Crie uma nova turma e comece a ensinar"})]})]})}),e.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/10 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-8 -left-8 w-32 h-32 bg-white/5 rounded-full blur-2xl"})]}),b&&e.jsx(N.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:e.jsxs(pe,{variant:"destructive",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx(je,{children:b})]})}),e.jsx(ie,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(P),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(N.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:e.jsxs(A,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(F,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(le,{className:"w-4 h-4 text-white"})}),"Informações Básicas"]}),e.jsx(T,{children:"Defina as informações principais da turma"})]}),e.jsxs(O,{className:"space-y-4",children:[e.jsx(u,{control:c.control,name:"name",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Nome da Turma"}),e.jsx(p,{children:e.jsx(_,{placeholder:"Ex: Matemática 9A",...a,disabled:s})}),e.jsx(j,{})]})}),e.jsx(u,{control:c.control,name:"subject",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Matéria"}),e.jsxs(Y,{onValueChange:a.onChange,defaultValue:a.value,disabled:s,children:[e.jsx(p,{children:e.jsx(H,{children:e.jsx(J,{placeholder:"Selecione a matéria"})})}),e.jsxs(Q,{children:[e.jsx(m,{value:"matematica",children:"Matemática"}),e.jsx(m,{value:"portugues",children:"Português"}),e.jsx(m,{value:"ciencias",children:"Ciências"}),e.jsx(m,{value:"historia",children:"História"}),e.jsx(m,{value:"geografia",children:"Geografia"}),e.jsx(m,{value:"fisica",children:"Física"}),e.jsx(m,{value:"quimica",children:"Química"}),e.jsx(m,{value:"biologia",children:"Biologia"}),e.jsx(m,{value:"ingles",children:"Inglês"}),e.jsx(m,{value:"educacao_fisica",children:"Educação Física"}),e.jsx(m,{value:"artes",children:"Artes"})]})]}),e.jsx(j,{})]})}),e.jsx(u,{control:c.control,name:"description",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Descrição (Opcional)"}),e.jsx(p,{children:e.jsx(oe,{placeholder:"Descreva os objetivos e conteúdo da turma...",className:"min-h-[100px]",...a,disabled:s})}),e.jsx(j,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(u,{control:c.control,name:"course",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Course (Opcional)"}),e.jsx(p,{children:e.jsx(_,{placeholder:"Ex: STEM, Linguagens",...a,disabled:s})}),e.jsx(j,{})]})}),e.jsx(u,{control:c.control,name:"period",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Period (Opcional)"}),e.jsx(p,{children:e.jsx(_,{placeholder:"Ex: morning, afternoon, night",...a,disabled:s})}),e.jsx(j,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(u,{control:c.control,name:"room_number",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Número da Sala (Opcional)"}),e.jsx(p,{children:e.jsx(_,{placeholder:"Ex: Sala 12, Lab A",...a,disabled:s})}),e.jsx(j,{})]})}),e.jsx(u,{control:c.control,name:"is_online",render:({field:a})=>e.jsxs(x,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(g,{children:"Aula Online"}),e.jsx(K,{className:"text-xs",children:"Marque se a turma é online"})]}),e.jsx(p,{children:e.jsx("input",{type:"checkbox",checked:a.value,onChange:a.onChange,disabled:s,className:"w-4 h-4"})})]})})]}),c.watch("is_online")&&e.jsx(u,{control:c.control,name:"meeting_link",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Link da Reunião"}),e.jsx(p,{children:e.jsx(_,{placeholder:"Ex: https://meet.google.com/...",...a,disabled:s})}),e.jsx(j,{})]})})]})]})}),e.jsx(N.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:e.jsxs(A,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(F,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-green-600 rounded-lg flex items-center justify-center",children:e.jsx(ne,{className:"w-4 h-4 text-white"})}),"Ano letivo e nível"]}),e.jsx(T,{children:"Configure o ano letivo e o nível/série"})]}),e.jsx(O,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(u,{control:c.control,name:"academic_year",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Ano letivo"}),e.jsx(p,{children:e.jsx(_,{placeholder:"Ex: 2025",...a,disabled:s})}),e.jsx(j,{})]})}),e.jsx(u,{control:c.control,name:"grade_level",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Nível/Série"}),e.jsxs(Y,{onValueChange:a.onChange,defaultValue:a.value,disabled:s,children:[e.jsx(p,{children:e.jsx(H,{children:e.jsx(J,{placeholder:"Selecione a série"})})}),e.jsxs(Q,{children:[e.jsx(m,{value:"6ano",children:"6º Ano"}),e.jsx(m,{value:"7ano",children:"7º Ano"}),e.jsx(m,{value:"8ano",children:"8º Ano"}),e.jsx(m,{value:"9ano",children:"9º Ano"}),e.jsx(m,{value:"1medio",children:"1º Médio"}),e.jsx(m,{value:"2medio",children:"2º Médio"}),e.jsx(m,{value:"3medio",children:"3º Médio"})]})]}),e.jsx(j,{})]})})]})})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(N.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.1},children:e.jsxs(A,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(F,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx(fe,{className:"w-4 h-4 text-white"})}),"Configurações da Turma"]}),e.jsx(T,{children:"Defina série, capacidade e outras configurações"})]}),e.jsxs(O,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{control:c.control,name:"student_capacity",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Capacidade"}),e.jsx(p,{children:e.jsx(_,{type:"number",min:"1",max:"100",...a,onChange:o=>a.onChange(parseInt(o.target.value)||1),disabled:s})}),e.jsx(K,{children:"Número máximo de alunos"}),e.jsx(j,{})]})}),e.jsx(u,{control:c.control,name:"school_id",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"School ID (Opcional)"}),e.jsx(p,{children:e.jsx(_,{placeholder:"UUID da escola",...a,disabled:s})}),e.jsx(j,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(u,{control:c.control,name:"chatbot_enabled",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Chatbot Enabled"}),e.jsx(p,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:a.value,onChange:o=>a.onChange(o.target.checked),disabled:s}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Ativar assistente para a turma"})]})}),e.jsx(j,{})]})}),e.jsx(u,{control:c.control,name:"is_school_managed",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"School Managed"}),e.jsx(p,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:a.value,onChange:o=>a.onChange(o.target.checked),disabled:s}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Gerida pela escola"})]})}),e.jsx(j,{})]})})]}),e.jsx(u,{control:c.control,name:"color",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Cor da Turma"}),e.jsx(p,{children:e.jsx("div",{className:"grid grid-cols-4 gap-2",children:V.map(o=>e.jsx("button",{type:"button",onClick:()=>a.onChange(o.value),disabled:s,className:`
                                      relative h-12 rounded-lg border-2 transition-all duration-200
                                      ${o.class}
                                      ${a.value===o.value?"border-white shadow-lg scale-105":"border-transparent hover:scale-105"}
                                      ${s?"opacity-50 cursor-not-allowed":""}
                                    `,title:o.name,children:a.value===o.value&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-4 h-4 bg-white rounded-full"})})},o.value))})}),e.jsx(j,{})]})})]})]})}),e.jsx(N.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},children:e.jsxs(A,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(F,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg flex items-center justify-center",children:e.jsx(te,{className:"w-4 h-4 text-white"})}),"Alunos (Opcional)"]}),e.jsx(T,{children:"Adicione alunos à turma agora ou faça isso depois"})]}),e.jsxs(O,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(W,{children:["Alunos Selecionados (",l.length,")"]}),l.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(a=>e.jsxs(ge,{variant:"secondary",className:"flex items-center gap-1",children:[a.name,e.jsx("button",{type:"button",onClick:()=>$(a.id),disabled:s,className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5 disabled:opacity-50",children:e.jsx(ce,{className:"w-3 h-3"})})]},a.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum aluno selecionado"})]}),e.jsx(he,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Alunos Disponíveis"}),e.jsx("div",{className:"max-h-40 overflow-y-auto space-y-2",children:L.filter(a=>!l.find(o=>o.id===a.id)).map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:a.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.email})]}),e.jsxs(S,{type:"button",size:"sm",variant:"outline",onClick:()=>B(a),disabled:s,children:[e.jsx(ve,{className:"w-3 h-3 mr-1"}),"Adicionar"]})]},a.id))})]})]})]})})]})]}),e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"flex justify-end gap-4 pt-6 bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-white/50 shadow-lg",children:[e.jsx(S,{type:"button",variant:"outline",onClick:()=>r("/dashboard/classes"),disabled:s,className:"bg-white/70 backdrop-blur-sm hover:bg-white/80",children:"Cancelar"}),e.jsx(S,{type:"submit",disabled:s,className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white min-w-[140px] shadow-lg hover:shadow-xl transition-all duration-300",children:s?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"mr-2 h-4 w-4 animate-spin"}),"Criando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"Criar Turma"]})})]})]})}),w&&y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(A,{className:"w-full max-w-md",children:[e.jsxs(F,{children:[e.jsxs(D,{className:"flex items-center gap-2 text-orange-600",children:[e.jsx(Z,{className:"h-5 w-5"}),"Limite de Turmas Atingido"]}),e.jsx(T,{children:"Você atingiu o limite do seu plano atual"})]}),e.jsxs(O,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsxs("p",{className:"font-semibold text-gray-900 mb-2",children:["Plano Atual: ",e.jsx("span",{className:"text-orange-600 uppercase",children:y.plan})]}),e.jsxs("p",{className:"text-gray-700",children:["Turmas criadas: ",e.jsxs("span",{className:"font-bold",children:[y.currentClasses,"/",y.maxClasses]})]}),y.linkedSchools>0&&e.jsxs("p",{className:"text-gray-600 text-sm mt-2",children:["💼 Você está vinculado a ",y.linkedSchools," escola(s)"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Para criar mais turmas, você pode:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-700",children:[e.jsx("li",{children:"Remover uma turma antiga"}),e.jsx("li",{children:"Fazer upgrade para um plano superior"}),y.linkedSchools===0&&e.jsx("li",{children:"Vincular-se a uma escola (turmas ilimitadas)"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(S,{variant:"outline",className:"flex-1",onClick:()=>q(!1),children:"Voltar"}),e.jsx(S,{className:"flex-1 bg-gradient-to-r from-indigo-600 to-purple-600",onClick:()=>r("/settings/subscription"),children:"Ver Planos"})]})]})]})})]})})};export{Me as default};
