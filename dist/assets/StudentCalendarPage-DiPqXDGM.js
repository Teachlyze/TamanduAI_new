import{u as L,r as l,s as y,z as P,j as t,o as $,m as g,d as x,l as R,C as q,B as b,c as J,V as O}from"./main-BrBEgNdp.js";import{P as D}from"./PremiumCard-CQ6HrYyP.js";import{E as Q}from"./EmptyState-DQg0NHXl.js";import{B as V}from"./badge-visb3evj.js";import{C as W}from"./chevron-left-BgQu9N2V.js";import{F as G}from"./funnel-CFLCt-eH.js";import{M as K}from"./map-pin-DATeaGa0.js";import"./PremiumButton-C1Ncun4G.js";const oe=()=>{const{user:u}=L(),[N,v]=l.useState(!0),[f,k]=l.useState(new Date),[i,w]=l.useState([]),[h,S]=l.useState([]),[d,M]=l.useState("all"),[a,j]=l.useState(new Date);l.useEffect(()=>{u&&E()},[u,a]),l.useEffect(()=>{F()},[i,d,f]);const E=async()=>{try{v(!0);const{data:e}=await y.from("class_members").select("class_id").eq("user_id",u.id).eq("role","student"),r=(e||[]).map(n=>n.class_id);if(r.length===0){w([]);return}const{data:s,error:o}=await y.from("calendar_events").select(`
          *,
          classes:class_id (
            id,
            name,
            subject
          )
        `).in("class_id",r).order("start_time",{ascending:!0});if(o)throw o;w(s||[])}catch(e){console.error("Erro ao carregar eventos:",e),P.error("Erro ao carregar eventos")}finally{v(!1)}},F=()=>{const e=new Date,r=new Date(e.getFullYear(),e.getMonth(),e.getDate());let s=i;switch(d){case"today":s=i.filter(n=>new Date(n.start_time).toDateString()===r.toDateString());break;case"upcoming":s=i.filter(n=>new Date(n.start_time)>=e);break;case"week":const o=new Date(r);o.setDate(o.getDate()+7),s=i.filter(n=>{const c=new Date(n.start_time);return c>=r&&c<=o});break;default:s=i}S(s.slice(0,50))},C=()=>{const e=a.getFullYear(),r=a.getMonth(),s=new Date(e,r,1),n=new Date(e,r+1,0).getDate(),c=s.getDay(),p=[];for(let m=0;m<c;m++)p.push(null);for(let m=1;m<=n;m++)p.push(m);return p},_=e=>{if(!e)return[];const r=a.getFullYear(),s=a.getMonth(),o=new Date(r,s,e);return i.filter(n=>new Date(n.start_time).toDateString()===o.toDateString())},T=()=>{j(new Date(a.getFullYear(),a.getMonth()-1,1))},Y=()=>{j(new Date(a.getFullYear(),a.getMonth()+1,1))},z=e=>({class:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",meeting:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",exam:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300",project:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",activity:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300"})[e]||"bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-300",A=e=>({class:b,meeting:O,exam:J,project:b,activity:b})[e]||x;if(N)return t.jsx($,{message:"Carregando sua agenda..."});const B=C(),I=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],H=["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"];return t.jsxs("div",{className:"space-y-6 pb-8",children:[t.jsxs(g.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-emerald-500 via-teal-500 to-cyan-500 p-8 rounded-2xl text-white relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 opacity-10",children:t.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"32px 32px"}})}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx(x,{className:"w-8 h-8"}),t.jsx("h1",{className:"text-3xl font-bold",children:"Minha Agenda"})]}),t.jsx("p",{className:"text-white/90",children:"Acompanhe seus próximos eventos e prazos"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsx(D,{variant:"elevated",children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx(g.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:T,className:"p-2 rounded-lg hover:bg-muted transition-colors",children:t.jsx(W,{className:"w-5 h-5"})}),t.jsxs("h3",{className:"text-xl font-bold",children:[I[a.getMonth()]," ",a.getFullYear()]}),t.jsx(g.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:Y,className:"p-2 rounded-lg hover:bg-muted transition-colors",children:t.jsx(R,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[H.map(e=>t.jsx("div",{className:"text-center text-sm font-semibold text-muted-foreground py-2",children:e},e)),B.map((e,r)=>{const s=e?_(e):[],o=e&&new Date().toDateString()===new Date(a.getFullYear(),a.getMonth(),e).toDateString(),n=e&&f.toDateString()===new Date(a.getFullYear(),a.getMonth(),e).toDateString();return t.jsx(g.div,{whileHover:e?{scale:1.05}:{},whileTap:e?{scale:.95}:{},className:`relative aspect-square p-2 rounded-lg border-2 transition-all ${e?n?"border-primary bg-primary/20 ring-2 ring-primary ring-offset-2 dark:ring-offset-slate-950":o?"border-primary bg-primary/10":s.length>0?"border-border bg-muted/50 hover:border-primary/50 cursor-pointer":"border-border hover:border-muted-foreground/30 cursor-pointer":"border-transparent"}`,onClick:()=>e&&k(new Date(a.getFullYear(),a.getMonth(),e)),children:e&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:`text-sm font-semibold ${o?"text-primary":"text-foreground"}`,children:e}),s.length>0&&t.jsx("div",{className:"absolute bottom-1 left-1 right-1 flex gap-0.5 flex-wrap",children:s.slice(0,3).map((c,p)=>t.jsx("div",{className:"w-1 h-1 rounded-full bg-primary"},p))})]})},r)})]})]})})}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex gap-2 flex-wrap",children:[{value:"all",label:"Todos"},{value:"today",label:"Hoje"},{value:"week",label:"Semana"},{value:"upcoming",label:"Próximos"}].map(e=>t.jsxs(g.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>M(e.value),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap inline-flex items-center gap-2 ${d===e.value?"bg-primary text-primary-foreground":"bg-white dark:bg-slate-900 text-foreground border border-border hover:bg-muted"}`,children:[t.jsx(G,{className:"w-3 h-3"}),e.label]},e.value))}),t.jsxs(D,{variant:"elevated",className:"max-h-[600px] overflow-hidden",children:[t.jsx("div",{className:"p-4 border-b border-border",children:t.jsxs("h3",{className:"font-bold",children:["Eventos (",h.length,")"]})}),t.jsx("div",{className:"p-4 space-y-3 max-h-[500px] overflow-y-auto scrollbar-thin scrollbar-thumb-blue-300 dark:scrollbar-thumb-blue-700 scrollbar-track-transparent",children:h.length===0?t.jsx(Q,{icon:x,title:"Nenhum evento",description:`Nenhum evento encontrado para "${d==="all"?"todos":d==="today"?"hoje":d==="week"?"esta semana":"próximos"}"`}):h.map((e,r)=>{const s=A(e.type||e.event_type),o=new Date(e.start_time);return new Date(e.end_time),t.jsx(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:r*.05},className:"p-4 rounded-lg border-2 border-border hover:border-primary/50 transition-all group",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:`p-2 rounded-lg ${z(e.type||e.event_type)}`,children:t.jsx(s,{className:"w-4 h-4"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-semibold group-hover:text-primary transition-colors",children:e.title}),e.description&&t.jsx("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:e.description}),e.classes&&t.jsx(V,{variant:"secondary",className:"mt-2",children:e.classes.name}),t.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 text-xs text-muted-foreground",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(q,{className:"w-3 h-3"}),o.toLocaleDateString("pt-BR")," ",o.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]}),e.location&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(K,{className:"w-3 h-3"}),e.location]})]})]})]})},e.id)})})]})]})]})]})};export{oe as default};
