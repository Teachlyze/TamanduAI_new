import{r as s,j as e}from"./react-vendor-C2HUFn5N.js";import{a as k}from"./lazy-CreateActivityPage.jsx-DYBofU2F.js";import{P as R}from"./page-EmailConfirmationPage.jsx-BIOACglB.js";import{C as x,P as f,T as n,a as g,B as v,A as w,c as b}from"./mui-vendor-B2ef-T1O.js";import{c as T,u as A}from"./vendor-react-router-B4Bn0PSh.js";const O=()=>{const[o,j]=s.useState(""),[i,y]=s.useState(""),[d,c]=s.useState(!1),[l,t]=s.useState(""),[m,u]=s.useState("");k();const[P]=T(),h=A(),p=P.get("token"),S=async r=>{if(r.preventDefault(),o!==i)return t("As senhas não coincidem");try{u(""),t(""),c(!0);const a=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:p,newPassword:o})}),C=await a.json();if(!a.ok)throw new Error(C.message||"Falha ao redefinir a senha");u("Senha redefinida com sucesso! Redirecionando para o login..."),setTimeout(()=>h("/login"),3e3)}catch(a){t(a.message||"Ocorreu um erro ao redefinir sua senha"),console.error("Error resetting password:",a)}c(!1)};return p?e.jsxs(v,{sx:{minHeight:"100vh",display:"flex",flexDirection:"column",backgroundColor:"background.default"},children:[e.jsx(R,{}),e.jsx(x,{component:"main",maxWidth:"sm",sx:{mt:8,mb:4},children:e.jsxs(f,{elevation:3,sx:{p:4,borderRadius:2},children:[e.jsx(n,{component:"h1",variant:"h4",align:"center",gutterBottom:!0,children:"Redefinir Senha"}),l&&e.jsx(w,{severity:"error",sx:{mb:2},children:l}),m&&e.jsx(w,{severity:"success",sx:{mb:2},children:m}),e.jsx(n,{variant:"body1",paragraph:!0,children:"Digite sua nova senha abaixo."}),e.jsxs(v,{component:"form",onSubmit:S,sx:{mt:3},children:[e.jsx(b,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Nova Senha",type:"password",id:"password",autoComplete:"new-password",value:o,onChange:r=>j(r.target.value),inputProps:{minLength:6,"aria-describedby":"password-helper-text"},helperText:"A senha deve ter pelo menos 6 caracteres"}),e.jsx(b,{margin:"normal",required:!0,fullWidth:!0,name:"confirmPassword",label:"Confirmar Nova Senha",type:"password",id:"confirmPassword",value:i,onChange:r=>y(r.target.value)}),e.jsx(g,{type:"submit",fullWidth:!0,variant:"contained",disabled:d,sx:{mt:3,mb:2,py:1.5},children:d?"Redefinindo...":"Redefinir Senha"})]})]})})]}):e.jsx(x,{component:"main",maxWidth:"sm",sx:{mt:8,mb:4},children:e.jsxs(f,{elevation:3,sx:{p:4,borderRadius:2,textAlign:"center"},children:[e.jsx(n,{variant:"h5",color:"error",children:"Token de redefinição inválido ou expirado"}),e.jsx(g,{variant:"contained",color:"primary",onClick:()=>h("/forgot-password"),sx:{mt:3},children:"Solicitar novo link"})]})})};export{O as default};
