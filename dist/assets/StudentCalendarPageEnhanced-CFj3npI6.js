import{u as B,r as o,s as H,j as e,m as _,d as p,i as d,C as f,x as m,y as x,l as z,V as j}from"./main-7VZoQpWp.js";import{B as b}from"./badge-k0pzqXLv.js";import{A as M,a as U}from"./alert-B7MIS6rw.js";import{t as R}from"./use-toast-JWqhS_ZM.js";import{C as q}from"./chevron-left-D2kfKc53.js";import{U as I}from"./user-8zap3yVI.js";import{S as P}from"./school-DfQSkp2Z.js";import{E as Q}from"./external-link-9OXNaoG2.js";const te=()=>{const{user:u}=B(),[n,w]=o.useState(new Date),[l,S]=o.useState([]),[D,N]=o.useState(!0),[W,F]=o.useState(new Date);o.useEffect(()=>{u&&C()},[n,u]);const k=s=>["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][s.getDay()],C=async()=>{try{N(!0);const s=k(n),t=n.toISOString().split("T")[0],{data:a,error:r}=await H.from("class_members").select(`
          class_id,
          classes!inner (
            id,
            name,
            subject,
            color,
            is_online,
            meeting_link,
            meeting_days,
            meeting_start_time,
            meeting_end_time,
            room_number,
            vacation_start,
            vacation_end,
            cancelled_dates,
            profiles!classes_created_by_fkey (
              name
            ),
            schools (
              name
            )
          )
        `).eq("user_id",u.id).eq("classes.is_online",!0).filter("classes.meeting_days","cs",`{${s}}`);if(r)throw r;const O=(a||[]).filter(({classes:i})=>{if(i.vacation_start&&i.vacation_end){const h=new Date(i.vacation_start),g=new Date(i.vacation_end);if(n>=h&&n<=g)return!1}return!(i.cancelled_dates&&i.cancelled_dates.includes(t))}).sort((i,h)=>{const g=i.classes.meeting_start_time||"00:00",V=h.classes.meeting_start_time||"00:00";return g.localeCompare(V)});S(O)}catch(s){console.error("Error loading classes:",s),R({variant:"destructive",title:"Erro ao carregar aulas",description:s.message})}finally{N(!1)}},E=s=>{const t=new Date,a=`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`,r=t.toDateString(),c=n.toDateString();return r!==c?!1:a>=s.meeting_start_time&&a<=s.meeting_end_time},A=s=>{const t=new Date,a=`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`,r=t.toDateString(),c=n.toDateString();return r!==c?!1:a<s.meeting_start_time},v=s=>{const t=new Date(n);t.setDate(t.getDate()+s),w(t)},T=()=>{w(new Date)},$=s=>s.toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),y=s=>s?s.substring(0,5):"",L=s=>({monday:"Seg",tuesday:"Ter",wednesday:"Qua",thursday:"Qui",friday:"Sex",saturday:"Sáb",sunday:"Dom"})[s]||s;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs(_.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative overflow-hidden bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 rounded-3xl p-8 text-white shadow-2xl",children:[e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-bold flex items-center gap-3",children:[e.jsx(p,{className:"w-10 h-10"}),"Agenda de Aulas"]}),e.jsx("p",{className:"text-blue-100 text-lg mt-2",children:"Suas aulas online programadas"})]}),e.jsxs(d,{onClick:T,className:"whitespace-nowrap inline-flex items-center gap-2 bg-white text-blue-600 hover:bg-white/90 shadow-lg",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:"Hoje"})]})]})}),e.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/10 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-8 -left-8 w-32 h-32 bg-white/5 rounded-full blur-2xl"})]}),e.jsx(m,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg",children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{variant:"outline",size:"icon",onClick:()=>v(-1),className:"whitespace-nowrap inline-flex items-center gap-2 bg-white dark:bg-slate-900",children:e.jsx(q,{className:"w-4 h-4"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white capitalize",children:$(n)}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[l.length," ",l.length===1?"aula":"aulas"," programada",l.length!==1?"s":""]})]}),e.jsx(d,{variant:"outline",size:"icon",onClick:()=>v(1),className:"whitespace-nowrap inline-flex items-center gap-2 bg-white dark:bg-slate-900",children:e.jsx(z,{className:"w-4 h-4"})})]})})}),D?e.jsx(m,{children:e.jsxs(x,{className:"p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"Carregando aulas..."})]})}):l.length===0?e.jsx(m,{children:e.jsxs(x,{className:"p-12 text-center",children:[e.jsx(p,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900 dark:text-white",children:"Nenhuma aula programada"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Você não tem aulas online neste dia."})]})}):e.jsx("div",{className:"space-y-4",children:l.map(({classes:s})=>{const t=E(s),a=A(s);return e.jsx(_.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},whileHover:{scale:1.01},transition:{duration:.2},children:e.jsx(m,{className:`bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300 ${t?"ring-2 ring-red-500 ring-offset-2":""}`,children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:`w-2 h-20 rounded-full bg-${s.color}-500`,style:{backgroundColor:`var(--${s.color}-500, #3b82f6)`}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.subject})]}),t&&e.jsxs(b,{variant:"destructive",className:"animate-pulse whitespace-nowrap inline-flex items-center gap-1",children:[e.jsx(j,{className:"w-3 h-3"}),e.jsx("span",{children:"AO VIVO"})]}),a&&e.jsxs(b,{variant:"secondary",className:"whitespace-nowrap inline-flex items-center gap-1 bg-blue-100 text-blue-700",children:[e.jsx(f,{className:"w-3 h-3"}),e.jsx("span",{children:"Em breve"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(f,{className:"w-4 h-4 text-blue-600"}),e.jsxs("span",{className:"font-medium",children:[y(s.meeting_start_time)," - ",y(s.meeting_end_time)]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(I,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:s.profiles?.name||"Professor"})]}),s.schools&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(P,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:s.schools.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx(p,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("div",{className:"flex gap-1",children:s.meeting_days?.map(r=>e.jsx(b,{variant:"outline",className:"text-xs",children:L(r)},r))})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(d,{onClick:()=>window.open(s.meeting_link,"_blank"),disabled:!t&&!a,className:`whitespace-nowrap inline-flex items-center gap-2 ${t?"bg-red-600 hover:bg-red-700 text-white animate-pulse":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{children:t?"Entrar Agora":"Entrar na Aula"}),e.jsx(Q,{className:"w-3 h-3"})]}),!t&&!a&&e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"Disponível no horário"})]})]})})})},s.id)})}),l.length>0&&e.jsxs(M,{className:"bg-blue-50 dark:bg-blue-950 border-blue-200 dark:border-blue-800",children:[e.jsx(j,{className:"h-4 w-4 text-blue-600"}),e.jsxs(U,{className:"text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Dica:"}),' O botão "Entrar na Aula" fica disponível apenas durante o horário da aula. Você receberá uma notificação 15 minutos antes de cada aula começar.']})]})]})})};export{te as default};
