import{u as z,r as o,s as f,z as F,j as e,o as I,m as t,Z as R,A as h,C as O,d as y,T,k as q,B as L,S as N,W as U,a0 as w,c as H}from"./main-Bujpyeg-.js";import{P as x}from"./PremiumCard-BaDWg06v.js";import{P as V}from"./PremiumButton-skKgx_xy.js";import{E as p}from"./EmptyState-CpVlA95H.js";import{D as M}from"./download-EGp6uXz0.js";import{C as k}from"./circle-check-big-CPiXxACV.js";import{A as Z}from"./arrow-right-DeKqft8c.js";const ae=()=>{const{user:c}=z(),[A,u]=o.useState(!0),[r,S]=o.useState({averageGrade:0,totalActivities:0,completedActivities:0,pendingActivities:0}),[v,D]=o.useState([]),[j,E]=o.useState([]),[g,G]=o.useState([]);o.useEffect(()=>{c&&_()},[c]);const _=async()=>{try{u(!0);const{data:a,error:i}=await f.from("submissions").select(`
          *,
          activities(
            id,
            title,
            max_score,
            due_date,
            activity_class_assignments(
              class_id,
              classes(name, subject)
            )
          )
        `).eq("student_id",c.id).order("submitted_at",{ascending:!1});if(i)throw i;const l=a?.filter(s=>s.grade!==null)||[],d=l.length>0?l.reduce((s,n)=>s+n.grade,0)/l.length:0;S({averageGrade:d,totalActivities:a?.length||0,completedActivities:l.length,pendingActivities:(a?.length||0)-l.length}),E(l.slice(0,10));const m={};l.forEach(s=>{const n=s.activity?.class?.subject||"Outros";m[n]||(m[n]={grades:[],subject:n}),m[n].grades.push(s.grade)});const $=Object.values(m).map(s=>({subject:s.subject,average:s.grades.reduce((n,P)=>n+P,0)/s.grades.length,count:s.grades.length})).sort((s,n)=>n.average-s.average);D($);const{data:B,error:b}=await f.from("activities").select(`
          *,
          class:classes(name, subject)
        `).gte("due_date",new Date().toISOString()).order("due_date",{ascending:!0}).limit(5);if(b)throw b;G(B||[])}catch(a){console.error("Erro ao carregar dados:",a),F.error("Erro ao carregar dashboard")}finally{u(!1)}},C=a=>a>=7?"text-green-600 bg-green-100 dark:bg-green-900/30":a>=5?"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/30":"text-red-600 bg-red-100 dark:bg-red-900/30";return A?e.jsx(I,{message:"Carregando seu desempenho..."}):e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs(t.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 p-8 text-white",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"32px 32px"}})}),e.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(t.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.2},className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm rounded-full px-4 py-2 mb-4",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Dashboard do Aluno"})]}),e.jsxs("h1",{className:"text-4xl font-bold mb-2",children:["Olá, ",c?.user_metadata?.name?.split(" ")[0]||"Estudante","! 👋"]}),e.jsx("p",{className:"text-white/90 text-lg",children:"Acompanhe seu desempenho e continue evoluindo"})]}),e.jsx(t.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",delay:.3},children:e.jsx(V,{variant:"outline",leftIcon:M,className:"bg-white/20 backdrop-blur-sm border-white/30 text-white hover:bg-white/30",children:"Exportar Boletim"})})]}),e.jsx(t.div,{animate:{y:[0,-10,0],rotate:[0,5,0]},transition:{duration:3,repeat:1/0},className:"absolute top-20 right-32 w-20 h-20 bg-white/10 backdrop-blur-sm rounded-2xl"}),e.jsx(t.div,{animate:{y:[0,10,0],rotate:[0,-5,0]},transition:{duration:4,repeat:1/0,delay:1},className:"absolute bottom-10 right-20 w-16 h-16 bg-white/10 backdrop-blur-sm rounded-full"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{title:"Média Geral",value:r.averageGrade.toFixed(1),change:r.averageGrade>=7?"Excelente! 🎉":r.averageGrade>=5?"Bom trabalho!":"Vamos melhorar!",icon:h,trend:r.averageGrade>=7?"up":r.averageGrade>=5?"neutral":"down",color:r.averageGrade>=7?"from-green-500 to-emerald-500":r.averageGrade>=5?"from-yellow-500 to-orange-500":"from-red-500 to-pink-500"},{title:"Atividades Concluídas",value:r.completedActivities,change:`${r.totalActivities} total`,icon:k,trend:"up",color:"from-blue-500 to-cyan-500"},{title:"Aguardando Correção",value:r.pendingActivities,change:r.pendingActivities>0?"Aguarde o professor":"Tudo corrigido! ✓",icon:O,trend:r.pendingActivities>0?"warning":"neutral",color:"from-purple-500 to-indigo-500"},{title:"Próximas Entregas",value:g.length,change:"Nos próximos dias",icon:y,trend:"neutral",color:"from-pink-500 to-rose-500"}].map((a,i)=>e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.1},children:e.jsxs(x,{variant:"elevated",className:"relative overflow-hidden group hover:scale-105 transition-transform duration-300",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${a.color} opacity-5 group-hover:opacity-10 transition-opacity`}),e.jsxs("div",{className:"relative p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${a.color} text-white`,children:e.jsx(a.icon,{className:"w-6 h-6"})}),a.trend==="up"&&e.jsx(T,{className:"w-5 h-5 text-green-500"})]}),e.jsx("div",{className:"text-3xl font-bold mb-1",children:a.value}),e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:a.title}),e.jsx("div",{className:"text-xs font-medium text-primary",children:a.change})]})]})},a.title))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(t.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},children:e.jsxs(x,{variant:"elevated",className:"p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-blue-500/10 to-purple-500/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-1",children:"Desempenho por Disciplina"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Suas médias por matéria"})]}),e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-blue-500 to-purple-500 text-white",children:e.jsx(q,{className:"w-5 h-5"})})]}),v.length===0?e.jsx(p,{icon:L,title:"Nenhuma nota ainda",description:"Suas notas aparecerão aqui"}):e.jsx("div",{className:"space-y-4",children:v.map((a,i)=>e.jsxs(t.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:i*.1},className:"space-y-2 p-4 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${a.average>=7?"bg-green-500":a.average>=5?"bg-yellow-500":"bg-red-500"}`}),e.jsx("span",{className:"font-medium",children:a.subject})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${C(a.average)}`,children:a.average.toFixed(1)}),a.average>=7&&e.jsx(N,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"})]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-3 overflow-hidden",children:e.jsx(t.div,{initial:{width:0},animate:{width:`${a.average/10*100}%`},transition:{duration:1,delay:.5+i*.1,type:"spring"},className:`h-full rounded-full bg-gradient-to-r ${a.average>=7?"from-green-500 to-emerald-500":a.average>=5?"from-yellow-500 to-orange-500":"from-red-500 to-pink-500"}`})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[a.count," avaliações"]}),e.jsxs("span",{children:[(a.average/10*100).toFixed(0),"%"]})]})]},i))})]})]})}),e.jsx(t.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.5},children:e.jsxs(x,{variant:"elevated",className:"p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-gradient-to-br from-pink-500/10 to-rose-500/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-1",children:"Próximas Entregas"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fique atento aos prazos"})]}),e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-pink-500 to-rose-500 text-white",children:e.jsx(y,{className:"w-5 h-5"})})]}),g.length===0?e.jsx(p,{icon:k,title:"Nada pendente",description:"Você está em dia com as atividades"}):e.jsx("div",{className:"space-y-3",children:e.jsx(U,{children:g.map((a,i)=>{const l=Math.ceil((new Date(a.due_date)-new Date)/864e5),d=l<=2;return e.jsxs(t.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{delay:i*.1},className:`group relative p-4 border-2 rounded-xl transition-all hover:scale-105 hover:shadow-lg ${d?"border-orange-300 dark:border-orange-700 bg-gradient-to-br from-orange-50 to-red-50 dark:from-orange-900/30 dark:to-red-900/30":"border-border hover:border-primary/50 bg-background"}`,children:[d&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-500/20 to-red-500/20 rounded-xl blur opacity-50"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(w,{className:"w-4 h-4 text-primary"}),e.jsx("h4",{className:"font-semibold line-clamp-1 group-hover:text-primary transition-colors",children:a.title})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.class?.name})]}),d&&e.jsx(t.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},children:e.jsx(H,{className:"w-6 h-6 text-orange-600 flex-shrink-0"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["📅 ",new Date(a.due_date).toLocaleDateString("pt-BR")]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${d?"bg-orange-500 text-white":"bg-primary/10 text-primary"}`,children:l===0?"⏰ Hoje!":l===1?"⚡ Amanhã":`🗓️ ${l} dias`})]})]})]},a.id)})})})]})]})})]}),e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:e.jsxs(x,{variant:"elevated",className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-1",children:"Notas Recentes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Acompanhe seu histórico de avaliações"})]}),e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-green-500 to-emerald-500 text-white",children:e.jsx(h,{className:"w-5 h-5"})})]}),j.length===0?e.jsx(p,{icon:h,title:"Nenhuma nota ainda",description:"Suas notas aparecerão aqui após a correção"}):e.jsx("div",{className:"space-y-3",children:j.map((a,i)=>e.jsxs(t.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:i*.05},className:"group flex items-center justify-between p-4 border-2 border-border rounded-xl hover:border-primary/50 hover:bg-gradient-to-r hover:from-muted/50 hover:to-transparent transition-all hover:scale-105 hover:shadow-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${a.grade>=7?"from-green-500 to-emerald-500":a.grade>=5?"from-yellow-500 to-orange-500":"from-red-500 to-pink-500"} text-white`,children:e.jsx(w,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold group-hover:text-primary transition-colors",children:a.activity?.title||"Atividade"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["📚 ",a.activity?.class?.name]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["📅 ",new Date(a.corrected_at||a.submitted_at).toLocaleDateString("pt-BR")]})]})]})]}),a.feedback&&e.jsx("div",{className:"mt-2 p-2 rounded-lg bg-muted/50 border-l-4 border-primary",children:e.jsxs("p",{className:"text-sm text-muted-foreground line-clamp-2",children:["💬 ",e.jsx("span",{className:"font-medium",children:"Feedback:"})," ",a.feedback]})})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsxs(t.div,{whileHover:{scale:1.1},className:`relative w-20 h-20 rounded-2xl bg-gradient-to-br ${a.grade>=7?"from-green-500 to-emerald-500":a.grade>=5?"from-yellow-500 to-orange-500":"from-red-500 to-pink-500"} flex items-center justify-center text-white shadow-lg`,children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold",children:a.grade}),e.jsxs("p",{className:"text-xs opacity-90",children:["/",a.activity?.max_score||10]})]}),a.grade>=7&&e.jsx(N,{className:"absolute -top-1 -right-1 w-6 h-6 fill-yellow-400 text-yellow-400"})]}),e.jsxs(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"text-xs text-primary hover:underline flex items-center gap-1",children:["Ver detalhes ",e.jsx(Z,{className:"w-3 h-3"})]})]})]},a.id))})]})})]})};export{ae as default};
