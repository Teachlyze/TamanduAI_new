import{g as F,u as $,r,s as x,z as q,j as e,o as D,m as o,U as v,B as G,T as M,ai as w,K as O,a0 as Q,an as K,ao as R,ap as V,O as W}from"./main-BBAlbGLj.js";import{P as h}from"./PremiumCard-BClPpHrg.js";import{P as u}from"./PremiumButton-CWdhOUBt.js";import{E as C}from"./EmptyState-Del568bV.js";import{B as H}from"./badge-Dxkfeepr.js";import{s as A}from"./schoolService-BvouIyFd.js";import{U as S}from"./user-check-xDkbvkWY.js";import{U as J}from"./user-plus-CdwuDV2S.js";import{F as X}from"./funnel-DHfHwSYC.js";import{M as P}from"./mail-C0ywUecL.js";const ne=()=>{const d=F(),{user:p}=$(),[T,f]=r.useState(!0),[a,k]=r.useState([]),[j,b]=r.useState([]),[n,I]=r.useState(""),[m,E]=r.useState("all");r.useEffect(()=>{p&&U()},[p]),r.useEffect(()=>{let s=a;n&&(s=s.filter(t=>t.name?.toLowerCase().includes(n.toLowerCase())||t.email?.toLowerCase().includes(n.toLowerCase()))),m!=="all"&&(s=s.filter(t=>m==="active"?t.isActive:!t.isActive)),b(s)},[n,m,a]);const U=async()=>{try{f(!0);const s=await A.getUserSchool(p.id);if(!s?.id)throw new Error("Nenhuma escola associada ao usuário");const t=await A.getTeachers(s.id),l=await Promise.all((t||[]).map(async i=>{const{count:N}=await x.from("classes").select("*",{count:"exact",head:!0}).eq("created_by",i.id),{data:g}=await x.from("classes").select("id").eq("created_by",i.id);let y=0;if(g&&g.length>0){const _=g.map(L=>L.id),{count:B}=await x.from("class_members").select("*",{count:"exact",head:!0}).in("class_id",_).eq("role","student");y=B||0}const{count:z}=await x.from("activities").select("*",{count:"exact",head:!0}).eq("created_by",i.id);return{id:i.id,name:i.name,email:i.email,avatar_url:i.avatar,classesCount:N||0,studentsCount:y,activitiesCount:z||0,isActive:(N||0)>0}}));k(l),b(l)}catch(s){console.error("Erro ao carregar professores:",s),q.error("Erro ao carregar professores")}finally{f(!1)}};if(T)return e.jsx(D,{message:"Carregando professores..."});const c={total:a.length,active:a.filter(s=>s.isActive).length,inactive:a.filter(s=>!s.isActive).length,totalClasses:a.reduce((s,t)=>s+t.classesCount,0),totalStudents:a.reduce((s,t)=>s+t.studentsCount,0)};return e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs(o.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-600 via-indigo-700 to-blue-800 p-8 text-white",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"32px 32px"}})}),e.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(o.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.2},className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm rounded-full px-4 py-2 mb-4",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Gestão de Professores"})]}),e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Corpo Docente 👨‍🏫"}),e.jsx("p",{className:"text-white/90 text-lg",children:"Gerencie todos os professores da instituição"})]}),e.jsx(o.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.3},children:e.jsx(u,{leftIcon:J,onClick:()=>d("/school/teachers/new"),className:"bg-white text-blue-600 hover:bg-white/90 shadow-lg whitespace-nowrap inline-flex items-center gap-2 font-semibold",children:"Novo Professor"})})]}),e.jsx(o.div,{animate:{y:[0,-15,0],rotate:[0,5,0]},transition:{duration:4,repeat:1/0},className:"absolute top-10 right-20 text-6xl opacity-20",children:"👨‍🏫"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[{title:"Total",value:c.total,icon:v,gradient:"from-blue-600 to-indigo-700"},{title:"Ativos",value:c.active,icon:S,gradient:"from-green-600 to-emerald-700"},{title:"Inativos",value:c.inactive,icon:v,gradient:"from-gray-500 to-slate-600"},{title:"Turmas Total",value:c.totalClasses,icon:G,gradient:"from-purple-600 to-indigo-700"},{title:"Alunos Total",value:c.totalStudents,icon:M,gradient:"from-orange-600 to-red-700"}].map((s,t)=>e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.1},children:e.jsxs(h,{variant:"elevated",className:"relative overflow-hidden group hover:scale-105 transition-transform",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${s.gradient} opacity-5 group-hover:opacity-10 transition-opacity`}),e.jsxs("div",{className:"relative p-6",children:[e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${s.gradient} text-white mb-2`,children:e.jsx(s.icon,{className:"w-6 h-6"})}),e.jsx("div",{className:"text-3xl font-bold mb-1",children:s.value}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.title})]})]})},s.title))}),e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsx(h,{variant:"elevated",className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(w,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(O,{placeholder:"Buscar professores por nome ou email...",value:n,onChange:s=>I(s.target.value),className:"pl-10"})]}),e.jsx("div",{className:"flex gap-2",children:["all","active","inactive"].map(s=>e.jsx(u,{variant:m===s?"default":"outline",size:"sm",onClick:()=>E(s),leftIcon:X,className:"whitespace-nowrap inline-flex items-center gap-2 bg-white dark:bg-slate-900 text-foreground border-border",children:s==="all"?"Todos":s==="active"?"Ativos":"Inativos"},s))})]})})}),j.length===0?a.length===0?e.jsx(C,{icon:v,title:"Nenhum professor cadastrado",description:"Adicione o primeiro professor à sua instituição",action:{label:"Adicionar Professor",onClick:()=>d("/school/teachers/new")}}):e.jsx(C,{icon:w,title:"Nenhum professor encontrado",description:"Tente ajustar sua busca ou filtros"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.jsx(Q,{children:j.map((s,t)=>e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9},transition:{delay:t*.05},layout:!0,children:e.jsx(h,{variant:"elevated",className:"group relative overflow-hidden hover:scale-105 transition-all cursor-pointer",onClick:()=>d(`/school/teachers/${s.id}`),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsxs(K,{className:"w-16 h-16",children:[e.jsx(R,{src:s.avatar_url}),e.jsx(V,{className:"bg-gradient-to-br from-blue-600 to-indigo-700 text-white text-lg font-bold",children:s.name?.charAt(0)||"P"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-lg truncate group-hover:text-primary transition-colors",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.email}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsx(H,{className:s.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700",children:s.isActive?"Ativo":"Inativo"})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 pt-4 border-t border-border",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:s.classesCount}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Turmas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:s.studentsCount}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Alunos"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600",children:s.activitiesCount}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Atividades"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(u,{size:"sm",variant:"outline",leftIcon:W,onClick:l=>{l.stopPropagation(),d(`/school/teachers/${s.id}`)},className:"flex-1",children:"Ver Perfil"}),e.jsx(u,{size:"sm",variant:"outline",leftIcon:P,onClick:l=>{l.stopPropagation(),window.location.href=`mailto:${s.email}`},children:e.jsx(P,{className:"w-4 h-4"})})]})]})})},s.id))})})]})};export{ne as default};
