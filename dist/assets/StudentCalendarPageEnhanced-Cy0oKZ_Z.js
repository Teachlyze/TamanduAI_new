import{u as B,r as o,s as H,j as e,m as _,d as p,i as d,C as f,x as m,y as x,l as z,V as b}from"./main-NgjJy_CG.js";import{B as j}from"./badge-DS8upoqS.js";import{A as M,a as U}from"./alert-CGDDrWKl.js";import{t as R}from"./use-toast-GUBWlXfL.js";import{C as q}from"./chevron-left-CCTbow4A.js";import{U as I}from"./user-CtDOwJP2.js";import{S as P}from"./school-CqnwbjmY.js";import{E as Q}from"./external-link-DBhAGbYm.js";const se=()=>{const{user:u}=B(),[r,w]=o.useState(new Date),[l,S]=o.useState([]),[D,N]=o.useState(!0),[W,F]=o.useState(new Date);o.useEffect(()=>{u&&C()},[r,u]);const k=t=>["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][t.getDay()],C=async()=>{try{N(!0);const t=k(r),s=r.toISOString().split("T")[0],{data:a,error:n}=await H.from("class_members").select(`
          class_id,
          classes!inner (
            id,
            name,
            subject,
            color,
            is_online,
            meeting_link,
            meeting_days,
            meeting_start_time,
            meeting_end_time,
            room_number,
            vacation_start,
            vacation_end,
            cancelled_dates
          )
        `).eq("user_id",u.id).eq("classes.is_online",!0).filter("classes.meeting_days","cs",`{${t}}`);if(n)throw n;const O=(a||[]).filter(({classes:i})=>{if(i.vacation_start&&i.vacation_end){const h=new Date(i.vacation_start),g=new Date(i.vacation_end);if(r>=h&&r<=g)return!1}return!(i.cancelled_dates&&i.cancelled_dates.includes(s))}).sort((i,h)=>{const g=i.classes.meeting_start_time||"00:00",V=h.classes.meeting_start_time||"00:00";return g.localeCompare(V)});S(O)}catch(t){console.error("Error loading classes:",t),R({variant:"destructive",title:"Erro ao carregar aulas",description:t.message})}finally{N(!1)}},E=t=>{const s=new Date,a=`${s.getHours().toString().padStart(2,"0")}:${s.getMinutes().toString().padStart(2,"0")}`,n=s.toDateString(),c=r.toDateString();return n!==c?!1:a>=t.meeting_start_time&&a<=t.meeting_end_time},A=t=>{const s=new Date,a=`${s.getHours().toString().padStart(2,"0")}:${s.getMinutes().toString().padStart(2,"0")}`,n=s.toDateString(),c=r.toDateString();return n!==c?!1:a<t.meeting_start_time},v=t=>{const s=new Date(r);s.setDate(s.getDate()+t),w(s)},T=()=>{w(new Date)},$=t=>t.toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),y=t=>t?t.substring(0,5):"",L=t=>({monday:"Seg",tuesday:"Ter",wednesday:"Qua",thursday:"Qui",friday:"Sex",saturday:"Sáb",sunday:"Dom"})[t]||t;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs(_.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative overflow-hidden bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 rounded-3xl p-8 text-white shadow-2xl hover:opacity-90",children:[e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-bold flex items-center gap-3",children:[e.jsx(p,{className:"w-10 h-10"}),"Agenda de Aulas"]}),e.jsx("p",{className:"text-blue-100 text-lg mt-2",children:"Suas aulas online programadas"})]}),e.jsxs(d,{onClick:T,className:"whitespace-nowrap inline-flex items-center gap-2 min-w-fit bg-white text-blue-600 hover:bg-white/90 shadow-lg",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:"Hoje"})]})]})}),e.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/10 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-8 -left-8 w-32 h-32 bg-white/5 rounded-full blur-2xl"})]}),e.jsx(m,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg",children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{variant:"outline",size:"icon",onClick:()=>v(-1),className:"whitespace-nowrap inline-flex items-center gap-2 min-w-fit bg-white dark:bg-slate-900",children:e.jsx(q,{className:"w-4 h-4"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white capitalize",children:$(r)}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[l.length," ",l.length===1?"aula":"aulas"," programada",l.length!==1?"s":""]})]}),e.jsx(d,{variant:"outline",size:"icon",onClick:()=>v(1),className:"whitespace-nowrap inline-flex items-center gap-2 min-w-fit bg-white dark:bg-slate-900",children:e.jsx(z,{className:"w-4 h-4"})})]})})}),D?e.jsx(m,{children:e.jsxs(x,{className:"p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"Carregando aulas..."})]})}):l.length===0?e.jsx(m,{children:e.jsxs(x,{className:"p-12 text-center",children:[e.jsx(p,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900 dark:text-white",children:"Nenhuma aula programada"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Você não tem aulas online neste dia."})]})}):e.jsx("div",{className:"space-y-4",children:l.map(({classes:t})=>{const s=E(t),a=A(t);return e.jsx(_.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},whileHover:{scale:1.01},transition:{duration:.2},children:e.jsx(m,{className:`bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300 ${s?"ring-2 ring-red-500 ring-offset-2":""}`,children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:`w-2 h-20 rounded-full bg-${t.color}-500`,style:{backgroundColor:`var(--${t.color}-500, #3b82f6)`}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.subject})]}),s&&e.jsxs(j,{variant:"destructive",className:"animate-pulse whitespace-nowrap inline-flex items-center gap-1",children:[e.jsx(b,{className:"w-3 h-3"}),e.jsx("span",{children:"AO VIVO"})]}),a&&e.jsxs(j,{variant:"secondary",className:"whitespace-nowrap inline-flex items-center gap-1 bg-blue-100 text-blue-700",children:[e.jsx(f,{className:"w-3 h-3"}),e.jsx("span",{children:"Em breve"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(f,{className:"w-4 h-4 text-blue-600"}),e.jsxs("span",{className:"font-medium",children:[y(t.meeting_start_time)," - ",y(t.meeting_end_time)]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(I,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:t.profiles?.name||"Professor"})]}),t.schools&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(P,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:t.schools.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx(p,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("div",{className:"flex gap-1",children:t.meeting_days?.map(n=>e.jsx(j,{variant:"outline",className:"bg-white dark:bg-slate-900 text-foreground border-border text-xs",children:L(n)},n))})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(d,{onClick:()=>window.open(t.meeting_link,"_blank"),disabled:!s&&!a,className:`whitespace-nowrap inline-flex items-center gap-2 ${s?"bg-red-600 hover:bg-red-700 text-white animate-pulse":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:[e.jsx(b,{className:"w-4 h-4"}),e.jsx("span",{children:s?"Entrar Agora":"Entrar na Aula"}),e.jsx(Q,{className:"w-3 h-3"})]}),!s&&!a&&e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"Disponível no horário"})]})]})})})},t.id)})}),l.length>0&&e.jsxs(M,{className:"bg-blue-50 dark:bg-blue-950 border-blue-200 dark:border-blue-800",children:[e.jsx(b,{className:"h-4 w-4 text-blue-600"}),e.jsxs(U,{className:"text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Dica:"}),' O botão "Entrar na Aula" fica disponível apenas durante o horário da aula. Você receberá uma notificação 15 minutos antes de cada aula começar.']})]})]})})};export{se as default};
