import{u as O,r as d,j as e,o as V,d as p,C as T,B as C,e as M,l as q,U as E,c as H,V as L,ac as b}from"./main-Bujpyeg-.js";import{C as P}from"./calendarService-CNZKtPfX.js";import{S as j,P as f}from"./PremiumCard-BaDWg06v.js";import{P as v}from"./PremiumButton-skKgx_xy.js";import{E as Q}from"./EmptyState-CpVlA95H.js";import{C as Y}from"./chevron-left-v67NpT9C.js";import{P as G}from"./plus-C0dvgUSL.js";import"./toDate-B_SDEMqy.js";function le(){const{user:l}=O(),[B,_]=d.useState(!0),[r,u]=d.useState(new Date),[c,$]=d.useState([]),[J,K]=d.useState("day"),[z,h]=d.useState(!1),[s,i]=d.useState({title:"",type:"class",start:"",end:"",location:"",date:new Date().toISOString().split("T")[0]});d.useEffect(()=>{l&&m(r)},[l]),d.useEffect(()=>{if(!l)return;const t=P.subscribeUserCalendar(l.id,()=>{m(r)});return()=>{try{t?.()}catch{}}},[l,r]);const m=async t=>{_(!0);try{const a=t.getFullYear(),o=t.getMonth(),x=new Date(a,o,1),k=new Date(a,o+1,0,23,59,59),g=await P.getUserCalendar({from:x,to:k,userId:l.id,userRole:"teacher"});$(g||[])}catch(a){console.error("Erro ao carregar eventos:",a)}finally{_(!1)}},y=c.filter(t=>{const a=new Date(t.start_time),o=new Date;return a.toDateString()===o.toDateString()}),I=c.filter(t=>new Date(t.start_time)>new Date),A=c.length,U=c.filter(t=>t.status==="completed").length,N=t=>{switch(t){case"class":return C;case"meeting":return E;case"exam":return C;case"video":return L;default:return p}},w=t=>{switch(t){case"class":return"bg-blue-100 dark:bg-muted/50 text-blue-700 dark:text-blue-300";case"meeting":return"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300";case"exam":return"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300";case"video":return"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300";default:return"bg-gray-100 dark:bg-gray-900/30 text-gray-700 dark:text-gray-300"}};return B?e.jsx(V,{message:"Carregando agenda..."}):e.jsxs("div",{className:"space-y-8 animate-fade-in-up",children:[e.jsxs("div",{className:"bg-gradient-to-br from-orange-600 via-red-600 to-pink-600 p-8 rounded-2xl text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 1px 1px, white 1px, transparent 0)",backgroundSize:"40px 40px"}})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-3",children:[e.jsx(p,{className:"w-8 h-8"}),"Agenda"]}),e.jsx("p",{className:"text-white/90",children:"Gerencie sua agenda e compromissos"})]})]}),e.jsxs("div",{className:"stagger-children grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(j,{title:"Eventos Hoje",value:y.length.toString(),icon:p}),e.jsx(j,{title:"Próximos Eventos",value:I.length.toString(),icon:T}),e.jsx(j,{title:"Total de Eventos",value:A.toString(),icon:C}),e.jsx(j,{title:"Concluídos",value:U.toString(),icon:M})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(f,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold",children:r.toLocaleDateString("pt-BR",{month:"long",year:"numeric"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>{const t=new Date(r);t.setMonth(t.getMonth()-1),u(t),m(t)},children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>u(new Date),children:"Hoje"}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>{const t=new Date(r);t.setMonth(t.getMonth()+1),u(t),m(t)},children:e.jsx(q,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2",children:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"].map(t=>e.jsx("div",{className:"text-center text-sm font-medium text-muted-foreground py-2",children:t},t))}),e.jsx("div",{className:"grid grid-cols-7 gap-2",children:(()=>{const t=r.getFullYear(),a=r.getMonth(),o=new Date(t,a,1).getDay(),x=new Date(t,a+1,0).getDate(),k=new Date,g=[];for(let n=0;n<o;n++)g.push(e.jsx("div",{className:"aspect-square"},`empty-${n}`));for(let n=1;n<=x;n++){const D=new Date(t,a,n),F=D.toDateString()===k.toDateString(),R=c.some(S=>new Date(S.start_time).toDateString()===D.toDateString());g.push(e.jsxs("button",{type:"button",onClick:S=>{S.preventDefault(),u(D)},className:`aspect-square p-2 rounded-lg text-sm font-medium transition-colors relative ${F?"bg-primary text-primary-foreground":R?"bg-muted hover:bg-muted/80":"hover:bg-muted/50"}`,children:[n,R&&e.jsx("div",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full bg-primary"})]},n))}return g})()})]}),e.jsxs("div",{className:"border-t border-border pt-4 hidden",children:[e.jsxs("h4",{className:"font-semibold mb-3",children:["Eventos - ",r.toLocaleDateString("pt-BR")]}),e.jsx("div",{className:"space-y-3",children:y.length===0?e.jsx(Q,{icon:p,title:"Nenhum evento neste dia",description:"Clique em '+' para adicionar um evento"}):y.map(t=>{const a=N(t.type);return e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-lg border border-border hover:bg-muted/50 transition-colors cursor-pointer",children:[e.jsx("div",{className:`p-3 rounded-lg ${w(t.type)}`,children:e.jsx(a,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:t.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3"}),t.start," - ",t.end]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(E,{className:"w-3 h-3"}),t.students," alunos"]})]})]}),t.status==="upcoming"&&e.jsx(H,{className:"w-5 h-5 text-warning"})]},t.id)})})]})]})})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(f,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Próximos Eventos"}),e.jsx(v,{variant:"gradient",size:"sm",leftIcon:G,onClick:()=>h(!0),children:"Novo Evento"})]}),e.jsx("div",{className:"space-y-3",children:I.slice(0,5).map(t=>{const a=N(t.type);return e.jsx("div",{className:"p-3 rounded-lg border border-border hover:bg-muted/50 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded ${w(t.type)}`,children:e.jsx(a,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h5",{className:"font-medium text-sm truncate",children:t.title}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[new Date(t.date).toLocaleDateString("pt-BR")," às ",t.start]})]})]})},t.id)})})]})}),e.jsx(f,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Resumo do Mês"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-blue-50 dark:bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),e.jsx("span",{className:"text-sm font-medium",children:"Aulas"})]}),e.jsx("span",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:"12"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-purple-50 dark:bg-purple-900/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"}),e.jsx("span",{className:"text-sm font-medium",children:"Reuniões"})]}),e.jsx("span",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:"5"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-green-50 dark:bg-green-900/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"text-sm font-medium",children:"Concluídos"})]}),e.jsx("span",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:"15"})]})]})]})}),e.jsx(f,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Eventos do dia"}),c.filter(t=>new Date(t.start_time).toDateString()===r.toDateString()).length===0?e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Nenhum evento para ",r.toLocaleDateString("pt-BR")]}):e.jsx("div",{className:"space-y-3",children:c.filter(t=>new Date(t.start_time).toDateString()===r.toDateString()).map(t=>{const a=N(t.type),o=new Date(t.start_time),x=new Date(t.end_time);return e.jsx("div",{className:"p-3 rounded-lg border border-border hover:bg-muted/50 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded ${w(t.type)}`,children:e.jsx(a,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h5",{className:"font-medium text-sm truncate",children:t.title}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[o.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})," - ",x.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]})]})]})},t.id)})})]})})]})]}),z&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>h(!1),children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl max-w-md w-full shadow-2xl border border-gray-200 dark:border-gray-700",onClick:t=>t.stopPropagation(),children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:"Novo Evento"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block text-gray-700 dark:text-gray-300",children:"Título"}),e.jsx("input",{type:"text",value:s.title,onChange:t=>i({...s,title:t.target.value}),className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nome do evento"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block text-gray-700 dark:text-gray-300",children:"Data"}),e.jsx("input",{type:"date",value:s.date,onChange:t=>i({...s,date:t.target.value}),className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block text-gray-700 dark:text-gray-300",children:"Tipo"}),e.jsxs("select",{value:s.type,onChange:t=>i({...s,type:t.target.value}),className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"class",children:"Aula"}),e.jsx("option",{value:"meeting",children:"Reunião"}),e.jsx("option",{value:"exam",children:"Prova"}),e.jsx("option",{value:"video",children:"Videoconferência"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block text-gray-700 dark:text-gray-300",children:"Início"}),e.jsx("input",{type:"time",value:s.start,onChange:t=>i({...s,start:t.target.value}),className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block text-gray-700 dark:text-gray-300",children:"Fim"}),e.jsx("input",{type:"time",value:s.end,onChange:t=>i({...s,end:t.target.value}),className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block text-gray-700 dark:text-gray-300",children:"Local"}),e.jsx("input",{type:"text",value:s.location,onChange:t=>i({...s,location:t.target.value}),className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: Sala 12"})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{h(!1),i({title:"",type:"class",start:"",end:"",location:"",date:new Date().toISOString().split("T")[0]})},className:"flex-1 px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:async()=>{if(!l)return b.error("Usuário não autenticado");if(s.title&&s.start&&s.end&&s.date)try{const t=new Date(`${s.date}T${s.start}`),a=new Date(`${s.date}T${s.end}`);await P.createEvent({class_id:null,title:s.title,description:null,start_time:t,end_time:a,type:s.type,color:null,meeting_id:null,activity_id:null,metadata:{location:s.location,teacher_id:l.id}}),h(!1),i({title:"",type:"class",start:"",end:"",location:"",date:new Date().toISOString().split("T")[0]}),await m(r),b.success("Evento criado com sucesso!")}catch(t){console.error("Erro ao criar evento:",t),b.error("Erro ao criar evento")}else b.error("Preencha todos os campos obrigatórios")},className:"flex-1 px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:opacity-90 transition-opacity font-medium",children:"Criar Evento"})]})]})]})})]})}export{le as default};
