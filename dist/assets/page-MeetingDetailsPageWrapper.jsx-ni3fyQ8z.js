import{r as d,j as e,v as ie,A as Y,aS as le,u as K,T as W,K as X,a3 as $,aT as ne,V as I,F as ce,aU as de,ao as oe,y as G,N as me,aL as J,_ as xe}from"./react-vendor-C2HUFn5N.js";import{u as ue,B as l,C as u,b as h,d as j,k as T,e as p,m as Q,T as he}from"./lazy-CreateActivityPage.jsx-DYBofU2F.js";import{B as _}from"./page-ActivityManagementPage.jsx-C56hp2jB.js";import{E as je,A as U,f as q,g as B}from"./lazy-Dashboard.jsx-BoWvKiDK.js";import{M as f,T as pe,a as fe,b as F,c as O,L as Ne,d as ge}from"./page-MeetingDetailsPage.jsx-CRXx7amB.js";import{b as ve,u as ye}from"./vendor-react-router-B4Bn0PSh.js";import{c as N,p as g,o as C,q as we}from"./utils-vendor-DsQmHAQY.js";const _e=()=>{const{id:a}=ve(),n=ye(),{toast:t}=ue(),[c,v]=d.useState(null),[P,S]=d.useState(!0),[E,o]=d.useState(null),[m,x]=d.useState([]),[M,y]=d.useState(!1),[A,w]=d.useState(""),[L,k]=d.useState(!1),[D,r]=d.useState(!1),b=s=>{const i=C(s);return{date:N(i,"dd 'de' MMMM 'de' yyyy",{locale:g}),time:N(i,"HH:mm",{locale:g}),full:N(i,"dd/MM/yyyy 'às' HH:mm",{locale:g})}},R=d.useCallback(async()=>{try{S(!0),o(null),await new Promise(i=>setTimeout(i,100));const s=await f.getMeetingById(a);if(!s)throw new Error("Reunião não encontrada");v(s),w(s.notes||""),!s.participants||s.participants.length===0?V(s.id):x(s.participants)}catch(s){console.error("Error fetching meeting details:",s),o(s.message||"Não foi possível carregar os detalhes da reunião."),t({variant:"destructive",title:"Erro ao carregar reunião",description:s.message||"Ocorreu um erro ao carregar os detalhes da reunião."})}finally{S(!1)}},[a,t,V]),V=d.useCallback(async s=>{try{r(!0);const i=await f.getMeetingParticipants(s);x(i)}catch(i){console.error("Error fetching participants:",i),t({variant:"destructive",title:"Erro ao carregar participantes",description:"Não foi possível carregar a lista de participantes da reunião."})}finally{r(!1)}},[t]),Z=async()=>{if(window.confirm("Tem certeza que deseja excluir esta reunião? Esta ação não pode ser desfeita."))try{y(!0),await f.deleteMeeting(a),t({title:"Reunião excluída",description:"A reunião foi excluída com sucesso."}),n("/meetings")}catch(s){console.error("Error deleting meeting:",s),t({variant:"destructive",title:"Erro ao excluir reunião",description:s.message||"Não foi possível excluir a reunião. Tente novamente."})}finally{y(!1)}},ee=async()=>{if(c)try{k(!0);const s=await f.updateMeeting(c.id,{...c,notes:A});v(s),t({title:"Notas salvas",description:"As anotações da reunião foram salvas com sucesso."})}catch(s){console.error("Error saving notes:",s),t({variant:"destructive",title:"Erro ao salvar anotações",description:"Não foi possível salvar as anotações da reunião."})}finally{k(!1)}},se=async(s,i)=>{try{await f.updateParticipantStatus(c.id,s,i),x(z=>z.map(H=>H.id===s?{...H,status:i,updated_at:new Date().toISOString()}:H)),t({title:"Status atualizado",description:"O status do participante foi atualizado com sucesso."})}catch(z){console.error("Error updating participant status:",z),t({variant:"destructive",title:"Erro ao atualizar status",description:"Não foi possível atualizar o status do participante."})}};if(d.useEffect(()=>{R();const s=f.subscribeToMeetingUpdates(a,i=>{console.log("Meeting update received:",i),R()});return()=>{s&&s.unsubscribe()}},[a,R]),P)return e.jsx("div",{className:"container mx-auto py-12 px-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 bg-gray-200 rounded mr-2"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-6 w-48 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-10 w-24 bg-gray-200 rounded"}),e.jsx("div",{className:"h-10 w-24 bg-gray-200 rounded"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx("div",{className:"h-64 bg-gray-200 rounded-lg"}),e.jsx("div",{className:"h-96 bg-gray-200 rounded-lg"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"h-48 bg-gray-200 rounded-lg"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded-lg"})]})]})]})});if(E||!c)return e.jsx("div",{className:"container mx-auto py-12 px-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ie,{className:"mx-auto h-12 w-12 text-destructive mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:E||"Reunião não encontrada"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Não foi possível carregar os detalhes da reunião solicitada."}),e.jsxs(l,{onClick:()=>n("/meetings"),children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Voltar para a lista de reuniões"]})]})});const ae=N(C(c.end_time),"HH:mm",{locale:g}),re=we(C(c.end_time)),te=c.meeting_type==="online";return e.jsx(be,{meeting:c,participants:m,isDeleting:M,notes:A,isSubmittingNotes:L,isLoadingParticipants:D,formatDateTime:b,endTime:ae,isPastMeeting:re,isOnline:te,navigate:n,toast:t,onDelete:Z,onSaveNotes:ee,onUpdateStatus:se,setNotes:w})},be=({meeting:a,participants:n,isDeleting:t,notes:c,isSubmittingNotes:v,isLoadingParticipants:P,formatDateTime:S,endTime:E,isPastMeeting:o,isOnline:m,navigate:x,toast:M,onDelete:y,onSaveNotes:A,onUpdateStatus:w,setNotes:L})=>{const{date:k,time:D}=S(a.start_time);return e.jsx(je,{errorTitle:"Ocorreu um erro na página de detalhes da reunião",errorMessage:"Algo inesperado aconteceu. Por favor, tente recarregar a página.",children:e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs(l,{variant:"ghost",size:"icon",className:"mr-2",onClick:()=>x(-1),children:[e.jsx(Y,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Voltar"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:a.title}),e.jsx("p",{className:"text-muted-foreground",children:"Detalhes e gerenciamento da reunião"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[e.jsxs(l,{variant:"outline",onClick:()=>x(`/meetings/edit/${a.id}`),children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),"Editar"]}),e.jsxs(l,{variant:"destructive",onClick:y,disabled:t,children:[t?e.jsx(K,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(W,{className:"mr-2 h-4 w-4"}),"Excluir"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(u,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(j,{className:"text-xl",children:a.title}),e.jsx(T,{className:"mt-2",children:a.description||"Nenhuma descrição fornecida."})]}),e.jsx(_,{variant:o?"secondary":"default",className:"ml-2",children:o?"Realizada":"Agendada"})]})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(X,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Data e horário"}),e.jsxs("p",{className:"text-sm",children:[k," • ",D," - ",E]})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:m?e.jsx($,{className:"h-5 w-5 text-primary"}):e.jsx(ne,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:m?"Link da reunião":"Local"}),m?e.jsx("a",{href:a.meeting_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:a.meeting_url}):e.jsx("p",{className:"text-sm",children:a.location||"Local não especificado"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(I,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Participantes"}),e.jsxs("div",{className:"flex -space-x-2 mt-1",children:[n.slice(0,5).map(r=>e.jsxs(U,{className:"border-2 border-background",children:[e.jsx(q,{src:r.avatar_url,alt:r.name}),e.jsx(B,{children:r.name.split(" ").map(b=>b[0]).join("").toUpperCase()})]},r.id)),n.length>5&&e.jsxs("div",{className:"h-10 w-10 rounded-full bg-muted flex items-center justify-center text-xs font-medium",children:["+",n.length-5]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[n.length," ",n.length===1?"participante":"participantes"]})]})]})]}),m&&!o&&e.jsx(Q,{className:"border-t pt-4",children:e.jsx(l,{className:"w-full",asChild:!0,children:e.jsxs("a",{href:a.meeting_url,target:"_blank",rel:"noopener noreferrer",children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Entrar na reunião"]})})})]}),e.jsxs(pe,{defaultValue:"notes",children:[e.jsxs(fe,{className:"grid w-full grid-cols-3",children:[e.jsxs(F,{value:"notes",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Anotações"]}),e.jsxs(F,{value:"participants",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Participantes"]}),e.jsxs(F,{value:"attachments",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Anexos"]})]}),e.jsx(O,{value:"notes",className:"mt-4",children:e.jsxs(u,{children:[e.jsxs(h,{children:[e.jsx(j,{children:"Anotações da Reunião"}),e.jsx(T,{children:"Adicione notas e informações relevantes sobre esta reunião."})]}),e.jsx(p,{children:e.jsx(he,{placeholder:"Adicione suas anotações aqui...",className:"min-h-[200px]",value:c,onChange:r=>L(r.target.value)})}),e.jsx(Q,{className:"flex justify-end border-t pt-4",children:e.jsx(l,{onClick:A,disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Salvar anotações"]})})})]})}),e.jsx(O,{value:"participants",className:"mt-4",children:e.jsxs(u,{children:[e.jsxs(h,{children:[e.jsx(j,{children:"Participantes"}),e.jsx(T,{children:"Lista de participantes confirmados e seus status."})]}),e.jsx(p,{children:P?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(Ne,{size:"md",text:"Carregando participantes..."})}):n.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhum participante adicionado a esta reunião."}):e.jsx("div",{className:"space-y-4",children:n.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(U,{children:[e.jsx(q,{src:r.avatar_url,alt:r.name}),e.jsx(B,{children:r.name.split(" ").map(b=>b[0]).join("").toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.email})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[r.status==="confirmed"?e.jsxs(_,{variant:"success",children:[e.jsx(G,{className:"h-3 w-3 mr-1"}),"Confirmado"]}):r.status==="pending"?e.jsxs(_,{variant:"warning",children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),"Pendente"]}):e.jsxs(_,{variant:"destructive",children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),"Recusado"]}),!o&&e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(l,{variant:"ghost",size:"sm",className:"h-8 px-2",onClick:()=>w(r.id,"confirmed"),disabled:r.status==="confirmed",children:e.jsx(G,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",className:"h-8 px-2",onClick:()=>w(r.id,"declined"),disabled:r.status==="declined",children:e.jsx(J,{className:"h-4 w-4"})})]})]})]},r.id))})})]})}),e.jsx(O,{value:"attachments",className:"mt-4",children:e.jsxs(u,{children:[e.jsxs(h,{children:[e.jsx(j,{children:"Anexos da Reunião"}),e.jsx(T,{children:"Arquivos compartilhados nesta reunião."})]}),e.jsx(p,{children:e.jsx(ge,{meetingId:a.id,readOnly:o,onUploadSuccess:()=>{M({title:"Anexo adicionado",description:"O arquivo foi enviado com sucesso."})},onDeleteSuccess:()=>{M({title:"Anexo removido",description:"O arquivo foi removido com sucesso."})}})})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(u,{children:[e.jsx(h,{children:e.jsx(j,{className:"text-lg",children:"Ações Rápidas"})}),e.jsxs(p,{className:"space-y-2",children:[e.jsxs(l,{variant:"outline",className:"w-full justify-start",children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"Enviar lembrete"]}),e.jsxs(l,{variant:"outline",className:"w-full justify-start",children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Adicionar participantes"]}),e.jsxs(l,{variant:"outline",className:"w-full justify-start",children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Reagendar"]}),e.jsxs(l,{variant:"outline",className:"w-full justify-start text-destructive hover:text-destructive",onClick:y,disabled:t,children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),t?"Excluindo...":"Excluir reunião"]})]})]}),e.jsxs(u,{children:[e.jsx(h,{children:e.jsx(j,{className:"text-lg",children:"Detalhes da Reunião"})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Criada em"}),e.jsx("p",{className:"text-sm",children:N(C(a.created_at),"dd/MM/yyyy 'às' HH:mm",{locale:g})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Criada por"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsxs(U,{className:"h-6 w-6 mr-2",children:[e.jsx(q,{src:a.creator?.avatar_url}),e.jsx(B,{children:a.creator?.name?.split(" ").map(r=>r[0]).join("").toUpperCase()})]}),e.jsx("span",{className:"text-sm",children:a.creator?.name||"Usuário"})]})]}),a.updated_at!==a.created_at&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Última atualização"}),e.jsx("p",{className:"text-sm",children:N(C(a.updated_at),"dd/MM/yyyy 'às' HH:mm",{locale:g})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"ID da reunião"}),e.jsx("p",{className:"text-sm font-mono bg-muted px-2 py-1 rounded mt-1",children:a.id})]})]})]})]})]})]})})};export{_e as default};
