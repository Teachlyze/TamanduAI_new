import{j as e,u as T,r as x,v as de,af as we,aR as ae,ac as Ne,T as ee,I as ye,F as me,A as re,aS as _e,K as ne,a3 as ie,aT as be,V as X,aU as Se,ao as Ee,y as oe,N as Ce,aL as ce,_ as Me}from"./react-vendor-C2HUFn5N.js";import{c as U,s as o,u as ue,B as p,C as _,e as b,b as S,d as E,k as $,m as le,T as qe}from"./lazy-CreateActivityPage.jsx-DYBofU2F.js";import{B as R}from"./page-ActivityManagementPage.jsx-C56hp2jB.js";import{E as De,A as J,f as Q,g as Y}from"./lazy-Dashboard.jsx-BoWvKiDK.js";import{a4 as ke,a5 as he,a6 as xe,a7 as fe}from"./ui-vendor-Dv2DrOQv.js";import{u as Ae}from"./i18n-vendor-WP9bSEud.js";import{m as Z,c as D,p as k,o as A,q as Te}from"./utils-vendor-DsQmHAQY.js";import{b as Ue,u as Oe}from"./vendor-react-router-B4Bn0PSh.js";const te=({className:s,size:a="md",text:r="Carregando...",showText:t=!0,fullScreen:n=!1,...d})=>{const m={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8",xl:"h-10 w-10"},u=e.jsx("div",{className:U("flex items-center justify-center",n?"min-h-screen":"",s),...d,children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(T,{className:U("animate-spin text-primary",m[a]||m.md)}),t&&e.jsx("span",{className:"text-sm text-muted-foreground",children:r})]})});return n?e.jsx("div",{className:"fixed inset-0 z-50 bg-background/80 backdrop-blur-sm flex items-center justify-center",children:u}):u},Ie=ke,ge=x.forwardRef(({className:s,...a},r)=>e.jsx(he,{ref:r,className:U("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a}));ge.displayName=he.displayName;const B=x.forwardRef(({className:s,...a},r)=>e.jsx(xe,{ref:r,className:U("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...a}));B.displayName=xe.displayName;const H=x.forwardRef(({className:s,...a},r)=>e.jsx(fe,{ref:r,className:U("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a}));H.displayName=fe.displayName;const F={async uploadMeetingFile(s,{meetingId:a,uploaderId:r,bucket:t="meeting-attachments"}){if(!a)throw new Error("meetingId is required");if(!r)throw new Error("uploaderId is required");if(!s)throw new Error("File is required");const n=s.name.split(".").pop(),d=`${Date.now()}-${Math.random().toString(36).substring(2,15)}.${n}`,m=`${a}/${d}`,{error:u}=await o.storage.from(t).upload(m,s,{cacheControl:"3600",upsert:!1,contentType:s.type});if(u)throw u;const{data:j,error:l}=await o.functions.invoke("validate-upload",{body:{context:"meeting",contextId:a,bucket:t,filePath:m,originalName:s.name,mimeType:s.type,uploaderId:r}});if(l)throw l;return j?.attachment},async uploadEventFile(s,{eventId:a,uploaderId:r,bucket:t="event-attachments"}){if(!a)throw new Error("eventId is required");if(!r)throw new Error("uploaderId is required");if(!s)throw new Error("File is required");const n=s.name.split(".").pop(),d=`${Date.now()}-${Math.random().toString(36).substring(2,15)}.${n}`,m=`${a}/${d}`,{error:u}=await o.storage.from(t).upload(m,s,{cacheControl:"3600",upsert:!1,contentType:s.type});if(u)throw u;const{data:j,error:l}=await o.functions.invoke("validate-upload",{body:{context:"event",contextId:a,bucket:t,filePath:m,originalName:s.name,mimeType:s.type,uploaderId:r}});if(l)throw l;return j?.attachment},async getMeetingAttachments(s){try{const{data:a,error:r}=await o.from("meeting_attachments").select("id, meeting_id, original_name, storage_path, status, reason, created_at, uploader:profiles!uploader_id(id, full_name)").eq("meeting_id",s).order("created_at",{ascending:!1});if(r)throw r;return a||[]}catch(a){throw console.error("Error fetching attachments:",a),a}},async getEventAttachments(s){try{const{data:a,error:r}=await o.from("event_attachments").select("id, event_id, original_name, storage_path, status, reason, created_at, uploader:profiles!uploader_id(id, full_name)").eq("event_id",s).order("created_at",{ascending:!1});if(r)throw r;return a||[]}catch(a){throw console.error("Error fetching event attachments:",a),a}},async deleteAttachment(s,a="meeting-attachments"){try{const{data:r,error:t}=await o.from("meeting_attachments").select("*").eq("id",s).single();if(t)throw t;if(!r)throw new Error("Attachment not found");const{error:n}=await o.storage.from(a).remove([r.storage_path]);if(n)throw n;const{error:d}=await o.from("meeting_attachments").delete().eq("id",s);if(d)throw d;return!0}catch(r){throw console.error("Error deleting attachment:",r),r}},async getSignedUrl(s,a=3600,r="meeting-attachments"){try{const{data:t,error:n}=await o.storage.from(r).createSignedUrl(s,a);if(n)throw n;return t.signedUrl}catch(t){throw console.error("Error generating signed URL:",t),t}},subscribeToAttachments(s,a){if(!s)return console.error("meetingId is required for subscription"),()=>{};const r=o.channel(`meeting_attachments_${s}`).on("postgres_changes",{event:"*",schema:"public",table:"meeting_attachments",filter:`meeting_id=eq.${s}`},t=>{a(t)}).subscribe();return()=>{r.unsubscribe()}}},Pe=({meetingId:s,readOnly:a=!1,onUploadSuccess:r,onDeleteSuccess:t})=>{const[n,d]=x.useState([]),[m,u]=x.useState(!0),[j,l]=x.useState(!1),[w,v]=x.useState(null),{toast:N}=ue();Ae();const M=async()=>{try{u(!0),v(null);const c=await F.getMeetingAttachments(s);d(c||[])}catch(c){console.error("Error loading attachments:",c),v("Não foi possível carregar os anexos.")}finally{u(!1)}};x.useEffect(()=>{M()},[s]);const O=async c=>{const h=c.target.files;if(!(!h||h.length===0))try{l(!0),v(null);for(const f of h){const y=await F.uploadMeetingAttachment(s,f);d(K=>[...K,y])}N({title:"Anexos adicionados",description:`${h.length} arquivo(s) enviado(s) com sucesso.`}),r&&r()}catch(f){console.error("Error uploading files:",f),N({variant:"destructive",title:"Erro no upload",description:"Não foi possível enviar os arquivos."})}finally{l(!1),c.target.value=""}},I=async c=>{if(window.confirm("Tem certeza que deseja excluir este anexo?"))try{await F.deleteMeetingAttachment(s,c),d(h=>h.filter(f=>f.id!==c)),N({title:"Anexo removido",description:"O arquivo foi removido com sucesso."}),t&&t()}catch(h){console.error("Error deleting attachment:",h),N({variant:"destructive",title:"Erro ao remover",description:"Não foi possível remover o arquivo."})}},P=async c=>{try{const h=await F.getAttachmentDownloadUrl(s,c.id),f=document.createElement("a");f.href=h,f.download=c.name,f.target="_blank",document.body.appendChild(f),f.click(),document.body.removeChild(f)}catch(h){console.error("Error downloading attachment:",h),N({variant:"destructive",title:"Erro no download",description:"Não foi possível baixar o arquivo."})}},V=c=>{const h=c.split(".").pop()?.toLowerCase();return["jpg","jpeg","png","gif","webp","svg"].includes(h)?e.jsx(ye,{className:"w-4 h-4 text-blue-500"}):["pdf","doc","docx","txt"].includes(h)?e.jsx(me,{className:"w-4 h-4 text-red-500"}):e.jsx(ae,{className:"w-4 h-4 text-gray-500"})},z=c=>{if(c===0)return"0 Bytes";const h=1024,f=["Bytes","KB","MB","GB"],y=Math.floor(Math.log(c)/Math.log(h));return parseFloat((c/Math.pow(h,y)).toFixed(2))+" "+f[y]};return m?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(te,{size:"md",text:"Carregando anexos..."})}):w?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(de,{className:"mx-auto h-12 w-12 text-destructive mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:w}),e.jsx(p,{variant:"outline",onClick:M,className:"mt-4",children:"Tentar novamente"})]}):e.jsxs("div",{className:"space-y-4",children:[!a&&e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center hover:border-blue-400 dark:hover:border-blue-500 transition-colors",children:[e.jsx("input",{type:"file",multiple:!0,onChange:O,className:"hidden",id:"attachment-upload",disabled:j}),e.jsx("label",{htmlFor:"attachment-upload",className:"cursor-pointer block",children:j?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(T,{className:"w-8 h-8 text-blue-500 animate-spin mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enviando arquivos..."})]}):e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(we,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsx("p",{className:"text-sm font-medium mb-1",children:"Clique para adicionar anexos"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ou arraste e solte arquivos aqui"})]})})]}),n.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ae,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),e.jsx("p",{className:"text-sm",children:a?"Nenhum anexo foi adicionado a esta reunião.":"Nenhum anexo foi adicionado ainda."}),!a&&e.jsx("p",{className:"text-xs mt-1",children:"Use o botão acima para adicionar arquivos."})]}):e.jsx("div",{className:"space-y-2",children:n.map(c=>e.jsx(_,{className:"hover:shadow-md transition-shadow",children:e.jsx(b,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[V(c.name),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:c.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[z(c.size),c.uploaded_at&&e.jsxs("span",{className:"ml-2",children:["• ",new Date(c.uploaded_at).toLocaleDateString()]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>P(c),className:"h-8 w-8 p-0",title:"Baixar arquivo",children:e.jsx(Ne,{className:"w-4 h-4"})}),!a&&e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>I(c.id),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",title:"Remover arquivo",children:e.jsx(ee,{className:"w-4 h-4"})})]})]})})},c.id))}),j&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[e.jsx(T,{className:"w-4 h-4 animate-spin"}),"Enviando arquivos..."]})]})},ze={async getUserCalendar({from:s,to:a}){const{data:r,error:t}=await o.from("calendar_events").select("id, class_id, title, description, start_time, end_time, meeting_id, activity_id, type, color").gte("start_time",s.toISOString()).lte("end_time",a.toISOString()).order("start_time",{ascending:!0});if(t)throw t;return r||[]},async createEvent({class_id:s,title:a,description:r=null,start_time:t,end_time:n,type:d="custom",color:m=null,meeting_id:u=null,activity_id:j=null,metadata:l=null}){const w={class_id:s,title:a,description:r,start_time:t instanceof Date?t.toISOString():t,end_time:n instanceof Date?n.toISOString():n,type:d,color:m,meeting_id:u,activity_id:j,metadata:l},{data:v,error:N}=await o.from("calendar_events").insert(w).select().single();if(N)throw N;return v},async updateEvent(s,a){const r=m=>m instanceof Date?m.toISOString():m,t={...a};t.start_time&&(t.start_time=r(t.start_time)),t.end_time&&(t.end_time=r(t.end_time));const{data:n,error:d}=await o.from("calendar_events").update(t).eq("id",s).select().single();if(d)throw d;return n},async deleteEvent(s){const{error:a}=await o.from("calendar_events").delete().eq("id",s);if(a)throw a;return!0},async getClassCalendar(s,{from:a,to:r}){const{data:t,error:n}=await o.from("calendar_events").select("id, class_id, title, description, start_time, end_time, meeting_id, activity_id").eq("class_id",s).gte("start_time",a.toISOString()).lte("end_time",r.toISOString()).order("start_time",{ascending:!0});if(n)throw n;return t||[]},subscribeUserCalendar(s,a){const r=o.channel(`calendar-user-${s}`);return r.on("postgres_changes",{event:"*",schema:"public",table:"calendar_events"},()=>a("calendar_events")).on("postgres_changes",{event:"*",schema:"public",table:"event_attendees",filter:`user_id=eq.${s}`},()=>a("event_attendees")).subscribe(),()=>{try{o.removeChannel(r)}catch{}}},subscribeClassCalendar(s,a){const r=o.channel(`calendar-class-${s}`);return r.on("postgres_changes",{event:"*",schema:"public",table:"calendar_events",filter:`class_id=eq.${s}`},()=>a("calendar_events")).on("postgres_changes",{event:"*",schema:"public",table:"event_attendees"},()=>a("event_attendees")).subscribe(),()=>{try{o.removeChannel(r)}catch{}}},detectConflicts(s){const a=[],r=[...s].sort((t,n)=>new Date(t.start_time)-new Date(n.start_time));for(let t=0;t<r.length-1;t++){const n=r[t],d=r[t+1];new Date(d.start_time)<new Date(n.end_time)&&a.push([n,d])}return a},computeReminderWindows(s){const a=new Date(s.end_time),r=s.estimated_minutes||60,t=s.complexity==="high"?2:s.complexity==="medium"?1.2:1,n=Math.ceil(r*t);return[{label:"Iniciar preparo",when:Z(a,-n-120)},{label:"Lembrete 24h",when:Z(a,-1440)},{label:"Lembrete 2h",when:Z(a,-120)}]},async getUserCalendarCompact({from:s,to:a,userId:r}){const t=s instanceof Date?s.toISOString():s,n=a instanceof Date?a.toISOString():a,d=r||(await o.auth.getUser()).data?.user?.id||null,{data:m,error:u}=await o.rpc("get_user_calendar_compact",{p_user:d,p_from:t,p_to:n});if(u)throw u;return m||[]}},Le={async createMeeting({title:s,description:a=null,class_id:r=null,start_time:t=null,end_time:n=null,channel:d=null,seedCalendar:m=!0}){const{data:{user:u}}=await o.auth.getUser();if(!u?.id)throw new Error("Not authenticated");const j={title:s,description:a,class_id:r,start_time:t instanceof Date?t.toISOString():t,end_time:n instanceof Date?n.toISOString():n,status:"scheduled",channel:d,created_by:u.id},{data:l,error:w}=await o.from("meetings").insert(j).select("*").single();if(w)throw w;if(m&&l?.start_time&&l?.end_time)try{await ze.createEvent({class_id:l.class_id,title:l.title||"Meeting",description:l.description,start_time:l.start_time,end_time:l.end_time,type:"meeting",color:"#3b82f6",meeting_id:l.id})}catch(v){console.warn("Failed to seed calendar for meeting",v)}return l},async startMeeting(s){const{data:{user:a}}=await o.auth.getUser();if(!a?.id)throw new Error("Not authenticated");const{data:r}=await o.from("meetings").select("id, created_by, status").eq("id",s).single();if(!r)throw new Error("Meeting not found");if(r.created_by!==a.id)throw new Error("Not allowed to start this meeting");const{data:t,error:n}=await o.from("meetings").update({status:"live",started_at:new Date().toISOString()}).eq("id",s).select("*").single();if(n)throw n;return t},async endMeeting(s){const{data:{user:a}}=await o.auth.getUser();if(!a?.id)throw new Error("Not authenticated");const{data:r}=await o.from("meetings").select("id, created_by, status").eq("id",s).single();if(!r)throw new Error("Meeting not found");if(r.created_by!==a.id)throw new Error("Not allowed to end this meeting");const{data:t,error:n}=await o.from("meetings").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",s).select("*").single();if(n)throw n;return t},async cancelMeeting(s){const{data:{user:a}}=await o.auth.getUser();if(!a?.id)throw new Error("Not authenticated");const{data:r}=await o.from("meetings").select("id, created_by, status").eq("id",s).single();if(!r)throw new Error("Meeting not found");if(r.created_by!==a.id)throw new Error("Not allowed to cancel this meeting");const{data:t,error:n}=await o.from("meetings").update({status:"canceled",canceled_at:new Date().toISOString()}).eq("id",s).select("*").single();if(n)throw n;return t},async joinMeeting(s,a="participant"){const{data:{user:r}}=await o.auth.getUser();if(!r?.id)throw new Error("Not authenticated");const{data:t,error:n}=await o.from("meeting_participants").upsert({meeting_id:s,user_id:r.id,role:a,joined_at:new Date().toISOString(),left_at:null},{onConflict:"meeting_id,user_id"}).select("*").single();if(n)throw n;return t},async leaveMeeting(s){const{data:{user:a}}=await o.auth.getUser();if(!a?.id)throw new Error("Not authenticated");const{data:r,error:t}=await o.from("meeting_participants").update({left_at:new Date().toISOString()}).eq("meeting_id",s).eq("user_id",a.id).select("*").single();if(t)throw t;return r},async listParticipants(s){const{data:a,error:r}=await o.from("meeting_participants").select("id, user_id, status, role, joined_at, left_at, profiles:profiles(full_name, email, avatar_url)").eq("meeting_id",s);if(r)throw r;return(a||[]).map(t=>({id:t.id,user_id:t.user_id,role:t.role,status:t.status||"pending",joined_at:t.joined_at,left_at:t.left_at,name:t.profiles?.full_name||"Usuário",email:t.profiles?.email||"",avatar_url:t.profiles?.avatar_url||null}))},async getMeetingById(s){const{data:a,error:r}=await o.from("meetings").select("*").eq("id",s).single();if(r)throw r;return a},async getMeetingParticipants(s){return this.listParticipants(s)},async updateMeeting(s,a){const{data:r,error:t}=await o.from("meetings").update({...a,updated_at:new Date().toISOString()}).eq("id",s).select("*").single();if(t)throw t;return r},async deleteMeeting(s){const{error:a}=await o.from("meetings").delete().eq("id",s);if(a)throw a;return!0},async updateParticipantStatus(s,a,r){const{data:t,error:n}=await o.from("meeting_participants").update({status:r,updated_at:new Date().toISOString()}).eq("id",a).eq("meeting_id",s).select("*").single();if(n)throw n;return t},subscribeToMeetingUpdates(s,a){try{const r=o.channel(`meetings-updates-${s}`).on("postgres_changes",{event:"*",schema:"public",table:"meetings",filter:`id=eq.${s}`},t=>a?.(t)).subscribe();return{unsubscribe:()=>{try{o.removeChannel(r)}catch{}}}}catch(r){return console.warn("subscribeToMeetingUpdates failed",r),{unsubscribe:()=>{}}}}},C=Le,$e=()=>{const{id:s}=Ue(),a=Oe(),{toast:r}=ue(),[t,n]=x.useState(null),[d,m]=x.useState(!0),[u,j]=x.useState(null),[l,w]=x.useState([]),[v,N]=x.useState(!1),[M,O]=x.useState(""),[I,P]=x.useState(!1),[V,z]=x.useState(!1),c=i=>{const g=A(i);return{date:D(g,"dd 'de' MMMM 'de' yyyy",{locale:k}),time:D(g,"HH:mm",{locale:k})}},h=x.useCallback(async()=>{try{m(!0),j(null);const i=await C.getMeetingById(s);if(!i)throw new Error("Reunião não encontrada");n(i),O(i.notes||""),!i.participants||i.participants.length===0?f(i.id):w(i.participants)}catch(i){console.error("Error fetching meeting details:",i),j(i.message||"Não foi possível carregar os detalhes da reunião."),r({variant:"destructive",title:"Erro ao carregar reunião",description:i.message||"Ocorreu um erro ao carregar os detalhes da reunião."})}finally{m(!1)}},[s,r,f]),f=x.useCallback(async i=>{try{z(!0);const g=await C.getMeetingParticipants(i);w(g)}catch(g){console.error("Error fetching participants:",g),r({variant:"destructive",title:"Erro ao carregar participantes",description:"Não foi possível carregar a lista de participantes da reunião."})}finally{z(!1)}},[r]),y=async()=>{if(window.confirm("Tem certeza que deseja excluir esta reunião? Esta ação não pode ser desfeita."))try{N(!0),await C.deleteMeeting(s),r({title:"Reunião excluída",description:"A reunião foi excluída com sucesso."}),a("/meetings")}catch(i){console.error("Error deleting meeting:",i),r({variant:"destructive",title:"Erro ao excluir reunião",description:i.message||"Não foi possível excluir a reunião. Tente novamente."})}finally{N(!1)}},K=async()=>{if(t)try{P(!0);const i=await C.updateMeeting(t.id,{...t,notes:M});n(i),r({title:"Notas salvas",description:"As anotações da reunião foram salvas com sucesso."})}catch(i){console.error("Error saving notes:",i),r({variant:"destructive",title:"Erro ao salvar anotações",description:"Não foi possível salvar as anotações da reunião."})}finally{P(!1)}},se=async(i,g)=>{try{await C.updateParticipantStatus(t.id,i,g),w(G=>G.map(W=>W.id===i?{...W,status:g,updated_at:new Date().toISOString()}:W)),r({title:"Status atualizado",description:"O status do participante foi atualizado com sucesso."})}catch(G){console.error("Error updating participant status:",G),r({variant:"destructive",title:"Erro ao atualizar status",description:"Não foi possível atualizar o status do participante."})}};if(x.useEffect(()=>{h();const i=C.subscribeToMeetingUpdates(s,g=>{console.log("Meeting update received:",g),h()});return()=>{i&&i.unsubscribe()}},[s,h]),d)return e.jsx("div",{className:"container mx-auto py-12 px-4",children:e.jsx(te,{size:"lg",text:"Carregando detalhes da reunião..."})});if(u||!t)return e.jsx("div",{className:"container mx-auto py-12 px-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(de,{className:"mx-auto h-12 w-12 text-destructive mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:u||"Reunião não encontrada"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Não foi possível carregar os detalhes da reunião solicitada."}),e.jsxs(p,{onClick:()=>a("/meetings"),children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Voltar para a lista de reuniões"]})]})});const{date:pe,time:je}=c(t.start_time),ve=D(A(t.end_time),"HH:mm",{locale:k}),q=Te(A(t.end_time)),L=t.meeting_type==="online";return e.jsx(De,{errorTitle:"Ocorreu um erro na página de detalhes da reunião",errorMessage:"Algo inesperado aconteceu. Por favor, tente recarregar a página.",children:e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs(p,{variant:"ghost",size:"icon",className:"mr-2",onClick:()=>a(-1),children:[e.jsx(re,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Voltar"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:t.title}),e.jsx("p",{className:"text-muted-foreground",children:"Detalhes e gerenciamento da reunião"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[e.jsxs(p,{variant:"outline",onClick:()=>a(`/meetings/edit/${t.id}`),children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),"Editar"]}),e.jsxs(p,{variant:"destructive",onClick:y,disabled:v,children:[v?e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Excluir"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(_,{children:[e.jsx(S,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-xl",children:t.title}),e.jsx($,{className:"mt-2",children:t.description||"Nenhuma descrição fornecida."})]}),e.jsx(R,{variant:q?"secondary":"default",className:"ml-2",children:q?"Realizada":"Agendada"})]})}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(ne,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Data e horário"}),e.jsxs("p",{className:"text-sm",children:[pe," • ",je," - ",ve]})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:L?e.jsx(ie,{className:"h-5 w-5 text-primary"}):e.jsx(be,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:L?"Link da reunião":"Local"}),L?e.jsx("a",{href:t.meeting_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:t.meeting_url}):e.jsx("p",{className:"text-sm",children:t.location||"Local não especificado"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(X,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Participantes"}),e.jsxs("div",{className:"flex -space-x-2 mt-1",children:[l.slice(0,5).map(i=>e.jsxs(J,{className:"border-2 border-background",children:[e.jsx(Q,{src:i.avatar_url,alt:i.name}),e.jsx(Y,{children:i.name.split(" ").map(g=>g[0]).join("").toUpperCase()})]},i.id)),l.length>5&&e.jsxs("div",{className:"h-10 w-10 rounded-full bg-muted flex items-center justify-center text-xs font-medium",children:["+",l.length-5]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[l.length," ",l.length===1?"participante":"participantes"]})]})]})]}),L&&!q&&e.jsx(le,{className:"border-t pt-4",children:e.jsx(p,{className:"w-full",asChild:!0,children:e.jsxs("a",{href:t.meeting_url,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Entrar na reunião"]})})})]}),e.jsxs(Ie,{defaultValue:"notes",children:[e.jsxs(ge,{className:"grid w-full grid-cols-3",children:[e.jsxs(B,{value:"notes",children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Anotações"]}),e.jsxs(B,{value:"participants",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Participantes"]}),e.jsxs(B,{value:"attachments",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Anexos"]})]}),e.jsx(H,{value:"notes",className:"mt-4",children:e.jsxs(_,{children:[e.jsxs(S,{children:[e.jsx(E,{children:"Anotações da Reunião"}),e.jsx($,{children:"Adicione notas e informações relevantes sobre esta reunião."})]}),e.jsx(b,{children:e.jsx(qe,{placeholder:"Adicione suas anotações aqui...",className:"min-h-[200px]",value:M,onChange:i=>O(i.target.value)})}),e.jsx(le,{className:"flex justify-end border-t pt-4",children:e.jsx(p,{onClick:K,disabled:I,children:I?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"mr-2 h-4 w-4"}),"Salvar anotações"]})})})]})}),e.jsx(H,{value:"participants",className:"mt-4",children:e.jsxs(_,{children:[e.jsxs(S,{children:[e.jsx(E,{children:"Participantes"}),e.jsx($,{children:"Lista de participantes confirmados e seus status."})]}),e.jsx(b,{children:V?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(te,{size:"md",text:"Carregando participantes..."})}):l.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhum participante adicionado a esta reunião."}):e.jsx("div",{className:"space-y-4",children:l.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(J,{children:[e.jsx(Q,{src:i.avatar_url,alt:i.name}),e.jsx(Y,{children:i.name.split(" ").map(g=>g[0]).join("").toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:i.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.email})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[i.status==="confirmed"?e.jsxs(R,{variant:"success",children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),"Confirmado"]}):i.status==="pending"?e.jsxs(R,{variant:"warning",children:[e.jsx(Ce,{className:"h-3 w-3 mr-1"}),"Pendente"]}):e.jsxs(R,{variant:"destructive",children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),"Recusado"]}),!q&&e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(p,{variant:"ghost",size:"sm",className:"h-8 px-2",onClick:()=>se(i.id,"confirmed"),disabled:i.status==="confirmed",children:e.jsx(oe,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"sm",className:"h-8 px-2",onClick:()=>se(i.id,"declined"),disabled:i.status==="declined",children:e.jsx(ce,{className:"h-4 w-4"})})]})]})]},i.id))})})]})}),e.jsx(H,{value:"attachments",className:"mt-4",children:e.jsxs(_,{children:[e.jsxs(S,{children:[e.jsx(E,{children:"Anexos da Reunião"}),e.jsx($,{children:"Arquivos compartilhados nesta reunião."})]}),e.jsx(b,{children:e.jsx(Pe,{meetingId:t.id,readOnly:q,onUploadSuccess:()=>{r({title:"Anexo adicionado",description:"O arquivo foi enviado com sucesso."})},onDeleteSuccess:()=>{r({title:"Anexo removido",description:"O arquivo foi removido com sucesso."})}})})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(_,{children:[e.jsx(S,{children:e.jsx(E,{className:"text-lg",children:"Ações Rápidas"})}),e.jsxs(b,{className:"space-y-2",children:[e.jsxs(p,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Enviar lembrete"]}),e.jsxs(p,{variant:"outline",className:"w-full justify-start",children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Adicionar participantes"]}),e.jsxs(p,{variant:"outline",className:"w-full justify-start",children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),"Reagendar"]}),e.jsxs(p,{variant:"outline",className:"w-full justify-start text-destructive hover:text-destructive",onClick:y,disabled:v,children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),v?"Excluindo...":"Excluir reunião"]})]})]}),e.jsxs(_,{children:[e.jsx(S,{children:e.jsx(E,{className:"text-lg",children:"Detalhes da Reunião"})}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Criada em"}),e.jsx("p",{className:"text-sm",children:D(A(t.created_at),"dd/MM/yyyy 'às' HH:mm",{locale:k})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Criada por"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsxs(J,{className:"h-6 w-6 mr-2",children:[e.jsx(Q,{src:t.creator?.avatar_url}),e.jsx(Y,{children:t.creator?.name?.split(" ").map(i=>i[0]).join("").toUpperCase()})]}),e.jsx("span",{className:"text-sm",children:t.creator?.name||"Usuário"})]})]}),t.updated_at!==t.created_at&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Última atualização"}),e.jsx("p",{className:"text-sm",children:D(A(t.updated_at),"dd/MM/yyyy 'às' HH:mm",{locale:k})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"ID da reunião"}),e.jsx("p",{className:"text-sm font-mono bg-muted px-2 py-1 rounded mt-1",children:t.id})]})]})]})]})]})]})})},Xe=Object.freeze(Object.defineProperty({__proto__:null,default:$e},Symbol.toStringTag,{value:"Module"}));export{te as L,C as M,Ie as T,ge as a,B as b,H as c,Pe as d,Xe as e};
