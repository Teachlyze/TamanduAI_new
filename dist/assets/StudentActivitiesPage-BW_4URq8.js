import{u as S,r as l,g as E,s as j,z as p,j as e,o as D,m as r,ah as g,C as I,c as y,ai as A,K as L,B as P,a0 as z,d as T}from"./main-BTTCSkdE.js";import{P as h}from"./PremiumCard-CV5gJlVo.js";import{P as $}from"./PremiumButton-TaG2j_oH.js";import{E as B}from"./EmptyState-j91SMhTI.js";import{F}from"./funnel-gLdLffK0.js";import{T as q}from"./target-DeybGG3h.js";function K(){const{user:u}=S(),[N,f]=l.useState(!1),[o,c]=l.useState([]),[b,x]=l.useState([]),[d,w]=l.useState(""),[m,_]=l.useState("all"),C=E();return l.useEffect(()=>{if(!u)return;let a=!0;return(async()=>{try{f(!0);const{data:s,error:t}=await j.from("class_members").select("class_id").eq("user_id",u.id).eq("role","student");if(t){console.error("‚ùå Erro ao buscar turmas do aluno:",t),p.error("Erro ao carregar suas turmas"),a&&c([]);return}const i=s?.map(k=>k.class_id)||[];if(i.length===0){console.log("‚ÑπÔ∏è Aluno n√£o est√° em nenhuma turma"),a&&c([]);return}const{data:n,error:v}=await j.from("activities").select(`
            id,
            title,
            description,
            due_date,
            max_score,
            activity_type,
            status,
            activity_class_assignments(
              class_id,
              classes(name, subject)
            ),
            classes (name, subject)
          `).in("activity_class_assignments.class_id",i).eq("status","published").order("due_date",{ascending:!0});if(v){console.error("‚ùå Erro ao buscar atividades:",v),p.error("Erro ao carregar atividades"),a&&c([]);return}console.log(`‚úÖ ${n?.length||0} atividades carregadas para o aluno`),a&&(c(n||[]),x(n||[]))}catch(s){console.error("‚ùå Erro inesperado:",s),p.error("Erro ao carregar atividades"),a&&(c([]),x([]))}finally{a&&f(!1)}})(),()=>{a=!1}},[u]),l.useEffect(()=>{let a=o;if(d&&(a=a.filter(s=>s.title?.toLowerCase().includes(d.toLowerCase())||s.description?.toLowerCase().includes(d.toLowerCase())||s.classes?.name?.toLowerCase().includes(d.toLowerCase()))),m!=="all"){const s=new Date;m==="pending"?a=a.filter(t=>new Date(t.due_date)>=s):m==="completed"&&(a=a.filter(t=>new Date(t.due_date)<s))}x(a)},[d,m,o]),N?e.jsx(D,{message:"Carregando suas atividades..."}):e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs(r.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-purple-500 via-pink-500 to-rose-500 p-8 text-white",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"32px 32px"}})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs(r.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.2},className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm rounded-full px-4 py-2 mb-4",children:[e.jsx(g,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Minhas Atividades"})]}),e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Organize suas Tarefas üìö"}),e.jsx("p",{className:"text-white/90 text-lg",children:"Acompanhe seus prazos e mantenha tudo em dia"})]}),e.jsx(r.div,{animate:{y:[0,-10,0],rotate:[0,5,0]},transition:{duration:3,repeat:1/0},className:"absolute top-20 right-32 w-20 h-20 bg-white/10 backdrop-blur-sm rounded-2xl"}),e.jsx(r.div,{animate:{y:[0,10,0],rotate:[0,-5,0]},transition:{duration:4,repeat:1/0,delay:1},className:"absolute bottom-10 right-20 w-16 h-16 bg-white/10 backdrop-blur-sm rounded-full"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{title:"Total",value:o.length,icon:g,gradient:"from-blue-500 to-cyan-500"},{title:"Pendentes",value:o.filter(a=>new Date(a.due_date)>=new Date).length,icon:I,gradient:"from-yellow-500 to-orange-500"},{title:"Pr√≥ximas 7 dias",value:o.filter(a=>{const s=Math.ceil((new Date(a.due_date)-new Date)/864e5);return s>=0&&s<=7}).length,icon:y,gradient:"from-red-500 to-pink-500"}].map((a,s)=>e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.1},children:e.jsxs(h,{variant:"elevated",className:"relative overflow-hidden group hover:scale-105 transition-transform",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${a.gradient} opacity-5 group-hover:opacity-10 transition-opacity`}),e.jsxs("div",{className:"relative p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${a.gradient} text-white`,children:e.jsx(a.icon,{className:"w-6 h-6"})})}),e.jsx("div",{className:"text-3xl font-bold mb-1",children:a.value}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a.title})]})]})},a.title))}),e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsx(h,{variant:"elevated",className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(L,{placeholder:"Buscar atividades...",value:d,onChange:a=>w(a.target.value),className:"pl-10"})]}),e.jsx("div",{className:"flex gap-2",children:["all","pending","completed"].map(a=>e.jsx($,{variant:m===a?"default":"outline",size:"sm",onClick:()=>_(a),leftIcon:F,className:"whitespace-nowrap inline-flex items-center gap-2 bg-white dark:bg-slate-900 text-foreground border-border rounded-lg",children:a==="all"?"Todas":a==="pending"?"Pendentes":"Conclu√≠das"},a))})]})})}),b.length===0?e.jsx(B,{icon:P,title:"Nenhuma atividade encontrada",description:o.length===0?"Quando seu professor publicar novas atividades, elas aparecer√£o aqui.":"Tente ajustar seus filtros de busca."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx(z,{children:b.map((a,s)=>{const t=Math.ceil((new Date(a.due_date)-new Date)/864e5),i=t>=0&&t<=2,n=t<0;return e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9},transition:{delay:s*.05},children:e.jsxs(h,{variant:"elevated",className:`group relative overflow-hidden hover:scale-105 transition-all cursor-pointer ${i?"border-2 border-orange-300 dark:border-orange-700":n?"border-2 border-red-300 dark:border-red-700":""}`,onClick:()=>C(`/dashboard/activities/${a.id}`),children:[i&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-500/10 to-red-500/10 rounded-xl blur"}),e.jsxs("div",{className:"relative p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 text-white",children:e.jsx(g,{className:"w-4 h-4"})}),e.jsx("h3",{className:"font-bold text-lg line-clamp-1 group-hover:text-primary transition-colors",children:a.title})]}),a.classes&&e.jsxs("span",{className:"inline-flex items-center text-xs px-3 py-1 bg-primary/10 text-primary rounded-full font-medium",children:["üìö ",a.classes.name]})]}),i&&e.jsx(r.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},children:e.jsx(y,{className:"w-6 h-6 text-orange-600"})})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-4",children:a.description||"Sem descri√ß√£o"}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(T,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(a.due_date).toLocaleDateString("pt-BR")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[a.max_score&&e.jsxs("span",{className:"text-xs font-bold text-primary",children:[e.jsx(q,{className:"w-3 h-3 inline mr-1"}),a.max_score," pts"]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${n?"bg-red-500 text-white":i?"bg-orange-500 text-white":"bg-primary/10 text-primary"}`,children:n?"‚è∞ Atrasada":t===0?"‚ö° Hoje!":t===1?"‚ö° Amanh√£":`üóìÔ∏è ${t} dias`})]})]})]})]})},a.id)})})})]})}export{K as default};
