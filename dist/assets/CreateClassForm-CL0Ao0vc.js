import{s as d,aX as J,g as le,u as ne,r as S,b0 as te,ai as ce,j as e,m as E,i as F,bl as de,x as q,F as L,H as O,B as me,I as V,y as $,bm as h,bn as x,bo as g,bp as p,K as C,bq as j,br as M,aA as ue,d as he,aC as K,aD as U,aE as Q,aF as W,aG as m,D as Z,U as xe,J as ee,a2 as ge,ah as T}from"./main-C_d-NeC0.js";import{a as pe,S as je,o as fe,b as ae,s as v,n as be}from"./separator-DDh6zTF5.js";import{t as se}from"./teacherSubscriptionService-Bf7_YBx4.js";import{t as X}from"./use-toast-BodzLjgA.js";import{B as ve}from"./badge-DbvBbrWQ.js";import{A as we,a as ye}from"./alert-C_l43Oi1.js";import{A as Ne}from"./arrow-left-CU0Dph18.js";import{T as re}from"./triangle-alert-OXKAA0WJ.js";import{S as _e}from"./school-tXOHGowM.js";import{C as Ce}from"./circle-check-big-CgP05W4G.js";import{P as Se}from"./plus-DUVhm2rw.js";import{G as Ee}from"./graduation-cap-BpCfpzCz.js";const ke={async getClasses({teacherId:i,studentId:r,activeOnly:s=!0}={}){let t=d.from("classes").select(`
        *,
        members:class_members(*, user:profiles(*)),
        meetings:meetings(*)
      `).order("name",{ascending:!0});i&&(t=t.eq("created_by",i)),s&&(t=t.eq("is_active",!0));const{data:o,error:u}=await t;if(u)throw console.error("Error fetching classes:",u),u;return r?o.filter(f=>f.members?.some(w=>w.user_id===r&&w.role==="student")):o},async getClassById(i){const{data:r,error:s}=await d.from("classes").select(`
        *,
        members:class_members(*, user:profiles(*)),
        meetings:meetings(*, 
          participants:meeting_participants(*, user:profiles(*))
        )
      `).eq("id",i).single();if(s)throw console.error(`Error fetching class ${i}:`,s),s;return r},async createClass(i,r=[]){const{name:s,description:t,teacher_id:o,subject:u,course:f,period:w,grade_level:y,academic_year:P,color:N,student_capacity:B,chatbot_enabled:_,school_id:G,is_school_managed:Y}=i,{data:z,error:H}=await d.from("profiles").select("id").eq("id",o).maybeSingle();if(!z&&!H){console.log("Profile not found for teacher, creating one...");const{error:c}=await d.from("profiles").insert([{id:o,role:"teacher",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]);if(c&&(console.error("Error creating teacher profile:",c),c.code!=="23505"))throw new Error(`Erro ao criar perfil do professor: ${c.message}`)}const I={name:s,description:t||null,created_by:o,subject:u||null,course:f||null,period:w||null,grade_level:y||null,academic_year:P||new Date().getFullYear(),color:N||"#6366f1",student_capacity:typeof B=="number"?B:30,chatbot_enabled:!!_,school_id:G||null,is_school_managed:!!Y,is_active:!0};console.log("Creating class with data:",I);const{data:l,error:b}=await d.from("classes").insert([I]).select().single();if(b)throw console.error("Error creating class:",b),console.error("Error details:",{code:b.code,message:b.message,details:b.details,hint:b.hint}),new Error(`Erro ao criar turma: ${b.message}. Detalhes: ${b.hint||b.details||"Nenhum detalhe adicional"}`);console.log("Class created successfully:",l);try{await J.send("classCreated",{userId:o,variables:{className:s},channelOverride:"push",metadata:{classId:l.id}})}catch(c){console.warn("Falha ao notificar criaÃ§Ã£o de turma:",c)}try{const{error:c}=await d.from("class_members").insert([{class_id:l.id,user_id:o,role:"teacher",joined_at:new Date().toISOString()}]);c&&c.code!=="23505"&&console.warn("Erro ao adicionar professor como membro:",c)}catch(c){console.warn("Falha ao adicionar professor como membro da turma:",c)}if(r&&r.length>0)try{await this.addStudentsToClass(l.id,r)}catch(c){console.warn("Falha ao adicionar alunos:",c)}if(_)try{const{error:c}=await d.from("chatbot_configurations").insert({class_id:l.id,enabled:!0,keywords:[],themes:[],scope_restrictions:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()});c&&c.code!=="23505"?console.warn("Erro ao criar configuraÃ§Ã£o do chatbot:",c):console.log("Chatbot configuration created for class:",l.id)}catch(c){console.warn("Falha ao inicializar chatbot:",c)}return this.getClassById(l.id)},async updateClass(i,r,s){const{error:t}=await d.from("classes").update({...r,updated_at:new Date().toISOString()}).eq("id",i);if(t)throw console.error(`Error updating class ${i}:`,t),t;if(Array.isArray(s)){const{data:o}=await d.from("class_members").select("user_id").eq("class_id",i).eq("role","student"),u=(o||[]).map(y=>y.user_id),f=s.filter(y=>!u.includes(y)),w=u.filter(y=>!s.includes(y));await Promise.all([this.addStudentsToClass(i,f),this.removeStudentsFromClass(i,w)])}return this.getClassById(i)},async deleteClass(i){const{error:r}=await d.from("classes").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",i);if(r)throw console.error(`Error deleting class ${i}:`,r),r;return!0},async addStudentsToClass(i,r){if(!r||r.length===0)return[];const{data:s,error:t}=await d.from("class_members").insert(r.map(o=>({class_id:i,user_id:o,role:"student",joined_at:new Date().toISOString()}))).select();if(t)throw console.error(`Error adding students to class ${i}:`,t),t;try{const[{data:o},{data:u}]=await Promise.all([d.from("classes").select("id, name, created_by").eq("id",i).single(),d.from("profiles").select("id, full_name").in("id",r)]);if(o?.created_by&&u?.length)for(const f of u)await J.send("studentAddedToClass",{userId:o.created_by,variables:{studentName:f.full_name||"Aluno",className:o.name||"Turma"},channelOverride:"push",metadata:{classId:i,studentId:f.id}})}catch(o){console.warn("Falha ao notificar alunos adicionados:",o)}return s},async removeStudentsFromClass(i,r){if(!r||r.length===0)return!0;const{error:s}=await d.from("class_members").delete().eq("class_id",i).in("user_id",r).eq("role","student");if(s)throw console.error(`Error removing students from class ${i}:`,s),s;try{const[{data:t},{data:o}]=await Promise.all([d.from("classes").select("id, name").eq("id",i).single(),d.from("profiles").select("id, full_name").in("id",r)]);for(const u of o||[])await J.send("studentRemovedFromClass",{userId:u.id,email:void 0,variables:{className:t?.name||"Turma"},metadata:{classId:i}})}catch(t){console.warn("Falha ao notificar alunos removidos:",t)}return!0},async searchClasses(i,{onlyActive:r=!0}={}){let s=d.from("classes").select("*").or(`name.ilike.%${i}%,description.ilike.%${i}%`);r&&(s=s.eq("is_active",!0));const{data:t,error:o}=await s;if(o)throw console.error("Error searching classes:",o),o;return t},subscribeToClasses(i){const r=d.channel("classes_changes").on("postgres_changes",{event:"*",schema:"public",table:"classes"},s=>{i(s)}).subscribe();return()=>{d.removeChannel(r)}}},Ae=fe({name:v().min(3,"Nome da turma deve ter pelo menos 3 caracteres"),subject:v().min(2,"MatÃ©ria Ã© obrigatÃ³ria"),description:v().optional(),course:v().optional(),period:v().optional(),academic_year:v().min(1,"Ano letivo Ã© obrigatÃ³rio"),grade_level:v().min(1,"NÃ­vel Ã© obrigatÃ³rio"),student_capacity:be().min(1,"Capacidade deve ser pelo menos 1").max(100,"Capacidade mÃ¡xima Ã© 100"),color:v().min(1,"Selecione uma cor"),room_number:v().optional(),is_online:ae().default(!1),meeting_link:v().optional(),school_id:v().optional(),is_school_managed:ae().default(!1)}),Ie=()=>{const i=le(),{user:r}=ne(),[s,t]=S.useState(!1),[o,u]=S.useState([]),[f,w]=S.useState(null),[y,P]=S.useState(!1),[N,B]=S.useState(null),[_,G]=S.useState([]),[Y,z]=S.useState(!0),H=[{name:"Azul",value:"blue",class:"bg-blue-500"},{name:"Verde",value:"green",class:"bg-green-500"},{name:"Roxo",value:"purple",class:"bg-purple-500"},{name:"Rosa",value:"pink",class:"bg-pink-500"},{name:"Laranja",value:"orange",class:"bg-orange-500"},{name:"Vermelho",value:"red",class:"bg-red-500"},{name:"Amarelo",value:"yellow",class:"bg-yellow-500"},{name:"Ãndigo",value:"indigo",class:"bg-indigo-500"}],I=[{id:1,name:"Ana Silva",email:"ana@email.com"},{id:2,name:"JoÃ£o Santos",email:"joao@email.com"},{id:3,name:"Maria Oliveira",email:"maria@email.com"},{id:4,name:"Pedro Costa",email:"pedro@email.com"},{id:5,name:"Carla Souza",email:"carla@email.com"}],l=te({resolver:pe(Ae),defaultValues:{name:"",subject:"",description:"",course:"",period:"",academic_year:new Date().getFullYear().toString(),grade_level:"",student_capacity:30,room_number:"",is_online:!1,meeting_link:"",color:"blue",school_id:"",is_school_managed:!1}});ce.useEffect(()=>{(async()=>{if(r)try{z(!0);const{data:n,error:D}=await d.from("school_teachers").select("school_id, schools(id, name)").eq("user_id",r.id).eq("status","active");if(D)throw D;const k=(n||[]).map(R=>R.schools).filter(Boolean);G(k),k.length===1&&(l.setValue("school_id",k[0].id),l.setValue("is_school_managed",!0))}catch(n){console.error("Erro ao carregar escolas:",n)}finally{z(!1)}})()},[r]);const b=async a=>{if(!r){X({variant:"destructive",title:"Erro de autenticaÃ§Ã£o",description:"VocÃª precisa estar logado para criar uma turma."});return}t(!0),w(null);try{if(!await se.checkCanCreateClass(r.id)){const A=await se.getUsageStats(r.id);B(A),P(!0),t(!1);return}T.info("Iniciando criaÃ§Ã£o de turma",{teacherId:r.id,className:a.name,subject:a.subject});const D={name:a.name,description:a.description||"",created_by:r.id,subject:a.subject,course:a.course||"",period:a.period||"",grade_level:a.grade_level,academic_year:a.academic_year,color:a.color,student_capacity:a.student_capacity,room_number:a.room_number||"",is_online:a.is_online||!1,meeting_link:a.meeting_link||"",chatbot_enabled:!1,school_id:a.school_id||null,is_school_managed:!!a.is_school_managed,is_active:!0};T.info("Dados da turma para criaÃ§Ã£o:",D);const k=await ke.createClass(D);T.info("Turma criada com sucesso",{classId:k.id,className:k.name});let R=null;try{}catch(A){T.warn("Falha ao gerar convite padrÃ£o da turma",{error:A.message})}if(o&&o.length>0){for(const A of o)if(A.email)try{}catch(oe){T.warn("Falha ao gerar convite para aluno",{email:A.email,error:oe.message})}}X({title:"âœ… Turma criada com sucesso!",description:R?`Convite gerado. Copie o link para compartilhar: ${R}`:`A turma "${a.name}" foi criada e estÃ¡ pronta para receber alunos.`}),setTimeout(()=>i("/dashboard/classes"),1200)}catch(n){T.error("Erro ao criar turma",{error:n.message,teacherId:r.id}),w(n.message),X({variant:"destructive",title:"âŒ Erro ao criar turma",description:n.message||"NÃ£o foi possÃ­vel criar a turma. Verifique sua conexÃ£o e tente novamente."})}finally{t(!1)}},c=a=>{o.find(n=>n.id===a.id)||u([...o,a])},ie=a=>{u(o.filter(n=>n.id!==a))};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:e.jsxs("div",{className:"w-full space-y-8 p-6",children:[e.jsxs(E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative overflow-hidden bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 rounded-3xl p-8 text-white",children:[e.jsx("div",{className:"absolute inset-0 bg-black/10"}),e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>i("/dashboard/classes"),className:"text-white hover:bg-white/20 h-10 w-10",disabled:s,children:e.jsx(Ne,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Nova Turma"}),e.jsx("p",{className:"text-purple-100 text-lg",children:"Crie uma nova turma e comece a ensinar"})]})]})}),e.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/10 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-8 -left-8 w-32 h-32 bg-white/5 rounded-full blur-2xl"})]}),f&&e.jsx(E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:e.jsxs(we,{variant:"destructive",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx(ye,{children:f})]})}),e.jsx(de,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(b),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:e.jsxs(q,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(L,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(me,{className:"w-4 h-4 text-white"})}),"InformaÃ§Ãµes BÃ¡sicas"]}),e.jsx(V,{children:"Defina as informaÃ§Ãµes principais da turma"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsx(h,{control:l.control,name:"name",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Nome da Turma"}),e.jsx(p,{children:e.jsx(C,{placeholder:"Ex: MatemÃ¡tica 9A",...a,disabled:s})}),e.jsx(j,{})]})}),e.jsx(h,{control:l.control,name:"subject",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"MatÃ©ria"}),e.jsx(p,{children:e.jsx(C,{placeholder:"Ex: MatemÃ¡tica, EducaÃ§Ã£o FÃ­sica, Yoga...",...a,disabled:s})}),e.jsx(M,{className:"text-xs",children:"Digite o nome da matÃ©ria ou atividade que vocÃª ensina"}),e.jsx(j,{})]})}),e.jsx(h,{control:l.control,name:"description",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"DescriÃ§Ã£o (Opcional)"}),e.jsx(p,{children:e.jsx(ue,{placeholder:"Descreva os objetivos e conteÃºdo da turma...",className:"min-h-[100px]",...a,disabled:s})}),e.jsx(j,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(h,{control:l.control,name:"course",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Course (Opcional)"}),e.jsx(p,{children:e.jsx(C,{placeholder:"Ex: STEM, Linguagens",...a,disabled:s})}),e.jsx(j,{})]})}),e.jsx(h,{control:l.control,name:"period",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Period (Opcional)"}),e.jsx(p,{children:e.jsx(C,{placeholder:"Ex: morning, afternoon, night",...a,disabled:s})}),e.jsx(j,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(h,{control:l.control,name:"room_number",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"NÃºmero da Sala (Opcional)"}),e.jsx(p,{children:e.jsx(C,{placeholder:"Ex: Sala 12, Lab A",...a,disabled:s})}),e.jsx(j,{})]})}),e.jsx(h,{control:l.control,name:"is_online",render:({field:a})=>e.jsxs(x,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(g,{children:"Aula Online"}),e.jsx(M,{className:"text-xs",children:"Marque se a turma Ã© online"})]}),e.jsx(p,{children:e.jsx("input",{type:"checkbox",checked:a.value,onChange:a.onChange,disabled:s,className:"w-4 h-4"})})]})})]}),l.watch("is_online")&&e.jsx(h,{control:l.control,name:"meeting_link",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Link da ReuniÃ£o"}),e.jsx(p,{children:e.jsx(C,{placeholder:"Ex: https://meet.google.com/...",...a,disabled:s})}),e.jsx(j,{})]})})]})]})}),e.jsx(E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:e.jsxs(q,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(L,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-green-600 rounded-lg flex items-center justify-center",children:e.jsx(he,{className:"w-4 h-4 text-white"})}),"Ano letivo e nÃ­vel"]}),e.jsx(V,{children:"Configure o ano letivo e o nÃ­vel/sÃ©rie"})]}),e.jsx($,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(h,{control:l.control,name:"academic_year",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Ano letivo"}),e.jsx(p,{children:e.jsx(C,{placeholder:"Ex: 2025",...a,disabled:s})}),e.jsx(j,{})]})}),e.jsx(h,{control:l.control,name:"grade_level",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"NÃ­vel/SÃ©rie"}),e.jsxs(K,{onValueChange:a.onChange,defaultValue:a.value,disabled:s,children:[e.jsx(p,{children:e.jsx(U,{children:e.jsx(Q,{placeholder:"Selecione o nÃ­vel"})})}),e.jsxs(W,{children:[e.jsx(m,{value:"infantil",children:"EducaÃ§Ã£o Infantil"}),e.jsx(m,{value:"1ano",children:"1Âº Ano - Fundamental"}),e.jsx(m,{value:"2ano",children:"2Âº Ano - Fundamental"}),e.jsx(m,{value:"3ano",children:"3Âº Ano - Fundamental"}),e.jsx(m,{value:"4ano",children:"4Âº Ano - Fundamental"}),e.jsx(m,{value:"5ano",children:"5Âº Ano - Fundamental"}),e.jsx(m,{value:"6ano",children:"6Âº Ano - Fundamental"}),e.jsx(m,{value:"7ano",children:"7Âº Ano - Fundamental"}),e.jsx(m,{value:"8ano",children:"8Âº Ano - Fundamental"}),e.jsx(m,{value:"9ano",children:"9Âº Ano - Fundamental"}),e.jsx(m,{value:"1medio",children:"1Âº Ano - Ensino MÃ©dio"}),e.jsx(m,{value:"2medio",children:"2Âº Ano - Ensino MÃ©dio"}),e.jsx(m,{value:"3medio",children:"3Âº Ano - Ensino MÃ©dio"}),e.jsx(m,{value:"tecnico",children:"TÃ©cnico/Profissionalizante"}),e.jsx(m,{value:"superior",children:"Ensino Superior"}),e.jsx(m,{value:"pos",children:"PÃ³s-GraduaÃ§Ã£o"}),e.jsx(m,{value:"livre",children:"Curso Livre"})]})]}),e.jsx(j,{})]})})]})})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.1},children:e.jsxs(q,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(L,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx(_e,{className:"w-4 h-4 text-white"})}),"ConfiguraÃ§Ãµes da Turma"]}),e.jsx(V,{children:"Defina sÃ©rie, capacidade e outras configuraÃ§Ãµes"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(h,{control:l.control,name:"student_capacity",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Capacidade"}),e.jsx(p,{children:e.jsx(C,{type:"number",min:"1",max:"100",...a,onChange:n=>a.onChange(parseInt(n.target.value)||1),disabled:s})}),e.jsx(M,{children:"NÃºmero mÃ¡ximo de alunos"}),e.jsx(j,{})]})}),e.jsx(h,{control:l.control,name:"school_id",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Escola Vinculada"}),Y?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Z,{className:"w-4 h-4 animate-spin"}),"Carregando escolas..."]}):_.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Nenhuma escola vinculada"}):_.length===1?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsx(Ce,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-900 dark:text-green-100",children:_[0].name})]}):e.jsxs(K,{onValueChange:a.onChange,defaultValue:a.value,disabled:s,children:[e.jsx(p,{children:e.jsx(U,{children:e.jsx(Q,{placeholder:"Selecione a escola"})})}),e.jsx(W,{children:_.map(n=>e.jsx(m,{value:n.id,children:n.name},n.id))})]}),e.jsx(M,{className:"text-xs",children:_.length===0?"VocÃª pode criar turmas independentes ou aguardar convite de uma escola":"Turma serÃ¡ vinculada automaticamente a esta escola"}),e.jsx(j,{})]})})]}),_.length>0&&e.jsx(h,{control:l.control,name:"is_school_managed",render:({field:a})=>e.jsxs(x,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(g,{children:"Turma Gerenciada pela Escola"}),e.jsx(M,{className:"text-xs",children:"A escola terÃ¡ acesso total aos dados e relatÃ³rios desta turma"})]}),e.jsx(p,{children:e.jsx("input",{type:"checkbox",checked:a.value,onChange:a.onChange,disabled:s,className:"w-4 h-4"})})]})}),e.jsx(h,{control:l.control,name:"color",render:({field:a})=>e.jsxs(x,{children:[e.jsx(g,{children:"Cor da Turma"}),e.jsx(p,{children:e.jsx("div",{className:"grid grid-cols-4 gap-2",children:H.map(n=>e.jsx("button",{type:"button",onClick:()=>a.onChange(n.value),disabled:s,className:`
                                      relative h-12 rounded-lg border-2 transition-all duration-200
                                      ${n.class}
                                      ${a.value===n.value?"border-white shadow-lg scale-105":"border-transparent hover:scale-105"}
                                      ${s?"opacity-50 cursor-not-allowed":""}
                                    `,title:n.name,children:a.value===n.value&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-4 h-4 bg-white rounded-full"})})},n.value))})}),e.jsx(j,{})]})})]})]})}),e.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},children:e.jsxs(q,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(L,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg flex items-center justify-center",children:e.jsx(xe,{className:"w-4 h-4 text-white"})}),"Alunos (Opcional)"]}),e.jsx(V,{children:"Adicione alunos Ã  turma agora ou faÃ§a isso depois"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ee,{children:["Alunos Selecionados (",o.length,")"]}),o.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:o.map(a=>e.jsxs(ve,{variant:"secondary",className:"flex items-center gap-1",children:[a.name,e.jsx("button",{type:"button",onClick:()=>ie(a.id),disabled:s,className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5 disabled:opacity-50",children:e.jsx(ge,{className:"w-3 h-3"})})]},a.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum aluno selecionado"})]}),e.jsx(je,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ee,{children:"Alunos DisponÃ­veis"}),e.jsx("div",{className:"max-h-40 overflow-y-auto space-y-2",children:I.filter(a=>!o.find(n=>n.id===a.id)).map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:a.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.email})]}),e.jsxs(F,{type:"button",size:"sm",variant:"outline",onClick:()=>c(a),disabled:s,children:[e.jsx(Se,{className:"w-3 h-3 mr-1"}),"Adicionar"]})]},a.id))})]})]})]})})]})]}),e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"flex justify-end gap-4 pt-6 bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-white/50 shadow-lg",children:[e.jsx(F,{type:"button",variant:"outline",onClick:()=>i("/dashboard/classes"),disabled:s,className:"bg-white/70 backdrop-blur-sm hover:bg-white/80",children:"Cancelar"}),e.jsx(F,{type:"submit",disabled:s,className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white min-w-[140px] shadow-lg hover:shadow-xl transition-all duration-300",children:s?e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Criando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"mr-2 h-4 w-4"}),"Criar Turma"]})})]})]})}),y&&N&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(q,{className:"w-full max-w-md",children:[e.jsxs(L,{children:[e.jsxs(O,{className:"flex items-center gap-2 text-orange-600",children:[e.jsx(re,{className:"h-5 w-5"}),"Limite de Turmas Atingido"]}),e.jsx(V,{children:"VocÃª atingiu o limite do seu plano atual"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsxs("p",{className:"font-semibold text-gray-900 mb-2",children:["Plano Atual: ",e.jsx("span",{className:"text-orange-600 uppercase",children:N.plan})]}),e.jsxs("p",{className:"text-gray-700",children:["Turmas criadas: ",e.jsxs("span",{className:"font-bold",children:[N.currentClasses,"/",N.maxClasses]})]}),N.linkedSchools>0&&e.jsxs("p",{className:"text-gray-600 text-sm mt-2",children:["ðŸ’¼ VocÃª estÃ¡ vinculado a ",N.linkedSchools," escola(s)"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Para criar mais turmas, vocÃª pode:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-700",children:[e.jsx("li",{children:"Remover uma turma antiga"}),e.jsx("li",{children:"Fazer upgrade para um plano superior"}),N.linkedSchools===0&&e.jsx("li",{children:"Vincular-se a uma escola (turmas ilimitadas)"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(F,{variant:"outline",className:"flex-1",onClick:()=>P(!1),children:"Voltar"}),e.jsx(F,{className:"flex-1 bg-gradient-to-r from-indigo-600 to-purple-600",onClick:()=>i("/settings/subscription"),children:"Ver Planos"})]})]})]})})]})})};export{Ie as default};
