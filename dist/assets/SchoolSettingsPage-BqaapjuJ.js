import{f as E,u as L,r as d,s as y,j as e,a1 as _,A as U,d as A,U as q}from"./main-BrBEgNdp.js";import{s as D}from"./schoolService-BY_umBY5.js";import{S as F}from"./save-DXG_0NCy.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],B=E("image",I),O=()=>{const{user:o}=L(),[i,w]=d.useState(null),[k,x]=d.useState(!0),[a,g]=d.useState(!1),[h,u]=d.useState(null),[p,m]=d.useState(null),[b,f]=d.useState(""),[S,j]=d.useState(""),[r,N]=d.useState({grading_scale:{excellent:9,good:7,passing:5},academic_periods:{bimester:!0,trimester:!1,semester:!1},features:{social_feed_enabled:!0,gamification_enabled:!0,allow_late_submissions:!0},notifications:{email_announcements:!0,email_reports:!0}});d.useEffect(()=>{v()},[o?.id]);const v=async()=>{if(o?.id)try{x(!0);const s=await D.getUserSchool(o.id);if(w(s),s?.id){const{data:l,error:n}=await y.from("schools").select("*").eq("id",s.id).single();if(n)throw n;if(l){f(l.name||"");const c={...r,...l.settings||{}};N(c),j(c?.branding?.logo_url||c?.logo_url||"")}}}catch(s){console.error("Error loading settings:",s),m("Erro ao carregar configurações")}finally{x(!1)}},C=async s=>{if(s.preventDefault(),!!i?.id)try{g(!0),m(null),u(null);const{error:l}=await y.from("schools").update({name:b.trim(),updated_at:new Date().toISOString()}).eq("id",i.id);if(l)throw l;u("Configurações salvas com sucesso!"),await v()}catch(l){m(l.message||"Erro ao salvar configurações")}finally{g(!1)}},t=(s,l,n)=>{N(c=>({...c,[s]:{...c[s],[l]:n}}))};return k?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-32 animate-pulse rounded-lg bg-muted"},s))}):i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Configurações da Escola"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Configure as preferências e padrões de ",i.name]})]}),e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-border/50 bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Informações Básicas"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Nome da Escola"}),e.jsx("input",{type:"text",value:b,onChange:s=>f(s.target.value),className:"w-full rounded-lg border border-border px-4 py-2 bg-white dark:bg-slate-900 text-foreground",disabled:a,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium",children:[e.jsx(B,{className:"mr-1 inline h-4 w-4"}),"URL do Logo"]}),e.jsx("input",{type:"url",value:S,onChange:s=>j(s.target.value),placeholder:"https://exemplo.com/logo.png",className:"w-full rounded-lg border border-border px-4 py-2 bg-white dark:bg-slate-900 text-foreground",disabled:a}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"URL pública da imagem do logo da escola"})]})]})]}),e.jsxs("div",{className:"rounded-2xl border border-border/50 bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Escala de Notas"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Excelente (≥)"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"10",value:r.grading_scale.excellent,onChange:s=>t("grading_scale","excellent",parseFloat(s.target.value)),className:"w-full rounded-lg border border-border px-4 py-2 bg-white dark:bg-slate-900 text-foreground",disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Bom (≥)"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"10",value:r.grading_scale.good,onChange:s=>t("grading_scale","good",parseFloat(s.target.value)),className:"w-full rounded-lg border border-border px-4 py-2 bg-white dark:bg-slate-900 text-foreground",disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Aprovado (≥)"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"10",value:r.grading_scale.passing,onChange:s=>t("grading_scale","passing",parseFloat(s.target.value)),className:"w-full rounded-lg border border-border px-4 py-2 bg-white dark:bg-slate-900 text-foreground",disabled:a})]})]})]}),e.jsxs("div",{className:"rounded-2xl border border-border/50 bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Períodos Acadêmicos"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.academic_periods.bimester,onChange:s=>t("academic_periods","bimester",s.target.checked),disabled:a}),e.jsx("span",{className:"text-sm",children:"Bimestral (4 períodos por ano)"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.academic_periods.trimester,onChange:s=>t("academic_periods","trimester",s.target.checked),disabled:a}),e.jsx("span",{className:"text-sm",children:"Trimestral (3 períodos por ano)"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.academic_periods.semester,onChange:s=>t("academic_periods","semester",s.target.checked),disabled:a}),e.jsx("span",{className:"text-sm",children:"Semestral (2 períodos por ano)"})]})]})]}),e.jsxs("div",{className:"rounded-2xl border border-border/50 bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Funcionalidades"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.features.social_feed_enabled,onChange:s=>t("features","social_feed_enabled",s.target.checked),disabled:a}),e.jsx("span",{className:"text-sm",children:"Habilitar feed social de conquistas"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.features.gamification_enabled,onChange:s=>t("features","gamification_enabled",s.target.checked),disabled:a}),e.jsx("span",{className:"text-sm",children:"Habilitar sistema de gamificação"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.features.allow_late_submissions,onChange:s=>t("features","allow_late_submissions",s.target.checked),disabled:a}),e.jsx("span",{className:"text-sm",children:"Permitir entregas atrasadas"})]})]})]}),e.jsxs("div",{className:"rounded-2xl border border-border/50 bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Notificações"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.notifications.email_announcements,onChange:s=>t("notifications","email_announcements",s.target.checked),disabled:a}),e.jsx("span",{className:"text-sm",children:"Enviar comunicados por email"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.notifications.email_reports,onChange:s=>t("notifications","email_reports",s.target.checked),disabled:a}),e.jsx("span",{className:"text-sm",children:"Enviar relatórios semanais por email"})]})]})]}),p&&e.jsx("div",{className:"rounded-lg bg-red-50 p-3 text-sm text-red-600",children:p}),h&&e.jsx("div",{className:"rounded-lg bg-green-50 p-3 text-sm text-green-600",children:h}),e.jsxs("button",{type:"submit",disabled:a,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-slate-600 to-slate-700 px-6 py-3 font-semibold text-white shadow-lg hover:from-slate-700 hover:to-slate-800 disabled:opacity-50 whitespace-nowrap",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{children:a?"Salvando...":"Salvar Configurações"})]})]})]}):e.jsx("div",{className:"rounded-2xl border border-border/50 bg-card p-8 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Escola não encontrada."})})};export{O as default};
