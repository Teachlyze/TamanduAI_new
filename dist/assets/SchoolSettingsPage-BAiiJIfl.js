import{u as w,r as l,s as v,z as d,j as e,o as S,a0 as C,K as i,A as E,d as P,U as A}from"./main-NgjJy_CG.js";import{s as I}from"./schoolService-0kUg_1__.js";import{P as c}from"./PremiumCard-BGO_It48.js";import{P as U}from"./PremiumButton-DDGOGflQ.js";import{I as F}from"./image-nh9CRARA.js";import{S as L}from"./save-CY3ziv22.js";const R=()=>{const{user:n}=w(),[m,y]=l.useState(null),[_,x]=l.useState(!0),[g,u]=l.useState(!1),[h,p]=l.useState(""),[b,f]=l.useState(""),[a,r]=l.useState({grading_scale:{excellent:9,good:7,passing:5},academic_periods:{bimester:!0,trimester:!1,semester:!1},features:{social_feed_enabled:!0,gamification_enabled:!0,allow_late_submissions:!0},notifications:{email_announcements:!0,email_reports:!0}});l.useEffect(()=>{j()},[n?.id]);const j=async()=>{if(n?.id)try{x(!0);const s=await I.getUserSchool(n.id);if(y(s),s?.id){const{data:t,error:N}=await v.from("schools").select("*").eq("id",s.id).single();if(N)throw N;if(t){p(t.name||"");const o={...a,...t.settings||{}};r(o),f(o?.branding?.logo_url||o?.logo_url||"")}}}catch(s){console.error("Error loading settings:",s),d.error("Erro ao carregar configurações")}finally{x(!1)}},k=async s=>{if(s.preventDefault(),!!m?.id)try{u(!0);const{error:t}=await v.from("schools").update({name:h,settings:{...a,branding:{logo_url:b}},updated_at:new Date().toISOString()}).eq("id",m.id);if(t)throw t;d.success("Configurações salvas com sucesso!"),j()}catch(t){console.error("Error saving settings:",t),d.error("Erro ao salvar configurações")}finally{u(!1)}};return _?e.jsx(S,{message:"Carregando configurações..."}):e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-slate-600 via-slate-700 to-slate-800 p-8 rounded-2xl text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(C,{className:"w-8 h-8"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Configurações"})]}),e.jsx("p",{className:"text-white/90",children:"Personalize as configurações da sua instituição"})]}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsx(c,{variant:"elevated",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(F,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-xl font-bold",children:"Informações Básicas"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Nome da Instituição"}),e.jsx(i,{type:"text",value:h,onChange:s=>p(s.target.value),placeholder:"Ex: Colégio ABC",className:"bg-white dark:bg-slate-900 text-foreground border-border",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"URL do Logo"}),e.jsx(i,{type:"url",value:b,onChange:s=>f(s.target.value),placeholder:"https://exemplo.com/logo.png",className:"bg-white dark:bg-slate-900 text-foreground border-border"})]})]})]})}),e.jsx(c,{variant:"elevated",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(E,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-xl font-bold",children:"Escala de Notas"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Excelente (≥)"}),e.jsx(i,{type:"number",step:"0.1",min:"0",max:"10",value:a.grading_scale.excellent,onChange:s=>r({...a,grading_scale:{...a.grading_scale,excellent:parseFloat(s.target.value)}}),className:"bg-white dark:bg-slate-900 text-foreground border-border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Bom (≥)"}),e.jsx(i,{type:"number",step:"0.1",min:"0",max:"10",value:a.grading_scale.good,onChange:s=>r({...a,grading_scale:{...a.grading_scale,good:parseFloat(s.target.value)}}),className:"bg-white dark:bg-slate-900 text-foreground border-border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Mínimo (≥)"}),e.jsx(i,{type:"number",step:"0.1",min:"0",max:"10",value:a.grading_scale.passing,onChange:s=>r({...a,grading_scale:{...a.grading_scale,passing:parseFloat(s.target.value)}}),className:"bg-white dark:bg-slate-900 text-foreground border-border"})]})]})]})}),e.jsx(c,{variant:"elevated",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(P,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-xl font-bold",children:"Períodos Acadêmicos"})]}),e.jsx("div",{className:"space-y-3",children:Object.keys(a.academic_periods).map(s=>e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.academic_periods[s],onChange:t=>r({...a,academic_periods:{...a.academic_periods,[s]:t.target.checked}}),className:"w-5 h-5 rounded border-border text-primary focus:ring-primary"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300 capitalize",children:s})]},s))})]})}),e.jsx(c,{variant:"elevated",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(A,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-xl font-bold",children:"Funcionalidades"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.features.social_feed_enabled,onChange:s=>r({...a,features:{...a.features,social_feed_enabled:s.target.checked}}),className:"w-5 h-5 rounded border-border text-primary focus:ring-primary"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:"Feed Social Habilitado"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.features.gamification_enabled,onChange:s=>r({...a,features:{...a.features,gamification_enabled:s.target.checked}}),className:"w-5 h-5 rounded border-border text-primary focus:ring-primary"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:"Gamificação Habilitada"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.features.allow_late_submissions,onChange:s=>r({...a,features:{...a.features,allow_late_submissions:s.target.checked}}),className:"w-5 h-5 rounded border-border text-primary focus:ring-primary"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:"Permitir Submissões Atrasadas"})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(U,{type:"submit",variant:"gradient",disabled:g,className:"whitespace-nowrap inline-flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:g?"Salvando...":"Salvar Alterações"})]})})]})]})};export{R as default};
