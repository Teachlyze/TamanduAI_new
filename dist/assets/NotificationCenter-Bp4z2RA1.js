import{f as L,u as A,r as n,s as x,z as i,j as a,o as $,m as l,ai as q,Z as f,a1 as y,t as B,d as D,ah as I,A as M}from"./main-BTTCSkdE.js";import{P as b}from"./PremiumCard-CV5gJlVo.js";import{E as P}from"./EmptyState-j91SMhTI.js";import{B as z}from"./badge-BTDSVm_c.js";import{B as d}from"./bell-3lNzrUcV.js";import{T as H}from"./trash-2-BWX-Vf9e.js";import{T as R}from"./triangle-alert-h67Np2YJ.js";import{M as F}from"./message-circle-CEucVuA9.js";import{f as V}from"./formatDistanceToNow-BxKHLmYO.js";import{p as X}from"./pt-BR-CVz3wboC.js";import"./PremiumButton-TaG2j_oH.js";import"./constructNow-BUe0KqNa.js";import"./toDate-B_SDEMqy.js";import"./en-US-C1KUdeex.js";import"./endOfMonth-5f4-gZt5.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],Q=L("check-check",O),ce=()=>{const{user:u}=A(),[h,m]=n.useState([]),[v,g]=n.useState(!0),[o,N]=n.useState("all"),[p,j]=n.useState("");n.useEffect(()=>{u&&k()},[u]);const k=async()=>{try{g(!0);const{data:e,error:r}=await x.from("notifications").select("*").eq("user_id",u.id).order("created_at",{ascending:!1}).limit(100);if(r)throw r;m(e||[])}catch(e){console.error("Erro ao carregar notificações:",e),i.error("Erro ao carregar notificações")}finally{g(!1)}},w=h.filter(e=>{if(o==="unread"&&e.is_read||o==="xp"&&e.type!=="xp_gained"||o==="system"&&e.type==="xp_gained")return!1;if(p.trim()){const r=p.toLowerCase();return e.title?.toLowerCase().includes(r)||e.message?.toLowerCase().includes(r)}return!0}),_=async e=>{try{const{error:r}=await x.from("notifications").update({is_read:!0,read_at:new Date().toISOString()}).eq("id",e);if(r)throw r;m(s=>s.map(t=>t.id===e?{...t,is_read:!0}:t))}catch(r){console.error("Erro ao marcar como lida:",r)}},C=async()=>{try{const e=h.filter(s=>!s.is_read).map(s=>s.id);if(e.length===0){i.success("Todas já estão lidas!");return}const{error:r}=await x.from("notifications").update({is_read:!0,read_at:new Date().toISOString()}).in("id",e);if(r)throw r;m(s=>s.map(t=>({...t,is_read:!0}))),i.success(`${e.length} notificações marcadas como lidas`)}catch(e){console.error("Erro ao marcar todas como lidas:",e),i.error("Erro ao marcar como lidas")}},S=async e=>{try{const{error:r}=await x.from("notifications").delete().eq("id",e);if(r)throw r;m(s=>s.filter(t=>t.id!==e)),i.success("Notificação removida")}catch(r){console.error("Erro ao deletar notificação:",r),i.error("Erro ao deletar notificação")}},T=e=>({xp_gained:f,level_up:M,activity:I,message:F,system:y,calendar:D,alert:R})[e]||d,E=e=>({xp_gained:"from-yellow-500 to-orange-500",level_up:"from-purple-500 to-pink-500",activity:"from-blue-500 to-cyan-500",message:"from-green-500 to-emerald-500",system:"from-gray-500 to-slate-500",calendar:"from-indigo-500 to-purple-500",alert:"from-red-500 to-orange-500"})[e]||"from-blue-500 to-purple-500";if(v)return a.jsx($,{message:"Carregando notificações..."});const c=h.filter(e=>!e.is_read).length;return a.jsxs("div",{className:"space-y-6 pb-8",children:[a.jsxs(l.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 p-8 rounded-2xl text-white relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 opacity-10",children:a.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"32px 32px"}})}),a.jsx("div",{className:"relative z-10",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(d,{className:"w-8 h-8"}),a.jsx("h1",{className:"text-3xl font-bold",children:"Central de Notificações"})]}),a.jsx("p",{className:"text-white/90",children:c>0?`${c} notificação${c>1?"ões":""} não lida${c>1?"s":""}`:"Todas as notificações lidas"})]}),c>0&&a.jsxs(l.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:C,className:"whitespace-nowrap inline-flex items-center gap-2 px-6 py-3 bg-white/20 backdrop-blur-sm border-white/30 text-white hover:bg-white/30 rounded-xl font-semibold shadow-lg transition-colors",children:[a.jsx(Q,{className:"w-5 h-5"}),"Marcar Todas como Lidas"]})]})})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),a.jsx("input",{type:"text",placeholder:"Buscar notificações...",value:p,onChange:e=>j(e.target.value),className:"w-full pl-10 pr-4 py-3 rounded-xl border-2 border-border bg-white dark:bg-slate-900 text-foreground focus:border-primary transition-colors"})]})}),a.jsx("div",{className:"flex gap-2 flex-wrap",children:[{value:"all",label:"Todas",icon:d},{value:"unread",label:"Não Lidas",icon:d},{value:"xp",label:"XP",icon:f},{value:"system",label:"Sistema",icon:y}].map(e=>a.jsxs(l.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>N(e.value),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap inline-flex items-center gap-2 ${o===e.value?"bg-primary text-primary-foreground shadow-lg":"bg-white dark:bg-slate-900 text-foreground border border-border hover:bg-muted"}`,children:[a.jsx(e.icon,{className:"w-4 h-4"}),e.label]},e.value))})]}),a.jsx("div",{className:"space-y-3",children:w.length===0?a.jsx(b,{variant:"elevated",children:a.jsx("div",{className:"p-12",children:a.jsx(P,{icon:d,title:"Nenhuma notificação",description:p.trim()?"Nenhuma notificação encontrada para sua busca":o==="unread"?"Você não tem notificações não lidas":o==="xp"?"Você não tem notificações de XP":"Você não tem notificações"})})}):w.map((e,r)=>{const s=T(e.type),t=E(e.type);return a.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},transition:{delay:r*.05},children:a.jsx(b,{variant:"elevated",className:`overflow-hidden transition-all ${e.is_read?"opacity-70 hover:opacity-100":"border-l-4 border-l-primary shadow-lg"}`,children:a.jsx("div",{className:"p-4",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${t} text-white flex-shrink-0`,children:a.jsx(s,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[a.jsx("h3",{className:"font-bold text-lg",children:e.title}),!e.is_read&&a.jsx(z,{variant:"default",className:"whitespace-nowrap",children:"Nova"})]}),a.jsx("p",{className:"text-muted-foreground mb-3",children:e.message}),e.metadata&&e.type==="xp_gained"&&a.jsxs("div",{className:"flex items-center gap-2 mb-3 p-2 rounded-lg bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-300 dark:border-yellow-700",children:[a.jsx(f,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400"}),a.jsxs("span",{className:"text-sm font-semibold text-yellow-700 dark:text-yellow-300",children:["+",e.metadata.xp," XP"]}),e.metadata.source&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-yellow-600 dark:text-yellow-400",children:"•"}),a.jsx("span",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:e.metadata.source})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:V(new Date(e.created_at),{addSuffix:!0,locale:X})}),a.jsxs("div",{className:"flex items-center gap-2",children:[!e.is_read&&a.jsxs(l.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>_(e.id),className:"px-3 py-1.5 rounded-lg bg-primary/10 text-primary hover:bg-primary/20 transition-colors text-sm font-medium whitespace-nowrap inline-flex items-center gap-2",children:[a.jsx(B,{className:"w-3 h-3"}),"Marcar como Lida"]}),a.jsx(l.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>S(e.id),className:"p-2 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/20 text-red-600 transition-colors",title:"Deletar",children:a.jsx(H,{className:"w-4 h-4"})})]})]})]})]})})})},e.id)})})]})};export{ce as default};
