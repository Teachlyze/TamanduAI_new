import{r as d,j as t,Q as v,al as G,s as U}from"./main-Bq8SWujy.js";import{g as C,d as T,u as j,s as w,a as R,m as N,c as m,B as k,C as K,T as f,P as $}from"./Box-DOgmli8Q.js";import{T as V,a as _}from"./Tabs-CKgMSKzh.js";import{C as L}from"./Chip-DeUiU0YF.js";import{R as Y,T as J}from"./CategoricalChart-Bk8lXI1V.js";import{L as Q,a as Z}from"./LineChart-Csy3caxV.js";import{C as ee,X as te,Y as ae}from"./CartesianChart-6MqY9mZ1.js";import{L as oe}from"./Legend-5XAyelAB.js";import"./assertThisInitialized-b-KHx1rs.js";import"./extends-CF3RwP-h.js";import"./inheritsLoose-CMRHYPv0.js";import"./index-D_P3mdcN.js";const O=d.createContext();function se(e){return C("MuiTable",e)}T("MuiTable",["root","stickyHeader"]);const re=e=>{const{classes:a,stickyHeader:s}=e;return R({root:["root",s&&"stickyHeader"]},se,a)},ne=w("table",{name:"MuiTable",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:s}=e;return[a.root,s.stickyHeader&&a.stickyHeader]}})(N(({theme:e})=>({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":{...e.typography.body2,padding:e.spacing(2),color:(e.vars||e).palette.text.secondary,textAlign:"left",captionSide:"bottom"},variants:[{props:({ownerState:a})=>a.stickyHeader,style:{borderCollapse:"separate"}}]}))),E="table",le=d.forwardRef(function(a,s){const r=j({props:a,name:"MuiTable"}),{className:c,component:n=E,padding:i="normal",size:l="medium",stickyHeader:u=!1,...x}=r,o={...r,component:n,padding:i,size:l,stickyHeader:u},p=re(o),b=d.useMemo(()=>({padding:i,size:l,stickyHeader:u}),[i,l,u]);return t.jsx(O.Provider,{value:b,children:t.jsx(ne,{as:n,role:n===E?null:"table",ref:s,className:v(p.root,c),ownerState:o,...x})})}),S=d.createContext();function ie(e){return C("MuiTableBody",e)}T("MuiTableBody",["root"]);const ce=e=>{const{classes:a}=e;return R({root:["root"]},ie,a)},de=w("tbody",{name:"MuiTableBody",slot:"Root"})({display:"table-row-group"}),pe={variant:"body"},W="tbody",ue=d.forwardRef(function(a,s){const r=j({props:a,name:"MuiTableBody"}),{className:c,component:n=W,...i}=r,l={...r,component:n},u=ce(l);return t.jsx(S.Provider,{value:pe,children:t.jsx(de,{className:v(u.root,c),as:n,ref:s,role:n===W?null:"rowgroup",ownerState:l,...i})})});function ge(e){return C("MuiTableCell",e)}const xe=T("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),ye=e=>{const{classes:a,variant:s,align:r,padding:c,size:n,stickyHeader:i}=e,l={root:["root",s,i&&"stickyHeader",r!=="inherit"&&`align${m(r)}`,c!=="normal"&&`padding${m(c)}`,`size${m(n)}`]};return R(l,ge,a)},be=w("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:s}=e;return[a.root,a[s.variant],a[`size${m(s.size)}`],s.padding!=="normal"&&a[`padding${m(s.padding)}`],s.align!=="inherit"&&a[`align${m(s.align)}`],s.stickyHeader&&a.stickyHeader]}})(N(({theme:e})=>({...e.typography.body2,display:"table-cell",verticalAlign:"inherit",borderBottom:e.vars?`1px solid ${e.vars.palette.TableCell.border}`:`1px solid
    ${e.palette.mode==="light"?e.lighten(e.alpha(e.palette.divider,1),.88):e.darken(e.alpha(e.palette.divider,1),.68)}`,textAlign:"left",padding:16,variants:[{props:{variant:"head"},style:{color:(e.vars||e).palette.text.primary,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium}},{props:{variant:"body"},style:{color:(e.vars||e).palette.text.primary}},{props:{variant:"footer"},style:{color:(e.vars||e).palette.text.secondary,lineHeight:e.typography.pxToRem(21),fontSize:e.typography.pxToRem(12)}},{props:{size:"small"},style:{padding:"6px 16px",[`&.${xe.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}}},{props:{padding:"checkbox"},style:{width:48,padding:"0 0 0 4px"}},{props:{padding:"none"},style:{padding:0}},{props:{align:"left"},style:{textAlign:"left"}},{props:{align:"center"},style:{textAlign:"center"}},{props:{align:"right"},style:{textAlign:"right",flexDirection:"row-reverse"}},{props:{align:"justify"},style:{textAlign:"justify"}},{props:({ownerState:a})=>a.stickyHeader,style:{position:"sticky",top:0,zIndex:2,backgroundColor:(e.vars||e).palette.background.default}}]}))),g=d.forwardRef(function(a,s){const r=j({props:a,name:"MuiTableCell"}),{align:c="inherit",className:n,component:i,padding:l,scope:u,size:x,sortDirection:o,variant:p,...b}=r,y=d.useContext(O),h=d.useContext(S),D=h&&h.variant==="head";let H;i?H=i:H=D?"th":"td";let M=u;H==="td"?M=void 0:!M&&D&&(M="col");const z=p||h&&h.variant,B={...r,align:c,component:H,padding:l||(y&&y.padding?y.padding:"normal"),size:x||(y&&y.size?y.size:"medium"),sortDirection:o,stickyHeader:z==="head"&&y&&y.stickyHeader,variant:z},X=ye(B);let P=null;return o&&(P=o==="asc"?"ascending":"descending"),t.jsx(be,{as:H,ref:s,className:v(X.root,n),"aria-sort":P,scope:M,ownerState:B,...b})});function he(e){return C("MuiTableContainer",e)}T("MuiTableContainer",["root"]);const fe=e=>{const{classes:a}=e;return R({root:["root"]},he,a)},me=w("div",{name:"MuiTableContainer",slot:"Root"})({width:"100%",overflowX:"auto"}),ve=d.forwardRef(function(a,s){const r=j({props:a,name:"MuiTableContainer"}),{className:c,component:n="div",...i}=r,l={...r,component:n},u=fe(l);return t.jsx(me,{ref:s,as:n,className:v(u.root,c),ownerState:l,...i})});function Ce(e){return C("MuiTableHead",e)}T("MuiTableHead",["root"]);const Te=e=>{const{classes:a}=e;return R({root:["root"]},Ce,a)},je=w("thead",{name:"MuiTableHead",slot:"Root"})({display:"table-header-group"}),we={variant:"head"},q="thead",Re=d.forwardRef(function(a,s){const r=j({props:a,name:"MuiTableHead"}),{className:c,component:n=q,...i}=r,l={...r,component:n},u=Te(l);return t.jsx(S.Provider,{value:we,children:t.jsx(je,{as:n,className:v(u.root,c),ref:s,role:n===q?null:"rowgroup",ownerState:l,...i})})});function He(e){return C("MuiTableRow",e)}const F=T("MuiTableRow",["root","selected","hover","head","footer"]),Me=e=>{const{classes:a,selected:s,hover:r,head:c,footer:n}=e;return R({root:["root",s&&"selected",r&&"hover",c&&"head",n&&"footer"]},He,a)},ke=w("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:s}=e;return[a.root,s.head&&a.head,s.footer&&a.footer]}})(N(({theme:e})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${F.hover}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${F.selected}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`)}}}))),I="tr",A=d.forwardRef(function(a,s){const r=j({props:a,name:"MuiTableRow"}),{className:c,component:n=I,hover:i=!1,selected:l=!1,...u}=r,x=d.useContext(S),o={...r,component:n,hover:i,selected:l,head:x&&x.variant==="head",footer:x&&x.variant==="footer"},p=Me(o);return t.jsx(ke,{as:n,ref:s,className:v(p.root,c),role:n===I?null:"row",ownerState:o,...u})}),We=()=>{const{studentId:e}=G(),[a,s]=d.useState([]),[r,c]=d.useState([]),[n,i]=d.useState(!0),[l,u]=d.useState(0);d.useEffect(()=>{(async()=>{try{i(!0);const{data:p,error:b}=await U.from("academic_history").select(`
            *,
            class:class_id (name, subject),
            activity:activity_id (title, type, max_grade)
          `).eq("student_id",e).order("submitted_at",{ascending:!1});if(b)throw b;const{data:y,error:h}=await U.from("performance_metrics").select("*").eq("student_id",e).order("metric_date",{ascending:!0});if(h)throw h;s(p||[]),c(y||[])}catch(p){console.error("Error fetching data:",p)}finally{i(!1)}})()},[e]);const x=()=>{const o=a.filter(p=>p.status==="graded"&&p.grade!==null);return o.length===0?0:(o.reduce((p,b)=>p+b.grade,0)/o.length).toFixed(2)};return n?t.jsx(k,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"300px",children:t.jsx(K,{})}):t.jsxs(k,{sx:{p:3},children:[t.jsx(f,{variant:"h4",gutterBottom:!0,children:"Histórico Acadêmico"}),t.jsxs(k,{sx:{display:"flex",gap:2,mb:3,flexWrap:"wrap"},children:[t.jsxs($,{sx:{p:2,flex:1,minWidth:"200px"},children:[t.jsx(f,{color:"textSecondary",children:"Média Geral"}),t.jsxs(f,{variant:"h3",children:[x(),"%"]})]}),t.jsxs($,{sx:{p:2,flex:1,minWidth:"200px"},children:[t.jsx(f,{color:"textSecondary",children:"Atividades Concluídas"}),t.jsx(f,{variant:"h3",children:a.filter(o=>o.status==="graded").length})]})]}),t.jsxs(V,{value:l,onChange:(o,p)=>u(p),sx:{mb:3},children:[t.jsx(_,{label:"Atividades"}),t.jsx(_,{label:"Desempenho"})]}),l===0&&t.jsx(ve,{component:$,sx:{mt:2},children:t.jsxs(le,{children:[t.jsx(Re,{children:t.jsxs(A,{children:[t.jsx(g,{children:"Atividade"}),t.jsx(g,{children:"Disciplina"}),t.jsx(g,{children:"Tipo"}),t.jsx(g,{children:"Status"}),t.jsx(g,{children:"Nota"}),t.jsx(g,{children:"Data de Entrega"})]})}),t.jsx(ue,{children:a.length>0?a.map(o=>t.jsxs(A,{children:[t.jsx(g,{children:o.activity?.title||"N/A"}),t.jsx(g,{children:o.class?.name||"N/A"}),t.jsx(g,{children:t.jsx(L,{label:o.activity?.type||"N/A",size:"small",color:o.activity?.type==="quiz"?"primary":"default"})}),t.jsx(g,{children:t.jsx(L,{label:o.status==="graded"?"Avaliado":o.status==="submitted"?"Enviado":o.status==="late"?"Atrasado":"Pendente",color:o.status==="graded"?"success":o.status==="late"?"warning":"default",size:"small"})}),t.jsx(g,{children:o.status==="graded"?t.jsxs(f,{color:o.grade>=70?"success.main":"error.main",fontWeight:"bold",children:[o.grade," / ",o.max_grade||100]}):"N/A"}),t.jsx(g,{children:new Date(o.submitted_at).toLocaleDateString("pt-BR")})]},o.id)):t.jsx(A,{children:t.jsx(g,{colSpan:6,align:"center",children:"Nenhum registro encontrado"})})})]})}),l===1&&r.length>0&&t.jsxs(k,{sx:{mt:4,height:400},children:[t.jsx(f,{variant:"h6",gutterBottom:!0,children:"Desempenho ao Longo do Tempo"}),t.jsx(Y,{width:"100%",height:"100%",children:t.jsxs(Q,{data:r.filter(o=>o.metric_type==="grade"),margin:{top:5,right:30,left:20,bottom:5},children:[t.jsx(ee,{strokeDasharray:"3 3"}),t.jsx(te,{dataKey:"metric_date",tickFormatter:o=>new Date(o).toLocaleDateString("pt-BR")}),t.jsx(ae,{domain:[0,100]}),t.jsx(J,{labelFormatter:o=>`Data: ${new Date(o).toLocaleDateString("pt-BR")}`,formatter:o=>[`${o}%`,"Nota"]}),t.jsx(oe,{}),t.jsx(Z,{type:"monotone",dataKey:"value",name:"Nota",stroke:"#8884d8",activeDot:{r:8}})]})})]})]})};export{We as default};
