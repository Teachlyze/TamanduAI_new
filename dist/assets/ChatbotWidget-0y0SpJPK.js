import{f as v,u as k,r as o,j as e,Y as I}from"./main-Bujpyeg-.js";import{B as j}from"./bot-W1aPrpb0.js";import{S as C}from"./send-D6bioMOQ.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],M=v("maximize-2",z);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],S=v("minimize-2",O),A=({context:r={}})=>{const{user:y}=k(),[u,f]=o.useState(!1),[d,w]=o.useState(!1),[m,i]=o.useState([]),[l,h]=o.useState(""),[c,x]=o.useState(!1),p=o.useRef(null);o.useEffect(()=>{p.current&&p.current.scrollIntoView({behavior:"smooth"})},[m]),o.useEffect(()=>{if(u&&m.length===0){const s=r.classId?"Olá! Estou aqui para ajudar com suas dúvidas sobre esta turma. Como posso ajudar?":r.activityId?"Olá! Estou aqui para ajudar com esta atividade. Qual sua dúvida?":"Olá! Como posso ajudar você hoje?";i([{role:"assistant",content:s,timestamp:new Date}])}},[u,r]);const g=async()=>{if(!l.trim()||c)return;const s=l.trim();h(""),i(t=>[...t,{role:"user",content:s,timestamp:new Date}]),x(!0);try{const t=await fetch("https://wapbwaimkurbuihatmix.supabase.co/functions/v1/chat",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndhcGJ3YWlta3VyYnVpaGF0bWl4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkyODY3MjksImV4cCI6MjA3NDg2MjcyOX0.x-NQQ2TtRgaUjjBZCf6j49eWOW4XSqjTFKC_KB1L56A"},body:JSON.stringify({message:s,context:{userId:y?.id,classId:r.classId,activityId:r.activityId}}),signal:AbortSignal.timeout(1e4)});if(!t.ok){console.warn("Edge function falhou, usando fallback");const n=b(s,r);i(N=>[...N,{role:"assistant",content:n,timestamp:new Date}]);return}const a=await t.json();i(n=>[...n,{role:"assistant",content:a.reply||"Desculpe, não consegui processar sua mensagem.",timestamp:new Date}])}catch(t){console.error("Erro ao enviar mensagem:",t);const a=b(s);i(n=>[...n,{role:"assistant",content:a,timestamp:new Date}])}finally{x(!1)}},b=(s,t)=>{const a=s.toLowerCase();return a.includes("prazo")||a.includes("entrega")||a.includes("quando")?"Para informações sobre prazos, verifique os detalhes da atividade. Se tiver dúvidas específicas, consulte seu professor.":a.includes("nota")||a.includes("pontuação")||a.includes("avaliaç")?"As notas são atualizadas pelo professor após a correção. Você pode acompanhar seu progresso no painel de desempenho.":a.includes("como")||a.includes("ajuda")||a.includes("dúvida")?"Estou aqui para ajudar! Você pode me perguntar sobre prazos, formato de entrega, ou tirar dúvidas gerais. Para questões específicas do conteúdo, recomendo consultar o material da aula ou seu professor.":a.includes("material")||a.includes("arquivo")||a.includes("documento")?"Os materiais da aula estão disponíveis na página da turma. Verifique a seção de materiais para acessar os arquivos enviados pelo professor.":"Olá! Sou o assistente da TamanduAI. Posso ajudar com informações gerais sobre a plataforma, prazos e entregas. Para dúvidas específicas do conteúdo, recomendo entrar em contato com seu professor. Como posso ajudar?"};return u?e.jsxs("div",{className:`fixed bottom-6 right-6 bg-background border border-border rounded-2xl shadow-2xl z-50 flex flex-col transition-all ${d?"w-80 h-16":"w-96 h-[32rem]"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"Assistente IA"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>w(!d),className:"hover:bg-white/20 p-1 rounded transition-colors",children:d?e.jsx(M,{className:"w-4 h-4"}):e.jsx(S,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>f(!1),className:"hover:bg-white/20 p-1 rounded transition-colors",children:e.jsx(I,{className:"w-4 h-4"})})]})]}),!d&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[m.map((s,t)=>e.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] px-4 py-2 rounded-2xl ${s.role==="user"?"bg-gradient-to-r from-purple-600 to-pink-600 text-white":"bg-muted text-foreground"}`,children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.content})})},t)),c&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-muted px-4 py-2 rounded-2xl",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-foreground/50 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-foreground/50 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-foreground/50 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})}),e.jsx("div",{ref:p})]}),e.jsx("div",{className:"p-4 border-t border-border",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:s=>h(s.target.value),onKeyPress:s=>s.key==="Enter"&&g(),placeholder:"Digite sua mensagem...",className:"flex-1 px-4 py-2 rounded-lg border border-border bg-background text-sm",disabled:c}),e.jsx("button",{onClick:g,disabled:c||!l.trim(),className:"p-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",children:e.jsx(C,{className:"w-4 h-4"})})]})})]})]}):e.jsx("button",{onClick:()=>f(!0),className:"fixed bottom-6 right-6 w-14 h-14 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all flex items-center justify-center z-50","aria-label":"Abrir chatbot",children:e.jsx(j,{className:"w-6 h-6"})})};export{A as C};
