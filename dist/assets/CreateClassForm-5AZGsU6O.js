import{s as d,b6 as H,g as oe,u as le,r as S,bb as te,ab as ce,j as e,m as k,i as F,bv as de,x as q,F as L,H as V,B as me,I as P,y as M,bw as h,bx as x,by as p,bz as g,K as C,bA as f,bB as $,aM as ue,d as he,aO as U,aP as K,aQ as Q,aR as X,aS as u,D as W,U as xe,J as Z,a2 as pe,au as T}from"./main-BBAlbGLj.js";import{a as ge,S as je,o as fe,b as ee,s as b,n as be}from"./separator-oqskyih2.js";import{t as ae}from"./teacherSubscriptionService-ebegB__F.js";import{t as J}from"./use-toast-Ci9GuxPV.js";import{B as ve}from"./badge-Dxkfeepr.js";import{A as we,a as ye}from"./alert-CB1jxfn1.js";import{A as Ne}from"./arrow-left-D8R0xudv.js";import{T as se}from"./triangle-alert-BOfKVf7j.js";import{S as _e}from"./school-B6iEPBKG.js";import{C as Ce}from"./circle-check-big-9PMWtYp0.js";import{P as Se}from"./plus-CFMNmEOP.js";import{G as ke}from"./graduation-cap-C5vg-5On.js";const Ee={async getClasses({teacherId:i,studentId:r,activeOnly:s=!0}={}){let t=d.from("classes").select(`
        *,
        members:class_members(*, user:profiles(*)),
        meetings:meetings(*)
      `).order("name",{ascending:!0});i&&(t=t.eq("created_by",i)),s&&(t=t.eq("is_active",!0));const{data:n,error:m}=await t;if(m)throw console.error("Error fetching classes:",m),m;return r?n.filter(j=>j.members?.some(w=>w.user_id===r&&w.role==="student")):n},async getClassById(i){const{data:r,error:s}=await d.from("classes").select(`
        *,
        members:class_members(*, user:profiles(*)),
        meetings:meetings(*, 
          participants:meeting_participants(*, user:profiles(*))
        )
      `).eq("id",i).single();if(s)throw console.error(`Error fetching class ${i}:`,s),s;return r},async createClass(i,r=[]){const{name:s,description:t,teacher_id:n,subject:m,course:j,period:w,grade_level:D,academic_year:v,color:y,student_capacity:B,school_id:_,is_school_managed:G}=i,{data:Y,error:I}=await d.from("profiles").select("id").eq("id",n).maybeSingle();if(!Y&&!I){console.log("Profile not found for teacher, creating one...");const{error:c}=await d.from("profiles").insert([{id:n,role:"teacher",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]);if(c&&(console.error("Error creating teacher profile:",c),c.code!=="23505"))throw new Error(`Erro ao criar perfil do professor: ${c.message}`)}const z={name:s,description:t||null,created_by:n,subject:m||null,course:j||null,period:w||null,grade_level:D||null,academic_year:(()=>{const c=parseInt(v,10);return Number.isFinite(c)?c:new Date().getFullYear()})(),color:y||"#6366f1",student_capacity:typeof B=="number"?B:30,school_id:_||null,is_school_managed:!!G,is_active:!0};console.log("Creating class with data:",z);const{data:N,error:o}=await d.from("classes").insert([z]).select().single();if(o)throw console.error("Error creating class:",o),console.error("Error details:",{code:o.code,message:o.message,details:o.details,hint:o.hint}),new Error(`Erro ao criar turma: ${o.message}. Detalhes: ${o.hint||o.details||"Nenhum detalhe adicional"}`);console.log("Class created successfully:",N);try{await H.send("classCreated",{userId:n,variables:{className:s},channelOverride:"push",metadata:{classId:N.id}})}catch(c){console.warn("Falha ao notificar criação de turma:",c)}try{const{error:c}=await d.from("class_members").insert([{class_id:N.id,user_id:n,role:"teacher",joined_at:new Date().toISOString()}]);c&&c.code!=="23505"&&console.warn("Erro ao adicionar professor como membro:",c)}catch(c){console.warn("Falha ao adicionar professor como membro da turma:",c)}if(r&&r.length>0)try{await this.addStudentsToClass(N.id,r)}catch(c){console.warn("Falha ao adicionar alunos:",c)}try{const{error:c}=await d.from("chatbot_configurations").upsert({class_id:N.id,enabled:!0,keywords:[],themes:[],scope_restrictions:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{onConflict:"class_id"});c?console.warn("Erro ao garantir configuração do chatbot:",c):console.log("Chatbot configuration ensured for class:",N.id)}catch(c){console.warn("Falha ao garantir chatbot para a turma:",c)}return this.getClassById(N.id)},async updateClass(i,r,s){const t={...r||{}};if(Object.prototype.hasOwnProperty.call(t,"academic_year")){const m=parseInt(t.academic_year,10);t.academic_year=Number.isFinite(m)?m:new Date().getFullYear()}const{error:n}=await d.from("classes").update({...t,updated_at:new Date().toISOString()}).eq("id",i);if(n)throw console.error(`Error updating class ${i}:`,n),n;if(Array.isArray(s)){const{data:m}=await d.from("class_members").select("user_id").eq("class_id",i).eq("role","student"),j=(m||[]).map(v=>v.user_id),w=s.filter(v=>!j.includes(v)),D=j.filter(v=>!s.includes(v));await Promise.all([this.addStudentsToClass(i,w),this.removeStudentsFromClass(i,D)])}return this.getClassById(i)},async deleteClass(i){const{error:r}=await d.from("classes").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",i);if(r)throw console.error(`Error deleting class ${i}:`,r),r;return!0},async addStudentsToClass(i,r){if(!r||r.length===0)return[];const{data:s,error:t}=await d.from("class_members").insert(r.map(n=>({class_id:i,user_id:n,role:"student",joined_at:new Date().toISOString()}))).select();if(t)throw console.error(`Error adding students to class ${i}:`,t),t;try{const[{data:n},{data:m}]=await Promise.all([d.from("classes").select("id, name, created_by").eq("id",i).single(),d.from("profiles").select("id, full_name").in("id",r)]);if(n?.created_by&&m?.length)for(const j of m)await H.send("studentAddedToClass",{userId:n.created_by,variables:{studentName:j.full_name||"Aluno",className:n.name||"Turma"},channelOverride:"push",metadata:{classId:i,studentId:j.id}})}catch(n){console.warn("Falha ao notificar alunos adicionados:",n)}return s},async removeStudentsFromClass(i,r){if(!r||r.length===0)return!0;const{error:s}=await d.from("class_members").delete().eq("class_id",i).in("user_id",r).eq("role","student");if(s)throw console.error(`Error removing students from class ${i}:`,s),s;try{const[{data:t},{data:n}]=await Promise.all([d.from("classes").select("id, name").eq("id",i).single(),d.from("profiles").select("id, full_name").in("id",r)]);for(const m of n||[])await H.send("studentRemovedFromClass",{userId:m.id,email:void 0,variables:{className:t?.name||"Turma"},metadata:{classId:i}})}catch(t){console.warn("Falha ao notificar alunos removidos:",t)}return!0},async searchClasses(i,{onlyActive:r=!0}={}){let s=d.from("classes").select("*").or(`name.ilike.%${i}%,description.ilike.%${i}%`);r&&(s=s.eq("is_active",!0));const{data:t,error:n}=await s;if(n)throw console.error("Error searching classes:",n),n;return t},subscribeToClasses(i){const r=d.channel("classes_changes").on("postgres_changes",{event:"*",schema:"public",table:"classes"},s=>{i(s)}).subscribe();return()=>{d.removeChannel(r)}}},Ae=fe({name:b().min(3,"Nome da turma deve ter pelo menos 3 caracteres"),subject:b().min(2,"Matéria é obrigatória"),description:b().optional(),course:b().optional(),period:b().optional(),academic_year:b().min(1,"Ano letivo é obrigatório"),grade_level:b().min(1,"Nível é obrigatório"),student_capacity:be().min(1,"Capacidade deve ser pelo menos 1").max(100,"Capacidade máxima é 100"),color:b().min(1,"Selecione uma cor"),room_number:b().optional(),is_online:ee().default(!1),meeting_link:b().optional(),school_id:b().optional(),is_school_managed:ee().default(!1)}),ze=()=>{const i=oe(),{user:r}=le(),[s,t]=S.useState(!1),[n,m]=S.useState([]),[j,w]=S.useState(null),[D,v]=S.useState(!1),[y,B]=S.useState(null),[_,G]=S.useState([]),[Y,I]=S.useState(!0),z=[{name:"Azul",value:"blue",class:"bg-blue-500"},{name:"Verde",value:"green",class:"bg-green-500"},{name:"Roxo",value:"purple",class:"bg-purple-500"},{name:"Rosa",value:"pink",class:"bg-pink-500"},{name:"Laranja",value:"orange",class:"bg-orange-500"},{name:"Vermelho",value:"red",class:"bg-red-500"},{name:"Amarelo",value:"yellow",class:"bg-yellow-500"},{name:"Índigo",value:"indigo",class:"bg-indigo-500"}],N=[{id:1,name:"Ana Silva",email:"ana@email.com"},{id:2,name:"João Santos",email:"joao@email.com"},{id:3,name:"Maria Oliveira",email:"maria@email.com"},{id:4,name:"Pedro Costa",email:"pedro@email.com"},{id:5,name:"Carla Souza",email:"carla@email.com"}],o=te({resolver:ge(Ae),defaultValues:{name:"",subject:"",description:"",course:"",period:"",academic_year:new Date().getFullYear().toString(),grade_level:"",student_capacity:30,room_number:"",is_online:!1,meeting_link:"",color:"blue",school_id:"",is_school_managed:!1}});ce.useEffect(()=>{(async()=>{if(r)try{I(!0);const{data:l,error:O}=await d.from("school_teachers").select("school_id, schools(id, name)").eq("user_id",r.id).eq("status","active");if(O)throw O;const E=(l||[]).map(R=>R.schools).filter(Boolean);G(E),E.length===1&&(o.setValue("school_id",E[0].id),o.setValue("is_school_managed",!0))}catch(l){console.error("Erro ao carregar escolas:",l)}finally{I(!1)}})()},[r]);const c=async a=>{if(!r){J({variant:"destructive",title:"Erro de autenticação",description:"Você precisa estar logado para criar uma turma."});return}t(!0),w(null);try{if(!await ae.checkCanCreateClass(r.id)){const A=await ae.getUsageStats(r.id);B(A),v(!0),t(!1);return}T.info("Iniciando criação de turma",{teacherId:r.id,className:a.name,subject:a.subject});const O={name:a.name,description:a.description||"",created_by:r.id,subject:a.subject,course:a.course||"",period:a.period||"",grade_level:a.grade_level,academic_year:a.academic_year,color:a.color,student_capacity:a.student_capacity,room_number:a.room_number||"",is_online:a.is_online||!1,meeting_link:a.meeting_link||"",chatbot_enabled:!1,school_id:a.school_id||null,is_school_managed:!!a.is_school_managed,is_active:!0};T.info("Dados da turma para criação:",O);const E=await Ee.createClass(O);T.info("Turma criada com sucesso",{classId:E.id,className:E.name});let R=null;try{}catch(A){T.warn("Falha ao gerar convite padrão da turma",{error:A.message})}if(n&&n.length>0){for(const A of n)if(A.email)try{}catch(ne){T.warn("Falha ao gerar convite para aluno",{email:A.email,error:ne.message})}}J({title:"✅ Turma criada com sucesso!",description:R?`Convite gerado. Copie o link para compartilhar: ${R}`:`A turma "${a.name}" foi criada e está pronta para receber alunos.`}),setTimeout(()=>i("/dashboard/classes"),1200)}catch(l){T.error("Erro ao criar turma",{error:l.message,teacherId:r.id}),w(l.message),J({variant:"destructive",title:"❌ Erro ao criar turma",description:l.message||"Não foi possível criar a turma. Verifique sua conexão e tente novamente."})}finally{t(!1)}},re=a=>{n.find(l=>l.id===a.id)||m([...n,a])},ie=a=>{m(n.filter(l=>l.id!==a))};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:e.jsxs("div",{className:"w-full space-y-8 p-6",children:[e.jsxs(k.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative overflow-hidden bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 rounded-3xl p-8 text-white",children:[e.jsx("div",{className:"absolute inset-0 bg-black/10"}),e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>i("/dashboard/classes"),className:"text-white hover:bg-white/20 h-10 w-10",disabled:s,children:e.jsx(Ne,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Nova Turma"}),e.jsx("p",{className:"text-purple-100 text-lg",children:"Crie uma nova turma e comece a ensinar"})]})]})}),e.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/10 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-8 -left-8 w-32 h-32 bg-white/5 rounded-full blur-2xl"})]}),j&&e.jsx(k.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:e.jsxs(we,{variant:"destructive",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx(ye,{children:j})]})}),e.jsx(de,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(c),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(k.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:e.jsxs(q,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(L,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(me,{className:"w-4 h-4 text-white"})}),"Informações Básicas"]}),e.jsx(P,{children:"Defina as informações principais da turma"})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsx(h,{control:o.control,name:"name",render:({field:a})=>e.jsxs(x,{children:[e.jsx(p,{children:"Nome da Turma"}),e.jsx(g,{children:e.jsx(C,{placeholder:"Ex: Matemática 9A",...a,disabled:s})}),e.jsx(f,{})]})}),e.jsx(h,{control:o.control,name:"subject",render:({field:a})=>e.jsxs(x,{children:[e.jsx(p,{children:"Matéria"}),e.jsx(g,{children:e.jsx(C,{placeholder:"Ex: Matemática, Educação Física, Yoga...",...a,disabled:s})}),e.jsx($,{className:"text-xs",children:"Digite o nome da matéria ou atividade que você ensina"}),e.jsx(f,{})]})}),e.jsx(h,{control:o.control,name:"description",render:({field:a})=>e.jsxs(x,{children:[e.jsx(p,{children:"Descrição (Opcional)"}),e.jsx(g,{children:e.jsx(ue,{placeholder:"Descreva os objetivos e conteúdo da turma...",className:"min-h-[100px]",...a,disabled:s})}),e.jsx(f,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(h,{control:o.control,name:"course",render:({field:a})=>e.jsxs(x,{children:[e.jsx(p,{children:"Course (Opcional)"}),e.jsx(g,{children:e.jsx(C,{placeholder:"Ex: STEM, Linguagens",...a,disabled:s})}),e.jsx(f,{})]})}),e.jsx(h,{control:o.control,name:"period",render:({field:a})=>e.jsxs(x,{children:[e.jsx(p,{children:"Period (Opcional)"}),e.jsx(g,{children:e.jsx(C,{placeholder:"Ex: morning, afternoon, night",...a,disabled:s})}),e.jsx(f,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(h,{control:o.control,name:"room_number",render:({field:a})=>e.jsxs(x,{children:[e.jsx(p,{children:"Número da Sala (Opcional)"}),e.jsx(g,{children:e.jsx(C,{placeholder:"Ex: Sala 12, Lab A",...a,disabled:s})}),e.jsx(f,{})]})}),e.jsx(h,{control:o.control,name:"is_online",render:({field:a})=>e.jsxs(x,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(p,{children:"Aula Online"}),e.jsx($,{className:"text-xs",children:"Marque se a turma é online"})]}),e.jsx(g,{children:e.jsx("input",{type:"checkbox",checked:a.value,onChange:a.onChange,disabled:s,className:"w-4 h-4"})})]})})]}),o.watch("is_online")&&e.jsx(h,{control:o.control,name:"meeting_link",render:({field:a})=>e.jsxs(x,{children:[e.jsx(p,{children:"Link da Reunião"}),e.jsx(g,{children:e.jsx(C,{placeholder:"Ex: https://meet.google.com/...",...a,disabled:s})}),e.jsx(f,{})]})})]})]})}),e.jsx(k.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:e.jsxs(q,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(L,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-green-600 rounded-lg flex items-center justify-center",children:e.jsx(he,{className:"w-4 h-4 text-white"})}),"Ano letivo e nível"]}),e.jsx(P,{children:"Configure o ano letivo e o nível/série"})]}),e.jsx(M,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(h,{control:o.control,name:"academic_year",render:({field:a})=>e.jsxs(x,{children:[e.jsx(p,{children:"Ano letivo"}),e.jsx(g,{children:e.jsx(C,{placeholder:"Ex: 2025",...a,disabled:s})}),e.jsx(f,{})]})}),e.jsx(h,{control:o.control,name:"grade_level",render:({field:a})=>e.jsxs(x,{children:[e.jsx(p,{children:"Nível/Série"}),e.jsxs(U,{onValueChange:a.onChange,defaultValue:a.value,disabled:s,children:[e.jsx(g,{children:e.jsx(K,{children:e.jsx(Q,{placeholder:"Selecione o nível"})})}),e.jsxs(X,{children:[e.jsx(u,{value:"infantil",children:"Educação Infantil"}),e.jsx(u,{value:"1ano",children:"1º Ano - Fundamental"}),e.jsx(u,{value:"2ano",children:"2º Ano - Fundamental"}),e.jsx(u,{value:"3ano",children:"3º Ano - Fundamental"}),e.jsx(u,{value:"4ano",children:"4º Ano - Fundamental"}),e.jsx(u,{value:"5ano",children:"5º Ano - Fundamental"}),e.jsx(u,{value:"6ano",children:"6º Ano - Fundamental"}),e.jsx(u,{value:"7ano",children:"7º Ano - Fundamental"}),e.jsx(u,{value:"8ano",children:"8º Ano - Fundamental"}),e.jsx(u,{value:"9ano",children:"9º Ano - Fundamental"}),e.jsx(u,{value:"1medio",children:"1º Ano - Ensino Médio"}),e.jsx(u,{value:"2medio",children:"2º Ano - Ensino Médio"}),e.jsx(u,{value:"3medio",children:"3º Ano - Ensino Médio"}),e.jsx(u,{value:"tecnico",children:"Técnico/Profissionalizante"}),e.jsx(u,{value:"superior",children:"Ensino Superior"}),e.jsx(u,{value:"pos",children:"Pós-Graduação"}),e.jsx(u,{value:"livre",children:"Curso Livre"})]})]}),e.jsx(f,{})]})})]})})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(k.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.1},children:e.jsxs(q,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(L,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx(_e,{className:"w-4 h-4 text-white"})}),"Configurações da Turma"]}),e.jsx(P,{children:"Defina série, capacidade e outras configurações"})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(h,{control:o.control,name:"student_capacity",render:({field:a})=>e.jsxs(x,{children:[e.jsx(p,{children:"Capacidade"}),e.jsx(g,{children:e.jsx(C,{type:"number",min:"1",max:"100",...a,onChange:l=>a.onChange(parseInt(l.target.value)||1),disabled:s})}),e.jsx($,{children:"Número máximo de alunos"}),e.jsx(f,{})]})}),e.jsx(h,{control:o.control,name:"school_id",render:({field:a})=>e.jsxs(x,{children:[e.jsx(p,{children:"Escola Vinculada"}),Y?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(W,{className:"w-4 h-4 animate-spin"}),"Carregando escolas..."]}):_.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Nenhuma escola vinculada"}):_.length===1?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsx(Ce,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-900 dark:text-green-100",children:_[0].name})]}):e.jsxs(U,{onValueChange:a.onChange,defaultValue:a.value,disabled:s,children:[e.jsx(g,{children:e.jsx(K,{children:e.jsx(Q,{placeholder:"Selecione a escola"})})}),e.jsx(X,{children:_.map(l=>e.jsx(u,{value:l.id,children:l.name},l.id))})]}),e.jsx($,{className:"text-xs",children:_.length===0?"Você pode criar turmas independentes ou aguardar convite de uma escola":"Turma será vinculada automaticamente a esta escola"}),e.jsx(f,{})]})})]}),_.length>0&&e.jsx(h,{control:o.control,name:"is_school_managed",render:({field:a})=>e.jsxs(x,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(p,{children:"Turma Gerenciada pela Escola"}),e.jsx($,{className:"text-xs",children:"A escola terá acesso total aos dados e relatórios desta turma"})]}),e.jsx(g,{children:e.jsx("input",{type:"checkbox",checked:a.value,onChange:a.onChange,disabled:s,className:"w-4 h-4"})})]})}),e.jsx(h,{control:o.control,name:"color",render:({field:a})=>e.jsxs(x,{children:[e.jsx(p,{children:"Cor da Turma"}),e.jsx(g,{children:e.jsx("div",{className:"grid grid-cols-4 gap-2",children:z.map(l=>e.jsx("button",{type:"button",onClick:()=>a.onChange(l.value),disabled:s,className:`
                                      relative h-12 rounded-lg border-2 transition-all duration-200
                                      ${l.class}
                                      ${a.value===l.value?"border-white shadow-lg scale-105":"border-transparent hover:scale-105"}
                                      ${s?"opacity-50 cursor-not-allowed":""}
                                    `,title:l.name,children:a.value===l.value&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-4 h-4 bg-white rounded-full"})})},l.value))})}),e.jsx(f,{})]})})]})]})}),e.jsx(k.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},children:e.jsxs(q,{className:"bg-white/80 backdrop-blur-sm border-white/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(L,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg flex items-center justify-center",children:e.jsx(xe,{className:"w-4 h-4 text-white"})}),"Alunos (Opcional)"]}),e.jsx(P,{children:"Adicione alunos à turma agora ou faça isso depois"})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Z,{children:["Alunos Selecionados (",n.length,")"]}),n.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(a=>e.jsxs(ve,{variant:"secondary",className:"flex items-center gap-1",children:[a.name,e.jsx("button",{type:"button",onClick:()=>ie(a.id),disabled:s,className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5 disabled:opacity-50",children:e.jsx(pe,{className:"w-3 h-3"})})]},a.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum aluno selecionado"})]}),e.jsx(je,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{children:"Alunos Disponíveis"}),e.jsx("div",{className:"max-h-40 overflow-y-auto space-y-2",children:N.filter(a=>!n.find(l=>l.id===a.id)).map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:a.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.email})]}),e.jsxs(F,{type:"button",size:"sm",variant:"outline",onClick:()=>re(a),disabled:s,className:"whitespace-nowrap inline-flex items-center gap-2",children:[e.jsx(Se,{className:"w-3 h-3"}),e.jsx("span",{children:"Adicionar"})]})]},a.id))})]})]})]})})]})]}),e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"flex justify-end gap-4 pt-6 bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-white/50 shadow-lg",children:[e.jsx(F,{type:"button",variant:"outline",onClick:()=>i("/dashboard/classes"),disabled:s,className:"whitespace-nowrap inline-flex items-center gap-2 bg-white/70 backdrop-blur-sm hover:bg-white/80",children:e.jsx("span",{children:"Cancelar"})}),e.jsx(F,{type:"submit",disabled:s,className:"whitespace-nowrap inline-flex items-center gap-2 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white min-w-[140px] shadow-lg hover:shadow-xl transition-all duration-300",children:s?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Criando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"h-4 w-4"}),e.jsx("span",{children:"Criar Turma"})]})})]})]})}),D&&y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(q,{className:"w-full max-w-md",children:[e.jsxs(L,{children:[e.jsxs(V,{className:"flex items-center gap-2 text-orange-600",children:[e.jsx(se,{className:"h-5 w-5"}),"Limite de Turmas Atingido"]}),e.jsx(P,{children:"Você atingiu o limite do seu plano atual"})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsxs("p",{className:"font-semibold text-gray-900 mb-2",children:["Plano Atual: ",e.jsx("span",{className:"text-orange-600 uppercase",children:y.plan})]}),e.jsxs("p",{className:"text-gray-700",children:["Turmas criadas: ",e.jsxs("span",{className:"font-bold",children:[y.currentClasses,"/",y.maxClasses]})]}),y.linkedSchools>0&&e.jsxs("p",{className:"text-gray-600 text-sm mt-2",children:["💼 Você está vinculado a ",y.linkedSchools," escola(s)"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Para criar mais turmas, você pode:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-700",children:[e.jsx("li",{children:"Remover uma turma antiga"}),e.jsx("li",{children:"Fazer upgrade para um plano superior"}),y.linkedSchools===0&&e.jsx("li",{children:"Vincular-se a uma escola (turmas ilimitadas)"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(F,{variant:"outline",className:"flex-1 whitespace-nowrap inline-flex items-center justify-center gap-2",onClick:()=>v(!1),children:e.jsx("span",{children:"Voltar"})}),e.jsx(F,{className:"flex-1 whitespace-nowrap inline-flex items-center justify-center gap-2 bg-gradient-to-r from-indigo-600 to-purple-600",onClick:()=>i("/settings/subscription"),children:e.jsx("span",{children:"Ver Planos"})})]})]})]})})]})})};export{ze as default};
