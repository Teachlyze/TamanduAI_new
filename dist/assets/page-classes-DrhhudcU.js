import{r as h,j as e,R as rs}from"./react-vendor-C2HUFn5N.js";import{s as We,l as _e}from"./lazy-CreateActivityPage.jsx-DYBofU2F.js";import{c as Be,S as ds,B as Ge,T as cs,F as xs}from"./antd-vendor-K_53YjeB.js";import{b as we,L as us,u as qe}from"./vendor-react-router-B4Bn0PSh.js";import{P as Re}from"./page-EmailConfirmationPage.jsx-BIOACglB.js";import{c as ms}from"./page-ActivitiesListPage.jsx-Cv5lq7oV.js";import{u as Le,B as a,a as j,s as K,t as I,v as B,G as c,c as pe,w as k,x as Fe,y as hs,F as js,M as Ce,z as T,T as t,J as ps,K as U,V as gs,D as P,O as bs,k as Ve,l as O,Q as xe,R as He,U as Ne,W as fs,X as vs,Y as ve,Z as oe,_ as ys,b as ns,$ as Ae,L as de,a0 as le,a1 as ze,i as H,E as ue,a2 as De,a3 as Cs,a4 as ee,d as ne,a5 as Se,a6 as is,a7 as ae,a8 as ke,a9 as Ss,aa as Qe,ab as Te,f as ce,ac as ks,ad as Pe,ae as ye,af as Oe,S as Me,h as Ke,N as Ts,ag as ws,g as $e,ah as Is,P as ie,ai as Ye,e as As,aj as zs,ak as Ds,al as Ps,am as Ms,an as $s,ao as Es,ap as Ws,aq as Bs,ar as Ze,as as Ue,at as Xe,au as Os}from"./mui-vendor-B2ef-T1O.js";import{v as Je,o as N,w as _s,c as M,x as qs,p as Q,y as es,z as se}from"./utils-vendor-DsQmHAQY.js";const Rs=async o=>{try{const{data:l,error:A}=await We.from("plagiarism_checks_v2").select("*").eq("activity_id",o).order("created_at",{ascending:!1});if(!A)return l||[];const{data:d,error:$}=await We.from("plagiarism_checks").select("*").eq("activity_id",o).order("created_at",{ascending:!1});if($)throw $;return d||[]}catch(l){throw console.error("Error getting plagiarism checks for activity:",l),l}},{Title:Ls}=cs;function Vs(o){const l=o>50?"gravissimo":o>35?"grave":o>20?"medio":"none",A=l==="gravissimo"?"red":l==="grave"?"orange":l==="medio"?"gold":"default",d=l==="gravissimo"?`Gravíssimo ${o}%`:l==="grave"?`Grave ${o}%`:l==="medio"?`Médio ${o}%`:"OK";return e.jsx(Be,{color:A,children:d})}function Gs(){const{classId:o,activityId:l}=we(),[A,d]=h.useState(!0),[$,X]=h.useState([]),[G,F]=h.useState({});h.useEffect(()=>{(async()=>{try{d(!0);const{data:f,error:S}=await We.from("submissions").select("id, user_id, status, submitted_at, users:profiles(id, full_name)").eq("activity_id",l).order("submitted_at",{ascending:!1});if(S)throw S;X(f||[]);const _=await Rs(l),b={};(_||[]).forEach(R=>{const z=R.submission_id,L=b[z],q=new Date(R.created_at||R.updated_at||0).getTime(),v=L?new Date(L.created_at||L.updated_at||0).getTime():-1;(!L||q>v)&&(b[z]=R)}),F(b)}finally{d(!1)}})()},[l]);const Y=h.useMemo(()=>[{title:"Aluno",dataIndex:["users","full_name"],key:"student",render:(C,f)=>C||f.user_id},{title:"Status",dataIndex:"status",key:"status",render:C=>e.jsx(Be,{color:C==="submitted"?"blue":"default",children:C})},{title:"Enviado em",dataIndex:"submitted_at",key:"submitted_at",render:C=>C?new Date(C).toLocaleString("pt-BR"):"—"},{title:"Plágio",key:"plagiarism",render:(C,f)=>{const S=G[f.id];if(!S)return e.jsx(Be,{children:"—"});const _=typeof S.plag_percent=="number"?S.plag_percent:Math.round((S.similarity_score||0)*100);return Vs(_)}},{title:"Ações",key:"actions",render:(C,f)=>e.jsxs(ds,{children:[e.jsx(Ge,{size:"small",type:"link",children:"Corrigir"}),e.jsx(Ge,{size:"small",children:"Detalhes"})]})}],[G]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Ls,{level:3,style:{margin:0},children:"Entregas da Atividade"}),e.jsx(us,{to:`/dashboard/classes/${o}/activities/${l}`,children:"Voltar"})]}),e.jsx(xs,{loading:A,columns:Y,dataSource:($||[]).map(C=>({key:C.id,...C})),pagination:{pageSize:10},size:"middle"})]})}const ot=Object.freeze(Object.defineProperty({__proto__:null,default:Gs},Symbol.toStringTag,{value:"Module"})),Fs=[{id:"act-1",type:"assignment",title:"Trabalho de Álgebra Linear",description:"Resolva os exercícios dos capítulos 1 e 2 do livro texto.",dueDate:"2023-10-15T23:59:59",points:10,status:"pending",submissionCount:15,totalStudents:25,createdAt:"2023-09-10T14:30:00",attachments:[{id:"file1",name:"enunciado.pdf",type:"pdf",size:"2.4 MB"},{id:"file2",name:"material-apoio.docx",type:"doc",size:"1.2 MB"}]},{id:"act-2",type:"quiz",title:"Prova de Trigonometria",description:"Prova sobre identidades trigonométricas e resolução de triângulos.",dueDate:"2023-10-05T10:00:00",points:20,status:"graded",averageScore:7.8,submissionCount:24,totalStudents:25,createdAt:"2023-09-01T09:15:00",timeLimit:60,questionCount:15},{id:"act-3",type:"material",title:"Apostila de Cálculo I",description:"Material de apoio para a unidade de derivadas e integrais.",status:"published",createdAt:"2023-08-28T16:45:00",attachments:[{id:"file3",name:"apostila-calculo.pdf",type:"pdf",size:"5.7 MB"}],viewCount:42},{id:"act-4",type:"assignment",title:"Exercícios de Geometria Analítica",description:"Lista de exercícios sobre retas e planos no espaço.",dueDate:"2023-09-28T23:59:59",points:15,status:"submitted",submissionCount:18,totalStudents:25,createdAt:"2023-09-15T11:20:00",isGraded:!1},{id:"act-5",type:"quiz",title:"Questionário de Revisão",description:"Perguntas sobre os tópicos da última aula.",dueDate:"2023-09-20T23:59:59",points:5,status:"pending",submissionCount:10,totalStudents:25,createdAt:"2023-09-18T08:30:00",timeLimit:30,questionCount:10}],ss=[{value:"all",label:"Todas as atividades"},{value:"assignment",label:"Trabalhos"},{value:"quiz",label:"Questionários"},{value:"material",label:"Materiais"},{value:"pending",label:"Pendentes"},{value:"submitted",label:"Entregues"},{value:"graded",label:"Avaliados"},{value:"overdue",label:"Atrasados"}],ts=[{value:"newest",label:"Mais recentes primeiro"},{value:"oldest",label:"Mais antigas primeiro"},{value:"dueDate",label:"Data de entrega"},{value:"title",label:"Título (A-Z)"}],Hs=()=>{const{classId:o}=we(),l=qe(),A=Le();_e();const[d,$]=h.useState([]),[X,G]=h.useState(!0),[F,Y]=h.useState(""),[C,f]=h.useState("all"),[S,_]=h.useState(""),[b,R]=h.useState("all"),[z,L]=h.useState("newest"),[q,v]=h.useState("list"),[p,y]=h.useState([]),[J,Z]=h.useState(null),[n,D]=h.useState(null),[ge,me]=h.useState(null),{data:he,loading:re,error:be}=ms(o);h.useEffect(()=>{(async()=>{if(o)try{if(G(re),Y(be),he){const r=he.map((x,m)=>({id:x.id,type:x.type||"assignment",title:x.title||`Atividade ${m+1}`,description:x.description||"Sem descrição",dueDate:x.due_date||null,points:x.max_points||10,status:x.status||"pending",submissionCount:0,totalStudents:25,createdAt:x.created_at||new Date().toISOString(),attachments:x.instructions?[{id:"file1",name:"instructions.txt",type:"text",size:"1 KB"}]:[],isGraded:!1}));$(r)}else re||(await new Promise(r=>setTimeout(r,800)),$(Fs))}catch(r){console.error("Error processing activities:",r),Y("Erro ao processar as atividades")}})()},[o,he,re,be]);const te=h.useMemo(()=>{let s=[...d];if(S){const r=S.toLowerCase();s=s.filter(x=>x.title.toLowerCase().includes(r)||x.description&&x.description.toLowerCase().includes(r))}if(b!=="all")if(["assignment","quiz","material"].includes(b))s=s.filter(r=>r.type===b);else switch(b){case"pending":s=s.filter(r=>r.dueDate&&_s(N(r.dueDate),new Date)&&(!r.submissionCount||r.submissionCount<r.totalStudents));break;case"submitted":s=s.filter(r=>r.status==="submitted"||r.status==="graded");break;case"graded":s=s.filter(r=>r.status==="graded");break;case"overdue":s=s.filter(r=>r.dueDate&&Je(N(r.dueDate),new Date)&&(!r.submissionCount||r.submissionCount<r.totalStudents));break}return s.sort((r,x)=>{switch(z){case"newest":return new Date(x.createdAt)-new Date(r.createdAt);case"oldest":return new Date(r.createdAt)-new Date(x.createdAt);case"dueDate":return r.dueDate?x.dueDate?new Date(r.dueDate)-new Date(x.dueDate):-1:1;case"title":return r.title.localeCompare(x.title);default:return 0}}),s},[d,S,b,z]),Ie=(s,r)=>{f(r),R(r==="all"?"all":r)},u=(s,r)=>{Z(s.currentTarget),s.currentTarget.dataset.activityId=r},i=()=>{Z(null)},g=s=>{const r=J?.dataset?.activityId;if(i(),!!r)switch(s){case"view":l(`/dashboard/classes/${o}/activities/${r}`);break;case"edit":l(`/dashboard/classes/${o}/activities/${r}/edit`);break;case"grade":l(`/dashboard/classes/${o}/activities/${r}/grade`);break;case"duplicate":console.log("Duplicate activity:",r);break;case"delete":window.confirm("Tem certeza que deseja excluir esta atividade?")&&(console.log("Delete activity:",r),$(x=>x.filter(m=>m.id!==r)));break}},V=s=>{s.target.checked?y(te.map(r=>r.id)):y([])},w=(s,r)=>{const x=p.indexOf(r);let m=[];x===-1?m=m.concat(p,r):x===0?m=m.concat(p.slice(1)):x===p.length-1?m=m.concat(p.slice(0,-1)):x>0&&(m=m.concat(p.slice(0,x),p.slice(x+1))),y(m)},E=s=>{switch(s){case"delete":window.confirm(`Tem certeza que deseja excluir as ${p.length} atividades selecionadas?`)&&(console.log("Delete activities:",p),$(r=>r.filter(x=>!p.includes(x.id))),y([]));break;case"publish":console.log("Publish activities:",p),y([]);break;case"unpublish":console.log("Unpublish activities:",p),y([]);break}},W=s=>{if(!s.dueDate)return null;const r=N(s.dueDate),x=Je(r,new Date);return s.status==="graded"?{text:"Avaliado",color:"success"}:s.status==="submitted"?{text:"Entregue",color:"info"}:x?{text:"Atrasado",color:"error"}:qs(r)?{text:"Vence hoje",color:"warning"}:null},fe=s=>{switch(s){case"assignment":return e.jsx(xe,{});case"quiz":return e.jsx(He,{});case"material":return e.jsx(Ne,{});default:return e.jsx(Ae,{})}},je=s=>{const r=W(s),x=p.includes(s.id);return e.jsxs(I,{sx:{height:"100%",display:"flex",flexDirection:"column",border:x?`2px solid ${A.palette.primary.main}`:"1px solid",borderColor:"divider","&:hover":{boxShadow:A.shadows[4]}},children:[e.jsxs(Cs,{component:"div",onClick:()=>l(`/dashboard/classes/${o}/activities/${s.id}`),sx:{flexGrow:1,display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(ee,{avatar:e.jsx(ne,{sx:{bgcolor:A.palette.primary.main},children:fe(s.type)}),action:e.jsx(ve,{checked:x,onClick:m=>m.stopPropagation(),onChange:m=>w(m,s.id),inputProps:{"aria-label":"selecionar atividade"},sx:{p:1}}),title:e.jsx(t,{variant:"subtitle1",noWrap:!0,sx:{width:"100%"},children:s.title}),subheader:e.jsx(t,{variant:"body2",color:"text.secondary",noWrap:!0,children:s.type==="assignment"?"Trabalho":s.type==="quiz"?"Questionário":"Material"}),sx:{width:"100%",p:1.5,pb:0}}),e.jsxs(B,{sx:{width:"100%",p:2,pt:0},children:[e.jsx(t,{variant:"body2",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden",mb:1.5,minHeight:60},children:s.description||"Sem descrição"}),s.dueDate&&e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Se,{fontSize:"small",color:"action",sx:{mr:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:M(N(s.dueDate),"dd/MM/yyyy 'às' HH:mm")})]}),s.points>0&&e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(De,{fontSize:"small",color:"action",sx:{mr:1}}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:[s.points," ",s.points===1?"ponto":"pontos"]})]}),s.type==="quiz"&&s.timeLimit&&e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(is,{fontSize:"small",color:"action",sx:{mr:1}}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:[s.timeLimit," min • ",s.questionCount," perguntas"]})]}),r&&e.jsx(ae,{label:r.text,size:"small",color:r.color,variant:"outlined",sx:{mt:1}}),s.attachments&&s.attachments.length>0&&e.jsxs(a,{sx:{mt:1.5},children:[e.jsxs(t,{variant:"caption",color:"text.secondary",display:"block",gutterBottom:!0,children:["Anexos (",s.attachments.length,"):"]}),s.attachments.slice(0,2).map((m,Xs)=>e.jsx(ae,{icon:e.jsx(Ae,{}),label:`${m.name} (${m.size})`,size:"small",variant:"outlined",sx:{mr:.5,mb:.5,maxWidth:"100%"},onClick:ls=>{ls.stopPropagation(),console.log("Download file:",m.id)}},m.id)),s.attachments.length>2&&e.jsxs(t,{variant:"caption",color:"text.secondary",display:"block",sx:{mt:.5},children:["+",s.attachments.length-2," mais"]})]}),s.type==="assignment"&&s.submissionCount!==void 0&&e.jsxs(a,{sx:{mt:2,mb:1},children:[e.jsxs(a,{display:"flex",justifyContent:"space-between",mb:.5,children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:"Entregas"}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:[s.submissionCount,"/",s.totalStudents]})]}),e.jsx(ke,{variant:"determinate",value:s.submissionCount/s.totalStudents*100,sx:{height:6,borderRadius:3}})]}),s.type==="quiz"&&s.averageScore!==void 0&&e.jsxs(a,{sx:{mt:2,mb:1},children:[e.jsxs(a,{display:"flex",justifyContent:"space-between",mb:.5,children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:"Média da turma"}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:[s.averageScore.toFixed(1),"/",s.points]})]}),e.jsx(ke,{variant:"determinate",value:s.averageScore/s.points*100,color:s.averageScore>=s.points*.7?"success":"primary",sx:{height:6,borderRadius:3}})]})]})]}),e.jsx(P,{}),e.jsxs(Ss,{sx:{p:1,justifyContent:"space-between"},children:[e.jsxs(a,{children:[s.type==="assignment"&&e.jsx(U,{title:"Ver entregas",children:e.jsx(k,{size:"small",onClick:m=>{m.stopPropagation(),l(`/dashboard/classes/${o}/activities/${s.id}/submissions`)},children:e.jsx(Qe,{fontSize:"small"})})}),s.type==="quiz"&&s.averageScore!==void 0&&e.jsx(U,{title:"Ver resultados",children:e.jsx(k,{size:"small",onClick:m=>{m.stopPropagation(),l(`/dashboard/classes/${o}/activities/${s.id}/results`)},children:e.jsx(BarChartIcon,{fontSize:"small"})})}),s.viewCount!==void 0&&e.jsx(U,{title:`Visualizado ${s.viewCount} vezes`,children:e.jsxs(a,{display:"inline-flex",alignItems:"center",ml:1,color:"text.secondary",children:[e.jsx(ze,{fontSize:"small",sx:{mr:.5}}),e.jsx(t,{variant:"caption",children:s.viewCount})]})})]}),e.jsx(a,{children:e.jsx(k,{size:"small",onClick:m=>{m.stopPropagation(),u(m,s.id)},children:e.jsx(Te,{fontSize:"small"})})})]})]},s.id)},os=s=>{const r=W(s),x=p.includes(s.id);return e.jsx(rs.Fragment,{children:e.jsx(ce,{sx:{p:0,bgcolor:x?"action.selected":"background.paper",border:"1px solid",borderColor:"divider",mb:1,borderRadius:1,overflow:"hidden","&:hover":{boxShadow:A.shadows[1]}},secondaryAction:e.jsxs(a,{display:"flex",alignItems:"center",children:[s.dueDate&&e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mr:2,display:{xs:"none",md:"block"},whiteSpace:"nowrap"},children:M(N(s.dueDate),"dd/MM/yyyy 'às' HH:mm")}),r&&e.jsx(ae,{label:r.text,size:"small",color:r.color,variant:"outlined",sx:{mr:1,display:{xs:"none",sm:"flex"}}}),e.jsx(ve,{checked:x,onChange:m=>w(m,s.id),onClick:m=>m.stopPropagation(),inputProps:{"aria-label":"selecionar atividade"},sx:{p:1}}),e.jsx(k,{edge:"end","aria-label":"mais opções",onClick:m=>u(m,s.id),children:e.jsx(Te,{})})]}),children:e.jsxs(ks,{component:"div",onClick:()=>l(`/dashboard/classes/${o}/activities/${s.id}`),sx:{py:1.5},children:[e.jsxs(le,{sx:{minWidth:40},children:[e.jsx(ve,{checked:x,tabIndex:-1,disableRipple:!0,onClick:m=>{m.stopPropagation(),w(m,s.id)},inputProps:{"aria-label":"selecionar atividade"},sx:{p:0,mr:1}}),e.jsx(ne,{sx:{bgcolor:A.palette.primary.main,width:40,height:40},children:fe(s.type)})]}),e.jsx(H,{primary:e.jsx(t,{variant:"subtitle1",noWrap:!0,children:s.title}),secondary:e.jsxs(e.Fragment,{children:[e.jsx(t,{component:"span",variant:"body2",color:"text.secondary",sx:{display:"inline",mr:1},children:s.type==="assignment"?"Trabalho":s.type==="quiz"?"Questionário":"Material"}),s.points>0&&e.jsxs(t,{component:"span",variant:"body2",color:"text.secondary",sx:{display:"inline",mr:1},children:["• ",s.points," ",s.points===1?"ponto":"pontos"]}),s.type==="quiz"&&s.timeLimit&&e.jsxs(t,{component:"span",variant:"body2",color:"text.secondary",sx:{display:"inline"},children:["• ",s.timeLimit," min • ",s.questionCount," perguntas"]}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mt:.5,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:s.description||"Sem descrição"})]}),secondaryTypographyProps:{component:"div"},sx:{mr:2,"& .MuiListItemText-primary":{display:"flex",alignItems:"center"}}}),e.jsxs(a,{sx:{display:{xs:"none",sm:"flex"},flexDirection:"column",alignItems:"flex-end",ml:2},children:[s.type==="assignment"&&s.submissionCount!==void 0&&e.jsx(U,{title:`${s.submissionCount} de ${s.totalStudents} alunos entregaram`,children:e.jsxs(a,{display:"flex",alignItems:"center",mb:.5,children:[e.jsx(Qe,{fontSize:"small",color:"action",sx:{mr:.5}}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:[s.submissionCount,"/",s.totalStudents]})]})}),s.type==="quiz"&&s.averageScore!==void 0&&e.jsx(U,{title:`Média da turma: ${s.averageScore.toFixed(1)}/${s.points}`,children:e.jsxs(a,{display:"flex",alignItems:"center",children:[e.jsx(De,{fontSize:"small",color:"action",sx:{mr:.5}}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:[s.averageScore.toFixed(1),"/",s.points]})]})}),s.viewCount!==void 0&&e.jsx(U,{title:`Visualizado ${s.viewCount} vezes`,children:e.jsxs(a,{display:"flex",alignItems:"center",mt:.5,children:[e.jsx(ze,{fontSize:"small",color:"action",sx:{mr:.5}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:s.viewCount})]})})]})]})})},s.id)};return e.jsxs(a,{children:[e.jsx(Re,{title:"Atividades da Turma",breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Turmas",href:"/dashboard/classes"},{title:o,href:`/dashboard/classes/${o}`},{title:"Atividades"}],action:e.jsx(j,{variant:"contained",color:"primary",startIcon:e.jsx(K,{}),onClick:()=>l(`/dashboard/classes/${o}/activities/new`),children:"Nova Atividade"})}),e.jsxs(I,{sx:{mb:3},children:[e.jsx(B,{sx:{p:2},children:e.jsxs(c,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsx(pe,{fullWidth:!0,variant:"outlined",size:"small",placeholder:"Buscar atividades...",value:S,onChange:s=>_(s.target.value),InputProps:{startAdornment:e.jsx(hs,{color:"action",sx:{mr:1}}),endAdornment:S&&e.jsx(k,{size:"small",onClick:()=>_(""),edge:"end",children:e.jsx(Fe,{fontSize:"small"})})}})}),e.jsx(c,{item:!0,xs:12,sm:6,md:8,children:e.jsxs(a,{display:"flex",justifyContent:"flex-end",flexWrap:"wrap",gap:1,children:[e.jsx(j,{variant:"outlined",size:"small",startIcon:e.jsx(js,{}),onClick:s=>D(s.currentTarget),sx:{textTransform:"none"},children:ss.find(s=>s.value===b)?.label||"Filtrar"}),e.jsxs(Ce,{anchorEl:n,open:!!n,onClose:()=>D(null),children:[e.jsx(T,{disabled:!0,children:e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Filtrar por tipo"})}),ss.map(s=>e.jsx(T,{selected:b===s.value,onClick:()=>{R(s.value),D(null)},children:s.label},s.value))]}),e.jsx(j,{variant:"outlined",size:"small",startIcon:e.jsx(ps,{}),onClick:s=>me(s.currentTarget),sx:{textTransform:"none"},children:ts.find(s=>s.value===z)?.label||"Ordenar"}),e.jsx(Ce,{anchorEl:ge,open:!!ge,onClose:()=>me(null),children:ts.map(s=>e.jsx(T,{selected:z===s.value,onClick:()=>{L(s.value),me(null)},children:s.label},s.value))}),e.jsxs(a,{display:"flex",border:1,borderColor:"divider",borderRadius:1,children:[e.jsx(U,{title:"Visualização em lista",children:e.jsx(k,{size:"small",onClick:()=>v("list"),color:q==="list"?"primary":"default",sx:{borderRadius:0,borderTopLeftRadius:4,borderBottomLeftRadius:4},children:e.jsx(gs,{})})}),e.jsx(P,{orientation:"vertical",flexItem:!0}),e.jsx(U,{title:"Visualização em grade",children:e.jsx(k,{size:"small",onClick:()=>v("grid"),color:q==="grid"?"primary":"default",sx:{borderRadius:0,borderTopRightRadius:4,borderBottomRightRadius:4},children:e.jsx(bs,{})})})]})]})})]})}),e.jsxs(Ve,{value:C,onChange:Ie,variant:"scrollable",scrollButtons:"auto",sx:{borderBottom:1,borderColor:"divider","& .MuiTabs-flexContainer":{borderBottom:"none"}},children:[e.jsx(O,{label:"Todas",value:"all",sx:{textTransform:"none",minWidth:"auto",px:2}}),e.jsx(O,{label:"Trabalhos",value:"assignment",icon:e.jsx(xe,{fontSize:"small",sx:{mb:0,mr:.5}}),iconPosition:"start",sx:{textTransform:"none",minWidth:"auto",px:2}}),e.jsx(O,{label:"Questionários",value:"quiz",icon:e.jsx(He,{fontSize:"small",sx:{mb:0,mr:.5}}),iconPosition:"start",sx:{textTransform:"none",minWidth:"auto",px:2}}),e.jsx(O,{label:"Materiais",value:"material",icon:e.jsx(Ne,{fontSize:"small",sx:{mb:0,mr:.5}}),iconPosition:"start",sx:{textTransform:"none",minWidth:"auto",px:2}}),e.jsx(O,{label:"Pendentes",value:"pending",icon:e.jsx(fs,{fontSize:"small",sx:{mb:0,mr:.5}}),iconPosition:"start",sx:{textTransform:"none",minWidth:"auto",px:2}}),e.jsx(O,{label:"Atrasados",value:"overdue",icon:e.jsx(vs,{fontSize:"small",color:"error",sx:{mb:0,mr:.5}}),iconPosition:"start",sx:{textTransform:"none",minWidth:"auto",px:2}})]})]}),p.length>0&&e.jsx(I,{sx:{mb:3,bgcolor:"action.selected"},children:e.jsx(B,{sx:{p:1.5},children:e.jsxs(a,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(a,{display:"flex",alignItems:"center",children:[e.jsx(ve,{checked:p.length===te.length,indeterminate:p.length>0&&p.length<te.length,onChange:V,inputProps:{"aria-label":"selecionar todas as atividades"},sx:{mr:1}}),e.jsxs(t,{variant:"subtitle2",children:[p.length," ",p.length===1?"atividade selecionada":"atividades selecionadas"]})]}),e.jsxs(a,{children:[e.jsx(j,{size:"small",startIcon:e.jsx(oe,{}),onClick:()=>E("delete"),sx:{mr:1},children:"Excluir"}),e.jsx(j,{size:"small",variant:"contained",startIcon:e.jsx(ys,{}),onClick:()=>E("publish"),sx:{mr:1},children:"Publicar"}),e.jsx(j,{size:"small",variant:"outlined",startIcon:e.jsx(Fe,{}),onClick:()=>y([]),children:"Cancelar"})]})]})})}),X?e.jsx(a,{display:"flex",justifyContent:"center",my:8,children:e.jsx(ns,{})}):F?e.jsx(Alert,{severity:"error",sx:{mb:3},children:F}):te.length===0?e.jsxs(a,{textAlign:"center",py:6,children:[e.jsx(Ae,{sx:{fontSize:64,color:"text.disabled",mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"Nenhuma atividade encontrada"}),e.jsx(t,{variant:"body2",color:"text.secondary",paragraph:!0,children:S||b!=="all"?"Tente ajustar sua busca ou filtros.":"Comece criando uma nova atividade para esta turma."}),!S&&b==="all"&&e.jsx(j,{variant:"contained",color:"primary",startIcon:e.jsx(K,{}),onClick:()=>l(`/dashboard/classes/${o}/activities/new`),sx:{mt:2},children:"Criar Primeira Atividade"})]}):q==="grid"?e.jsx(c,{container:!0,spacing:3,children:te.map(s=>e.jsx(c,{item:!0,xs:12,sm:6,md:4,lg:3,children:je(s)},s.id))}):e.jsx(de,{disablePadding:!0,children:te.map(s=>os(s))}),e.jsxs(Ce,{anchorEl:J,open:!!J,onClose:i,onClick:i,transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[e.jsxs(T,{onClick:()=>g("view"),children:[e.jsx(le,{children:e.jsx(ze,{fontSize:"small"})}),e.jsx(H,{children:"Visualizar"})]}),e.jsxs(T,{onClick:()=>g("edit"),children:[e.jsx(le,{children:e.jsx(ue,{fontSize:"small"})}),e.jsx(H,{children:"Editar"})]}),e.jsxs(T,{onClick:()=>g("grade"),children:[e.jsx(le,{children:e.jsx(De,{fontSize:"small"})}),e.jsx(H,{children:"Avaliar"})]}),e.jsx(P,{}),e.jsxs(T,{onClick:()=>g("duplicate"),children:[e.jsx(le,{children:e.jsx(FileCopyIcon,{fontSize:"small"})}),e.jsx(H,{children:"Duplicar"})]}),e.jsx(P,{}),e.jsxs(T,{onClick:()=>g("delete"),sx:{color:"error.main"},children:[e.jsx(le,{sx:{color:"error.main"},children:e.jsx(oe,{fontSize:"small"})}),e.jsx(H,{children:"Excluir"})]})]})]})},lt=Object.freeze(Object.defineProperty({__proto__:null,default:Hs},Symbol.toStringTag,{value:"Module"})),Ns=()=>e.jsxs(a,{sx:{p:2,textAlign:"center",color:"text.secondary"},children:[e.jsx(Oe,{sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",children:"Gráfico de desempenho da turma"})]}),Qs=()=>e.jsxs(a,{sx:{p:2,textAlign:"center",color:"text.secondary"},children:[e.jsx(As,{sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",children:"Gráfico de frequência"})]}),Ks={id:"class-1",name:"Matemática Avançada",code:"MAT-2023-01",description:"Aulas de matemática avançada para o ensino médio",teacher:"Prof. Carlos Silva",startDate:"2023-02-01",endDate:"2023-11-30",schedule:[{day:"Segunda",time:"08:00 - 09:30"},{day:"Quarta",time:"10:00 - 11:30"},{day:"Sexta",time:"14:00 - 15:30"}],students:Array(15).fill().map((o,l)=>({id:`student-${l+1}`,name:`Aluno ${l+1}`,email:`aluno${l+1}@escola.com`,avatar:`https://i.pravatar.cc/150?img=${l+10}`,status:["Ativo","Inativo","Pendente"][l%3],lastAccess:new Date(Date.now()-Math.random()*30*24*60*60*1e3).toISOString()})),recentActivities:[{id:"act-1",type:"assignment",title:"Trabalho de Álgebra Linear",date:"2023-09-15T14:30:00",dueDate:"2023-09-30T23:59:59",status:"pending"},{id:"act-2",type:"quiz",title:"Prova de Trigonometria",date:"2023-09-10T10:00:00",score:8.5,total:10},{id:"act-3",type:"material",title:"Apostila de Cálculo I",date:"2023-09-05T08:15:00"}],stats:{totalStudents:25,activeStudents:20,averageGrade:7.8,attendanceRate:92.5}},Ys=()=>{const{classId:o}=we(),l=qe(),A=Le();_e();const[d,$]=h.useState(null),[X,G]=h.useState(!0),[F,Y]=h.useState(""),[C,f]=h.useState("overview"),[S,_]=h.useState(null),[b,R]=h.useState(0);h.useState(0);const z=5,L=n=>{_(n.currentTarget)},q=()=>{_(null)},v=n=>{switch(q(),n){case"edit":l(`/dashboard/classes/${o}/edit`);break;case"delete":window.confirm("Tem certeza que deseja excluir esta turma?")&&(console.log("Deleting class:",o),l("/dashboard/classes"));break;case"archive":console.log("Archiving class:",o);break}},p=(n,D)=>{f(D)};if(h.useEffect(()=>{(async()=>{try{G(!0),await new Promise(D=>setTimeout(D,800)),$(Ks),G(!1)}catch(D){console.error("Error fetching class data:",D),Y("Erro ao carregar os dados da turma"),G(!1)}})()},[o]),X)return e.jsx(a,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh",children:e.jsx(ns,{})});if(F||!d)return e.jsxs(a,{textAlign:"center",py:4,children:[e.jsx(t,{color:"error",gutterBottom:!0,children:F||"Turma não encontrada"}),e.jsx(j,{variant:"outlined",color:"primary",onClick:()=>l(-1),sx:{mt:2},children:"Voltar"})]});const y=n=>M(N(n),"dd 'de' MMMM 'de' yyyy",{locale:Q}),J=n=>{switch(n){case"Ativo":return"success";case"Inativo":return"error";case"Pendente":return"warning";default:return"default"}},Z=()=>{switch(C){case"students":return e.jsxs(I,{children:[e.jsx(ee,{title:"Alunos Matriculados",action:e.jsx(j,{variant:"contained",color:"primary",startIcon:e.jsx(K,{}),onClick:()=>l(`/dashboard/classes/${o}/enroll`),children:"Matricular Alunos"})}),e.jsx(P,{}),e.jsx(de,{children:d.students.slice(b*z,b*z+z).map(n=>e.jsxs(ce,{button:!0,children:[e.jsx($e,{children:e.jsx(ne,{src:n.avatar,alt:n.name})}),e.jsx(H,{primary:n.name,secondary:e.jsxs(e.Fragment,{children:[e.jsx(t,{component:"span",variant:"body2",color:"text.primary",display:"block",children:n.email}),e.jsxs(a,{display:"flex",alignItems:"center",mt:.5,children:[e.jsx(ae,{label:n.status,size:"small",color:J(n.status),variant:"outlined",sx:{mr:1}}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Último acesso: ",M(N(n.lastAccess),"dd/MM/yyyy")]})]})]})}),e.jsx(Ye,{children:e.jsx(k,{edge:"end","aria-label":"enviar mensagem",children:e.jsx(Ke,{})})})]},n.id))}),e.jsxs(a,{p:2,display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Mostrando ",Math.min(b*z+1,d.students.length),"-",Math.min((b+1)*z,d.students.length)," de ",d.students.length," alunos"]}),e.jsxs(a,{children:[e.jsx(j,{size:"small",onClick:()=>R(n=>Math.max(0,n-1)),disabled:b===0,children:"Anterior"}),e.jsx(j,{size:"small",onClick:()=>R(n=>n+1),disabled:(b+1)*z>=d.students.length,sx:{ml:1},children:"Próximo"})]})]})]});case"activities":return e.jsxs(I,{children:[e.jsx(ee,{title:"Atividades Recentes",action:e.jsx(j,{variant:"contained",color:"primary",startIcon:e.jsx(K,{}),onClick:()=>l(`/dashboard/classes/${o}/activities/new`),children:"Nova Atividade"})}),e.jsx(P,{}),e.jsx(de,{children:d.recentActivities.map(n=>e.jsxs(ce,{button:!0,onClick:()=>{console.log("View activity:",n.id)},children:[e.jsx($e,{children:e.jsx(ne,{sx:{bgcolor:A.palette.primary.main},children:n.type==="assignment"?e.jsx(xe,{}):n.type==="quiz"?e.jsx(Me,{}):e.jsx(Pe,{})})}),e.jsx(H,{primary:n.title,secondary:e.jsxs(e.Fragment,{children:[e.jsxs(t,{component:"span",variant:"body2",color:"text.primary",display:"block",children:[n.type==="assignment"&&"Trabalho",n.type==="quiz"&&"Prova",n.type==="material"&&"Material de Estudo",n.dueDate&&e.jsx(ae,{label:`Entrega: ${M(N(n.dueDate),"dd/MM/yyyy")}`,size:"small",color:n.status==="pending"?"warning":"default",variant:"outlined",sx:{ml:1}}),n.score!==void 0&&e.jsx(ae,{label:`${n.score}/${n.total} pontos`,size:"small",color:"primary",variant:"outlined",sx:{ml:1}})]}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Postado em: ",M(N(n.date),"dd/MM/yyyy HH:mm")]})]})}),e.jsx(Ye,{children:e.jsx(k,{edge:"end","aria-label":"mais opções",children:e.jsx(Te,{})})})]},n.id))}),e.jsx(a,{p:2,textAlign:"center",children:e.jsx(j,{variant:"outlined",color:"primary",onClick:()=>l(`/dashboard/classes/${o}/activities`),children:"Ver todas as atividades"})})]});case"analytics":return e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,md:6,children:e.jsxs(I,{children:[e.jsx(ee,{title:"Desempenho da Turma"}),e.jsx(P,{}),e.jsx(B,{children:e.jsx(Ns,{})})]})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsxs(I,{children:[e.jsx(ee,{title:"Frequência"}),e.jsx(P,{}),e.jsx(B,{children:e.jsx(Qs,{})})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(I,{children:[e.jsx(ee,{title:"Estatísticas"}),e.jsx(P,{}),e.jsx(B,{children:e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(ie,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"primary",children:d.stats.totalStudents}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Alunos Matriculados"})]})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(ie,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"success.main",children:d.stats.activeStudents}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Alunos Ativos"})]})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(ie,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"secondary",children:d.stats.averageGrade.toFixed(1)}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Média da Turma"})]})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(ie,{sx:{p:2,textAlign:"center"},children:[e.jsxs(t,{variant:"h4",color:"info.main",children:[d.stats.attendanceRate,"%"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Taxa de Frequência"})]})})]})})]})})]});case"settings":return e.jsxs(I,{children:[e.jsx(ee,{title:"Configurações da Turma"}),e.jsx(P,{}),e.jsx(B,{children:e.jsxs(c,{container:!0,spacing:3,children:[e.jsxs(c,{item:!0,xs:12,md:6,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Informações Básicas"}),e.jsxs(a,{mb:3,children:[e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Código da Turma"}),e.jsx(t,{variant:"body1",gutterBottom:!0,children:d.code}),e.jsx(t,{variant:"subtitle2",color:"text.secondary",sx:{mt:2},children:"Professor"}),e.jsx(t,{variant:"body1",gutterBottom:!0,children:d.teacher}),e.jsx(t,{variant:"subtitle2",color:"text.secondary",sx:{mt:2},children:"Período"}),e.jsxs(t,{variant:"body1",gutterBottom:!0,children:[y(d.startDate)," - ",y(d.endDate)]})]}),e.jsx(j,{variant:"outlined",startIcon:e.jsx(ue,{}),onClick:()=>l(`/dashboard/classes/${o}/edit`),children:"Editar Informações"})]}),e.jsxs(c,{item:!0,xs:12,md:6,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Horário das Aulas"}),e.jsx(de,{children:d.schedule.map((n,D)=>e.jsx(ce,{children:e.jsx(H,{primary:`${n.day} - ${n.time}`,primaryTypographyProps:{fontWeight:"medium"}})},D))}),e.jsx(j,{variant:"outlined",startIcon:e.jsx(Se,{}),onClick:()=>l(`/dashboard/classes/${o}/schedule`),children:"Gerenciar Horários"})]}),e.jsxs(c,{item:!0,xs:12,children:[e.jsx(P,{sx:{my:2}}),e.jsx(t,{variant:"h6",color:"error",gutterBottom:!0,children:"Zona de Perigo"}),e.jsx(t,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Ações nesta seção não podem ser desfeitas. Tenha certeza do que está fazendo."}),e.jsxs(a,{mt:2,children:[e.jsx(j,{variant:"contained",color:"error",startIcon:e.jsx(oe,{}),onClick:()=>{window.confirm("Tem certeza que deseja excluir permanentemente esta turma? Esta ação não pode ser desfeita.")&&(console.log("Deleting class:",o),l("/dashboard/classes"))},sx:{mr:2},children:"Excluir Turma"}),e.jsx(j,{variant:"outlined",color:"error",startIcon:e.jsx(Is,{}),onClick:()=>{window.confirm("Tem certeza que deseja remover todos os alunos desta turma?")&&console.log("Removing all students from class:",o)},children:"Remover Todos os Alunos"})]})]})]})})]});default:return e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,md:6,children:e.jsxs(I,{children:[e.jsx(ee,{title:"Informações da Turma",action:e.jsx(k,{onClick:L,children:e.jsx(Te,{})})}),e.jsxs(Ce,{anchorEl:S,open:!!S,onClose:q,children:[e.jsxs(T,{onClick:()=>v("edit"),children:[e.jsx(ue,{fontSize:"small",sx:{mr:1}}),"Editar Turma"]}),e.jsxs(T,{onClick:()=>v("archive"),children:[e.jsx(ArchiveIcon,{fontSize:"small",sx:{mr:1}}),"Arquivar Turma"]}),e.jsx(P,{}),e.jsxs(T,{onClick:()=>v("delete"),sx:{color:"error.main"},children:[e.jsx(oe,{fontSize:"small",sx:{mr:1}}),"Excluir Turma"]})]}),e.jsx(P,{}),e.jsxs(B,{children:[e.jsx(t,{variant:"h5",gutterBottom:!0,children:d.name}),e.jsx(t,{variant:"body1",color:"text.secondary",paragraph:!0,children:d.description||"Nenhuma descrição fornecida."}),e.jsxs(a,{mt:3,children:[e.jsxs(a,{display:"flex",alignItems:"center",mb:1.5,children:[e.jsx(Me,{color:"action",sx:{mr:1.5}}),e.jsxs("div",{children:[e.jsx(t,{variant:"subtitle2",children:"Professor"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:d.teacher})]})]}),e.jsxs(a,{display:"flex",alignItems:"center",mb:1.5,children:[e.jsx(Se,{color:"action",sx:{mr:1.5}}),e.jsxs("div",{children:[e.jsx(t,{variant:"subtitle2",children:"Período"}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:[y(d.startDate)," - ",y(d.endDate)]})]})]}),e.jsxs(a,{display:"flex",alignItems:"center",children:[e.jsx(ye,{color:"action",sx:{mr:1.5}}),e.jsxs("div",{children:[e.jsx(t,{variant:"subtitle2",children:"Alunos"}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:[d.stats.totalStudents," alunos matriculados"]})]})]})]}),e.jsxs(a,{mt:3,children:[e.jsx(t,{variant:"subtitle2",gutterBottom:!0,children:"Próximas Aulas"}),d.schedule.length>0?e.jsx(de,{dense:!0,children:d.schedule.map((n,D)=>e.jsx(ce,{children:e.jsx(H,{primary:`${n.day} - ${n.time}`,primaryTypographyProps:{variant:"body2"}})},D))}):e.jsx(t,{variant:"body2",color:"text.secondary",children:"Nenhum horário de aula definido."})]})]})]})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(I,{sx:{height:"100%"},children:e.jsxs(B,{sx:{textAlign:"center"},children:[e.jsx(ne,{sx:{bgcolor:"primary.light",color:"primary.contrastText",width:56,height:56,mx:"auto",mb:2},children:e.jsx(ye,{})}),e.jsx(t,{variant:"h4",gutterBottom:!0,children:d.stats.totalStudents}),e.jsx(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Alunos Matriculados"}),e.jsx(j,{variant:"outlined",size:"small",sx:{mt:1},onClick:()=>f("students"),children:"Gerenciar Alunos"})]})})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(I,{sx:{height:"100%"},children:e.jsxs(B,{sx:{textAlign:"center"},children:[e.jsx(ne,{sx:{bgcolor:"secondary.light",color:"secondary.contrastText",width:56,height:56,mx:"auto",mb:2},children:e.jsx(xe,{})}),e.jsxs(t,{variant:"h4",gutterBottom:!0,children:[d.recentActivities.length,"+"]}),e.jsx(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Atividades Recentes"}),e.jsx(j,{variant:"outlined",size:"small",color:"secondary",sx:{mt:1},onClick:()=>f("activities"),children:"Ver Atividades"})]})})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(I,{children:e.jsxs(B,{children:[e.jsxs(a,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(Oe,{color:"action",sx:{mr:1}}),e.jsx(t,{variant:"h6",children:"Desempenho da Turma"})]}),e.jsxs(a,{mb:3,children:[e.jsxs(a,{display:"flex",justifyContent:"space-between",mb:.5,children:[e.jsx(t,{variant:"body2",color:"text.secondary",children:"Média Geral"}),e.jsxs(t,{variant:"body2",fontWeight:"medium",children:[d.stats.averageGrade.toFixed(1)," / 10.0"]})]}),e.jsx(ke,{variant:"determinate",value:d.stats.averageGrade*10,color:"primary",sx:{height:8,borderRadius:4}})]}),e.jsxs(a,{children:[e.jsxs(a,{display:"flex",justifyContent:"space-between",mb:.5,children:[e.jsx(t,{variant:"body2",color:"text.secondary",children:"Frequência"}),e.jsxs(t,{variant:"body2",fontWeight:"medium",children:[d.stats.attendanceRate,"%"]})]}),e.jsx(ke,{variant:"determinate",value:d.stats.attendanceRate,color:"success",sx:{height:8,borderRadius:4}})]}),e.jsx(a,{mt:2,textAlign:"center",children:e.jsx(j,{variant:"text",size:"small",onClick:()=>f("analytics"),children:"Ver Análises Detalhadas"})})]})})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(I,{children:e.jsxs(B,{children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Ações Rápidas"}),e.jsxs(c,{container:!0,spacing:1,children:[e.jsx(c,{item:!0,xs:6,sm:4,children:e.jsx(j,{fullWidth:!0,variant:"outlined",size:"small",startIcon:e.jsx(K,{}),onClick:()=>l(`/dashboard/classes/${o}/activities/new`),children:"Atividade"})}),e.jsx(c,{item:!0,xs:6,sm:4,children:e.jsx(j,{fullWidth:!0,variant:"outlined",size:"small",startIcon:e.jsx(ye,{}),onClick:()=>l(`/dashboard/classes/${o}/enroll`),children:"Matricular"})}),e.jsx(c,{item:!0,xs:6,sm:4,children:e.jsx(j,{fullWidth:!0,variant:"outlined",size:"small",startIcon:e.jsx(Ke,{}),onClick:()=>console.log("Enviar mensagem para turma"),children:"Mensagem"})}),e.jsx(c,{item:!0,xs:6,sm:4,children:e.jsx(j,{fullWidth:!0,variant:"outlined",size:"small",startIcon:e.jsx(Ts,{}),onClick:()=>console.log("Enviar notificação"),children:"Notificação"})}),e.jsx(c,{item:!0,xs:6,sm:4,children:e.jsx(j,{fullWidth:!0,variant:"outlined",size:"small",startIcon:e.jsx(ws,{}),onClick:()=>console.log("Abrir chat da turma"),children:"Chat"})}),e.jsx(c,{item:!0,xs:6,sm:4,children:e.jsx(j,{fullWidth:!0,variant:"outlined",size:"small",startIcon:e.jsx(Se,{}),onClick:()=>l(`/dashboard/classes/${o}/schedule`),children:"Horários"})})]})]})})})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(I,{children:[e.jsx(ee,{title:"Atividades Recentes",action:e.jsx(j,{size:"small",onClick:()=>f("activities"),children:"Ver Todas"})}),e.jsx(P,{}),e.jsx(de,{children:d.recentActivities.length>0?d.recentActivities.slice(0,3).map(n=>e.jsxs(rs.Fragment,{children:[e.jsxs(ce,{button:!0,children:[e.jsx($e,{children:e.jsx(ne,{sx:{bgcolor:"action.hover"},children:n.type==="assignment"?e.jsx(xe,{color:"primary"}):n.type==="quiz"?e.jsx(Me,{color:"secondary"}):e.jsx(Pe,{color:"disabled"})})}),e.jsx(H,{primary:n.title,secondary:e.jsxs(e.Fragment,{children:[e.jsxs(t,{component:"span",variant:"body2",color:"text.primary",display:"block",children:[n.type==="assignment"&&"Trabalho",n.type==="quiz"&&"Prova",n.type==="material"&&"Material de Estudo",n.dueDate&&e.jsx(ae,{label:`Entrega: ${M(N(n.dueDate),"dd/MM/yyyy")}`,size:"small",color:n.status==="pending"?"warning":"default",variant:"outlined",sx:{ml:1}})]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:M(N(n.date),"dd 'de' MMMM 'às' HH:mm",{locale:Q})})]})})]}),e.jsx(P,{component:"li"})]},n.id)):e.jsxs(a,{p:3,textAlign:"center",children:[e.jsx(t,{color:"text.secondary",children:"Nenhuma atividade recente"}),e.jsx(j,{variant:"outlined",size:"small",sx:{mt:2},onClick:()=>l(`/dashboard/classes/${o}/activities/new`),children:"Criar Primeira Atividade"})]})})]})})]})}};return e.jsxs(a,{children:[e.jsx(Re,{title:d.name,subtitle:`Código: ${d.code}`,breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Turmas",href:"/dashboard/classes"},{title:d.name}],action:e.jsx(j,{variant:"contained",color:"primary",startIcon:e.jsx(K,{}),onClick:()=>l(`/dashboard/classes/${o}/activities/new`),children:"Nova Atividade"})}),e.jsx(a,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:e.jsxs(Ve,{value:C,onChange:p,"aria-label":"aba de detalhes da turma",variant:"scrollable",scrollButtons:"auto",children:[e.jsx(O,{icon:e.jsx(Pe,{}),iconPosition:"start",label:"Visão Geral",value:"overview"}),e.jsx(O,{icon:e.jsx(ye,{}),iconPosition:"start",label:`Alunos (${d.stats.totalStudents})`,value:"students"}),e.jsx(O,{icon:e.jsx(xe,{}),iconPosition:"start",label:"Atividades",value:"activities"}),e.jsx(O,{icon:e.jsx(Oe,{}),iconPosition:"start",label:"Estatísticas",value:"analytics"}),e.jsx(O,{icon:e.jsx(SettingsIcon,{}),iconPosition:"start",label:"Configurações",value:"settings"})]})}),Z(),e.jsx(a,{mt:4,textAlign:"center",children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Código da turma: ",e.jsx("strong",{children:d.code})," • Compartilhe este código para que os alunos possam se juntar"]})})]})},dt=Object.freeze(Object.defineProperty({__proto__:null,default:Ys},Symbol.toStringTag,{value:"Module"})),as=[{id:"class-1",name:"Matemática Avançada",color:"#3f51b5"},{id:"class-2",name:"Português",color:"#f44336"},{id:"class-3",name:"História",color:"#4caf50"},{id:"class-4",name:"Geografia",color:"#ff9800"},{id:"class-5",name:"Ciências",color:"#9c27b0"}],Zs=[{id:"sched-1",classId:"class-1",dayOfWeek:1,startTime:"08:00",endTime:"09:30",room:"Sala 101",teacher:"Prof. Silva"},{id:"sched-2",classId:"class-2",dayOfWeek:1,startTime:"10:00",endTime:"11:30",room:"Sala 102",teacher:"Prof. Oliveira"}],Ee=["07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00"];daysOfWeek.map(o=>({day:o,date:se(startDate,o.index),name:M(se(startDate,o.index),"EEEE",{locale:Q}),shortName:M(se(startDate,o.index),"EEE",{locale:Q}),dayNumber:M(se(startDate,o.index),"d"),month:M(se(startDate,o.index),"MMM",{locale:Q})}));const Us=()=>{const{classId:o}=we();qe();const l=Le();_e();const[A,d]=h.useState([]),[$,X]=h.useState(!0),[G,F]=h.useState(""),[Y,C]=h.useState("week"),[f,S]=h.useState(new Date),[_,b]=h.useState(es(new Date,{locale:Q})),[R,z]=h.useState(!1),[L,q]=h.useState(""),[v,p]=h.useState({classId:"",dayOfWeek:1,startTime:"08:00",endTime:"09:00",room:"",teacher:""});h.useEffect(()=>{(async()=>{try{X(!0),d(Zs),X(!1)}catch(i){console.error("Error fetching schedule:",i),F("Erro ao carregar a grade horária"),X(!1)}})()},[o]);const y=(u=null)=>{u?(p({...u,dayOfWeek:u.dayOfWeek||1}),q(u.classId)):(p({classId:"",dayOfWeek:1,startTime:"08:00",endTime:"09:00",room:"",teacher:""}),q("")),z(!0)},J=()=>{z(!1),q("")},Z=u=>{const{name:i,value:g}=u.target;p(V=>({...V,[i]:g}))},n=async u=>{u.preventDefault();try{if(console.log("Submitting schedule:",v),await new Promise(i=>setTimeout(i,1e3)),v.id)d(i=>i.map(g=>g.id===v.id?{...v}:g));else{const i={...v,id:`sched-${Date.now()}`,classId:L};d(g=>[...g,i])}J()}catch(i){console.error("Error saving schedule:",i),F("Erro ao salvar o horário")}},D=async u=>{if(window.confirm("Tem certeza que deseja excluir este horário?"))try{console.log("Deleting schedule:",u),await new Promise(i=>setTimeout(i,500)),d(i=>i.filter(g=>g.id!==u))}catch(i){console.error("Error deleting schedule:",i),F("Erro ao excluir o horário")}},ge=()=>{b(u=>se(u,-7))},me=()=>{b(u=>se(u,7))},he=()=>{b(es(new Date,{locale:Q})),S(new Date)},re=u=>as.find(i=>i.id===u)||{name:"Desconhecida",color:"#999"},be=()=>{const u=[];for(let i=0;i<5;i++){const g=se(_,i),V=A.filter(w=>w.dayOfWeek===i+1);u.push(e.jsx(c,{item:!0,xs:12,children:e.jsxs(ie,{elevation:0,sx:{p:2,bgcolor:"background.paper",borderRadius:2},children:[e.jsxs(a,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(t,{variant:"h6",sx:{fontWeight:"medium"},children:M(g,"EEEE",{locale:Q})}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{ml:1},children:M(g,"dd/MM",{locale:Q})}),e.jsx(a,{flexGrow:1}),e.jsx(U,{title:"Adicionar horário",children:e.jsx(k,{size:"small",onClick:()=>y({dayOfWeek:i+1}),color:"primary",children:e.jsx(K,{fontSize:"small"})})})]}),e.jsx(P,{sx:{mb:2}}),V.length===0?e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:4,border:`1px dashed ${l.palette.divider}`,borderRadius:1},children:[e.jsx(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Nenhuma aula agendada"}),e.jsx(j,{size:"small",startIcon:e.jsx(K,{}),onClick:()=>y({dayOfWeek:i+1}),children:"Adicionar Aula"})]}):e.jsx(c,{container:!0,spacing:1,children:V.map(w=>{const E=re(w.classId);return e.jsx(c,{item:!0,xs:12,children:e.jsx(I,{variant:"outlined",sx:{borderLeft:`4px solid ${E.color}`,"&:hover":{boxShadow:l.shadows[2],transform:"translateY(-2px)",transition:"all 0.2s ease-in-out"}},children:e.jsx(B,{sx:{p:2,"&:last-child":{pb:2}},children:e.jsxs(a,{display:"flex",alignItems:"flex-start",children:[e.jsxs(a,{flexGrow:1,children:[e.jsx(t,{variant:"subtitle2",sx:{fontWeight:"medium"},children:E.name}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:[w.startTime," - ",w.endTime]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:[w.room," • ",w.teacher]})]}),e.jsxs(a,{children:[e.jsx(k,{size:"small",onClick:W=>{W.stopPropagation(),y(w)},children:e.jsx(ue,{fontSize:"small"})}),e.jsx(k,{size:"small",color:"error",onClick:W=>{W.stopPropagation(),D(w.id)},children:e.jsx(oe,{fontSize:"small"})})]})]})})})},w.id)})})]})},`day-${i}`))}return e.jsx(c,{container:!0,spacing:2,children:u})},te=()=>{const u=A.filter(i=>i.dayOfWeek===f.getDay()||f.getDay()===0&&i.dayOfWeek===7);return e.jsxs(ie,{elevation:0,sx:{p:2,bgcolor:"background.paper",borderRadius:2},children:[e.jsxs(a,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(t,{variant:"h6",sx:{fontWeight:"medium"},children:M(f,"EEEE, dd MMMM yyyy",{locale:Q})}),e.jsx(a,{flexGrow:1}),e.jsx(U,{title:"Adicionar horário",children:e.jsx(j,{variant:"contained",size:"small",startIcon:e.jsx(K,{}),onClick:()=>y({dayOfWeek:f.getDay()===0?7:f.getDay()}),children:"Adicionar Aula"})})]}),e.jsx(P,{sx:{mb:2}}),u.length===0?e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:8,border:`1px dashed ${l.palette.divider}`,borderRadius:1},children:[e.jsx(t,{variant:"body1",color:"text.secondary",gutterBottom:!0,children:"Nenhuma aula agendada para hoje"}),e.jsx(j,{variant:"outlined",startIcon:e.jsx(K,{}),onClick:()=>y({dayOfWeek:f.getDay()===0?7:f.getDay()}),sx:{mt:2},children:"Adicionar Aula"})]}):e.jsx(c,{container:!0,spacing:2,children:u.map(i=>{const g=re(i.classId);return e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsx(I,{variant:"outlined",sx:{height:"100%",display:"flex",flexDirection:"column",borderLeft:`4px solid ${g.color}`,"&:hover":{boxShadow:l.shadows[2],transform:"translateY(-2px)",transition:"all 0.2s ease-in-out"}},children:e.jsx(B,{sx:{flexGrow:1,p:2},children:e.jsxs(a,{display:"flex",alignItems:"flex-start",children:[e.jsxs(a,{flexGrow:1,children:[e.jsx(ae,{label:g.name,size:"small",sx:{mb:1,bgcolor:`${g.color}20`,color:g.color,fontWeight:"medium"}}),e.jsx(t,{variant:"h6",sx:{mb:1},children:g.name}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(a,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"primary.main",mr:1}}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:[i.startTime," - ",i.endTime]})]}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(a,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"secondary.main",mr:1,opacity:0}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:i.room})]}),e.jsxs(a,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(a,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"success.main",mr:1,opacity:0}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:i.teacher})]})]}),e.jsxs(a,{children:[e.jsx(k,{size:"small",onClick:V=>{V.stopPropagation(),y(i)},children:e.jsx(ue,{fontSize:"small"})}),e.jsx(k,{size:"small",color:"error",onClick:V=>{V.stopPropagation(),D(i.id)},children:e.jsx(oe,{fontSize:"small"})})]})]})})})},i.id)})})]})},Ie=()=>{const u=[{id:1,name:"Segunda"},{id:2,name:"Terça"},{id:3,name:"Quarta"},{id:4,name:"Quinta"},{id:5,name:"Sexta"}];return e.jsx(a,{sx:{width:"100%",overflowX:"auto"},children:e.jsx(TableContainer,{component:ie,elevation:0,children:e.jsxs(Table,{size:"small",sx:{minWidth:800},children:[e.jsx(TableHead,{children:e.jsxs(TableRow,{children:[e.jsx(TableCell,{sx:{width:100},children:"Horário"}),u.map(i=>e.jsxs(TableCell,{align:"center",children:[i.name,e.jsx(t,{variant:"caption",display:"block",color:"text.secondary",children:M(se(_,i.id-1),"dd/MM")})]},i.id))]})}),e.jsx(TableBody,{children:Ee.map((i,g)=>{if(g===Ee.length-1)return null;const V=Ee[g+1];return e.jsxs(TableRow,{children:[e.jsx(TableCell,{component:"th",scope:"row",children:e.jsxs(t,{variant:"body2",children:[i," - ",V]})}),u.map(w=>{const E=A.find(W=>W.dayOfWeek===w.id&&W.startTime<=i&&W.endTime>i);if(E){const W=re(E.classId),fe=Math.ceil((new Date(`2000-01-01T${E.endTime}`)-new Date(`2000-01-01T${E.startTime}`))/(3600*1e3))||1;return i!==E.startTime?null:e.jsx(TableCell,{rowSpan:fe,sx:{borderLeft:`4px solid ${W.color}`,bgcolor:`${W.color}08`,position:"relative","&:hover":{bgcolor:`${W.color}12`}},children:e.jsxs(a,{p:1,children:[e.jsx(t,{variant:"subtitle2",sx:{fontWeight:"medium"},children:W.name}),e.jsx(t,{variant:"body2",color:"text.secondary",children:E.room}),e.jsx(t,{variant:"body2",color:"text.secondary",children:E.teacher}),e.jsxs(a,{sx:{position:"absolute",top:4,right:4,display:"flex",gap:.5},children:[e.jsx(k,{size:"small",onClick:je=>{je.stopPropagation(),y(E)},sx:{p:.5,"&:hover":{bgcolor:"rgba(0, 0, 0, 0.04)"}},children:e.jsx(ue,{fontSize:"small"})}),e.jsx(k,{size:"small",color:"error",onClick:je=>{je.stopPropagation(),D(E.id)},sx:{p:.5,"&:hover":{bgcolor:"rgba(0, 0, 0, 0.04)"}},children:e.jsx(oe,{fontSize:"small"})})]})]})},`${w.id}-${i}`)}return e.jsx(TableCell,{sx:{border:"1px solid",borderColor:"divider"}},`${w.id}-${i}`)})]},i)})})]})})})};return e.jsxs(a,{sx:{flexGrow:1},children:[e.jsx(Re,{title:"Grade Horária",subtitle:"Visualize e gerencie os horários das aulas",action:e.jsx(j,{variant:"contained",startIcon:e.jsx(K,{}),onClick:()=>y(),children:"Novo Horário"})}),e.jsx(I,{sx:{mb:3},children:e.jsx(B,{sx:{p:2},children:e.jsxs(a,{display:"flex",alignItems:"center",flexWrap:"wrap",children:[e.jsxs(a,{display:"flex",alignItems:"center",mr:2,mb:{xs:1,sm:0},children:[e.jsx(k,{size:"small",onClick:ge,disabled:$,children:e.jsx(zs,{})}),e.jsx(j,{variant:"outlined",startIcon:e.jsx(is,{}),onClick:he,disabled:$,sx:{mx:1},children:"Hoje"}),e.jsx(k,{size:"small",onClick:me,disabled:$,children:e.jsx(Ds,{})}),e.jsx(t,{variant:"subtitle1",sx:{ml:2,minWidth:200},children:M(_,"MMMM yyyy",{locale:Q})})]}),e.jsx(a,{display:"flex",ml:"auto",children:e.jsxs(Ve,{value:Y,onChange:(u,i)=>C(i),sx:{"& .MuiTabs-indicator":{display:"none"},"& .MuiTab-root":{minWidth:"auto",px:2,py:1,"&.Mui-selected":{bgcolor:"primary.main",color:"primary.contrastText",borderRadius:1}}},children:[e.jsx(O,{value:"day",label:"Dia",icon:e.jsx(Ps,{}),iconPosition:"start"}),e.jsx(O,{value:"week",label:"Semana",icon:e.jsx(Ms,{}),iconPosition:"start"}),e.jsx(O,{value:"timetable",label:"Grade",icon:e.jsx($s,{}),iconPosition:"start"})]})})]})})}),$?e.jsx(a,{display:"flex",justifyContent:"center",my:8,children:e.jsx(CircularProgress,{})}):G?e.jsx(Alert,{severity:"error",sx:{mb:3},children:G}):Y==="day"?te():Y==="timetable"?Ie():be(),e.jsx(Es,{open:R,onClose:J,maxWidth:"sm",fullWidth:!0,children:e.jsxs("form",{onSubmit:n,children:[e.jsx(Ws,{children:v.id?"Editar Horário":"Adicionar Novo Horário"}),e.jsx(Bs,{dividers:!0,children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,children:e.jsxs(Ze,{fullWidth:!0,variant:"outlined",margin:"normal",required:!0,children:[e.jsx(Ue,{id:"class-select-label",children:"Matéria"}),e.jsx(Xe,{labelId:"class-select-label",id:"classId",name:"classId",value:L,onChange:u=>q(u.target.value),label:"Matéria",required:!0,children:as.map(u=>e.jsx(T,{value:u.id,children:e.jsxs(a,{display:"flex",alignItems:"center",children:[e.jsx(a,{sx:{width:16,height:16,borderRadius:"50%",bgcolor:u.color,mr:1.5}}),u.name]})},u.id))})]})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs(Ze,{fullWidth:!0,variant:"outlined",margin:"normal",required:!0,children:[e.jsx(Ue,{id:"day-select-label",children:"Dia da Semana"}),e.jsxs(Xe,{labelId:"day-select-label",id:"dayOfWeek",name:"dayOfWeek",value:v.dayOfWeek,onChange:Z,label:"Dia da Semana",required:!0,children:[e.jsx(T,{value:1,children:"Segunda-feira"}),e.jsx(T,{value:2,children:"Terça-feira"}),e.jsx(T,{value:3,children:"Quarta-feira"}),e.jsx(T,{value:4,children:"Quinta-feira"}),e.jsx(T,{value:5,children:"Sexta-feira"}),e.jsx(T,{value:6,children:"Sábado"}),e.jsx(T,{value:7,children:"Domingo"})]})]})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(pe,{fullWidth:!0,variant:"outlined",margin:"normal",id:"room",name:"room",label:"Sala",value:v.room,onChange:Z,required:!0})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(pe,{fullWidth:!0,variant:"outlined",margin:"normal",id:"startTime",name:"startTime",label:"Hora de Início",type:"time",value:v.startTime,onChange:Z,InputLabelProps:{shrink:!0},inputProps:{step:300},required:!0})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(pe,{fullWidth:!0,variant:"outlined",margin:"normal",id:"endTime",name:"endTime",label:"Hora de Término",type:"time",value:v.endTime,onChange:Z,InputLabelProps:{shrink:!0},inputProps:{step:300},required:!0})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(pe,{fullWidth:!0,variant:"outlined",margin:"normal",id:"teacher",name:"teacher",label:"Professor",value:v.teacher,onChange:Z,required:!0})})]})}),e.jsxs(Os,{sx:{p:2,borderTop:1,borderColor:"divider"},children:[e.jsx(j,{onClick:J,color:"inherit",children:"Cancelar"}),e.jsx(j,{type:"submit",variant:"contained",color:"primary",disabled:!L,children:v.id?"Salvar Alterações":"Adicionar Horário"})]})]})})]})},ct=Object.freeze(Object.defineProperty({__proto__:null,default:Us},Symbol.toStringTag,{value:"Module"}));export{ot as A,lt as C,dt as a,ct as b};
