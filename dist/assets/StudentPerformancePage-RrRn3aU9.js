import{u as A,r as o,s as B,z as q,j as e,o as z,m as i,k as y,A as N,S as w,T as L,B as T}from"./main-Cv3DLBs1.js";import{P as u}from"./PremiumCard-C8PJt07T.js";import{E as S}from"./EmptyState-BvWI2uN2.js";import{C as O,a as I}from"./chart-pie-1aimbkvm.js";import"./PremiumButton-DEtqLbhG.js";const Y=()=>{const{user:c}=A(),[G,g]=o.useState(!0),[n,k]=o.useState({totalGrades:0,averageGrade:0,bestGrade:0,worstGrade:0,improvementRate:0}),[m,M]=o.useState([]),[U,R]=o.useState([]),[h,$]=o.useState([]);o.useEffect(()=>{c&&C()},[c]);const C=async()=>{try{g(!0);const{data:a,error:r}=await B.from("submissions").select(`
          *,
          activities(
            id,
            title,
            max_score,
            activity_class_assignments(
              class_id,
              classes(name, subject)
            )
          )
        `).eq("student_id",c.id).not("grade","is",null).order("graded_at",{ascending:!0});if(r)throw r;if(a&&a.length>0){const l=a.map(t=>t.grade),H=l.reduce((t,s)=>t+s,0)/l.length,P=Math.max(...l),D=Math.min(...l),p=Math.floor(l.length/2),v=l.slice(0,p),f=l.slice(p),j=v.reduce((t,s)=>t+s,0)/v.length,b=(f.reduce((t,s)=>t+s,0)/f.length-j)/j*100;k({totalGrades:a.length,averageGrade:H,bestGrade:P,worstGrade:D,improvementRate:isNaN(b)?0:b});const d={};a.forEach(t=>{const s=t.activity?.class?.subject||"Outros";d[s]||(d[s]={grades:[],subject:s}),d[s].grades.push(t.grade)});const F=Object.values(d).map(t=>({subject:t.subject,average:t.grades.reduce((s,_)=>s+_,0)/t.grades.length,count:t.grades.length,best:Math.max(...t.grades),worst:Math.min(...t.grades)})).sort((t,s)=>s.average-t.average);M(F),R(a.slice(-10)),$(a.slice(-5).reverse())}}catch(a){console.error("Erro ao carregar desempenho:",a),q.error("Erro ao carregar seus dados")}finally{g(!1)}},x=a=>a>=9?"from-green-500 to-emerald-500":a>=7?"from-blue-500 to-cyan-500":a>=5?"from-yellow-500 to-orange-500":"from-red-500 to-pink-500",E=a=>a>=7?"text-green-600 bg-green-100 dark:bg-green-900/30":a>=5?"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/30":"text-red-600 bg-red-100 dark:bg-red-900/30";return G?e.jsx(z,{message:"Analisando seu desempenho..."}):e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs(i.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 p-8 text-white",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"32px 32px"}})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs(i.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.2},className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm rounded-full px-4 py-2 mb-4",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Analytics de Performance"})]}),e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Meu Desempenho ðŸ“Š"}),e.jsx("p",{className:"text-white/90 text-lg",children:"Acompanhe sua evoluÃ§Ã£o e identifique oportunidades"})]}),e.jsx(i.div,{animate:{y:[0,-10,0],rotate:[0,5,0]},transition:{duration:3,repeat:1/0},className:"absolute top-20 right-32 w-20 h-20 bg-white/10 backdrop-blur-sm rounded-2xl flex items-center justify-center text-2xl",children:"ðŸ“ˆ"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{title:"MÃ©dia Geral",value:n.averageGrade.toFixed(1),icon:N,gradient:n.averageGrade>=7?"from-green-500 to-emerald-500":"from-yellow-500 to-orange-500",subtitle:`${n.totalGrades} avaliaÃ§Ãµes`},{title:"Melhor Nota",value:n.bestGrade.toFixed(1),icon:w,gradient:"from-yellow-500 to-orange-500",subtitle:"ParabÃ©ns! ðŸŽ‰"},{title:"Taxa de Melhoria",value:`${n.improvementRate>0?"+":""}${n.improvementRate.toFixed(1)}%`,icon:L,gradient:n.improvementRate>=0?"from-green-500 to-emerald-500":"from-red-500 to-pink-500",subtitle:n.improvementRate>=0?"Evoluindo! ðŸ“ˆ":"Precisa atenÃ§Ã£o"},{title:"Disciplinas",value:m.length,icon:T,gradient:"from-purple-500 to-indigo-500",subtitle:"Diferentes matÃ©rias"}].map((a,r)=>e.jsx(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1},children:e.jsxs(u,{variant:"elevated",className:"relative overflow-hidden group hover:scale-105 transition-transform",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${a.gradient} opacity-5 group-hover:opacity-10 transition-opacity`}),e.jsxs("div",{className:"relative p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${a.gradient} text-white`,children:e.jsx(a.icon,{className:"w-6 h-6"})})}),e.jsx("div",{className:"text-3xl font-bold mb-1",children:a.value}),e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:a.title}),e.jsx("div",{className:"text-xs font-medium text-primary",children:a.subtitle})]})]})},a.title))}),e.jsx(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsxs(u,{variant:"elevated",className:"p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-blue-500/10 to-purple-500/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-1",children:"Desempenho por Disciplina"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Compare suas mÃ©dias em cada matÃ©ria"})]}),e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-blue-500 to-purple-500 text-white",children:e.jsx(O,{className:"w-5 h-5"})})]}),m.length===0?e.jsx(S,{icon:y,title:"Nenhum dado ainda",description:"Suas estatÃ­sticas aparecerÃ£o aqui apÃ³s as primeiras avaliaÃ§Ãµes"}):e.jsx("div",{className:"space-y-4",children:m.map((a,r)=>e.jsxs(i.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:r*.1},className:"space-y-2 p-4 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full bg-gradient-to-r ${x(a.average)}`}),e.jsx("span",{className:"font-medium",children:a.subject}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",a.count," avaliaÃ§Ãµes)"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${E(a.average)}`,children:a.average.toFixed(1)}),a.average>=7&&e.jsx(w,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"})]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-3 overflow-hidden",children:e.jsx(i.div,{initial:{width:0},animate:{width:`${a.average/10*100}%`},transition:{duration:1,delay:.5+r*.1,type:"spring"},className:`h-full rounded-full bg-gradient-to-r ${x(a.average)}`})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Menor: ",a.worst.toFixed(1)]}),e.jsxs("span",{children:[(a.average/10*100).toFixed(0),"%"]}),e.jsxs("span",{children:["Maior: ",a.best.toFixed(1)]})]})]},r))})]})]})}),e.jsx(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:e.jsxs(u,{variant:"elevated",className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-1",children:"Ãšltimas AvaliaÃ§Ãµes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"HistÃ³rico recente de notas"})]}),e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-green-500 to-emerald-500 text-white",children:e.jsx(I,{className:"w-5 h-5"})})]}),h.length===0?e.jsx(S,{icon:N,title:"Nenhuma avaliaÃ§Ã£o ainda",description:"Suas notas aparecerÃ£o aqui"}):e.jsx("div",{className:"space-y-3",children:h.map((a,r)=>e.jsxs(i.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:r*.05},className:"flex items-center justify-between p-4 border-2 border-border rounded-xl hover:border-primary/50 hover:bg-gradient-to-r hover:from-muted/50 hover:to-transparent transition-all",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold mb-1",children:a.activity?.title}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["ðŸ“š ",a.activity?.class?.name]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["ðŸ“… ",new Date(a.graded_at).toLocaleDateString("pt-BR")]})]})]}),e.jsx(i.div,{whileHover:{scale:1.1},className:`w-20 h-20 rounded-2xl bg-gradient-to-br ${x(a.grade)} flex items-center justify-center text-white shadow-lg`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold",children:a.grade}),e.jsxs("p",{className:"text-xs opacity-90",children:["/",a.activity?.max_score||10]})]})})]},a.id))})]})})]})};export{Y as default};
