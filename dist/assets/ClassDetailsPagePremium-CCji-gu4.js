import{ak as R,g as q,u as U,r as d,s as p,z as x,j as e,o as $,U as b,T as G,B as h,a0 as V,m as g,A as M,C as H,b as k}from"./main-NgjJy_CG.js";import{P as u}from"./PremiumCard-BGO_It48.js";import{P as n}from"./PremiumButton-DDGOGflQ.js";import{E as v}from"./EmptyState-Cb7n_MKP.js";import{B as O}from"./Breadcrumb-CheJibX4.js";import{C}from"./classInviteService-De5A2lJT.js";import{A as F}from"./arrow-left-MOSQdYvL.js";import{U as y}from"./user-plus-DbpNqADK.js";import{E as J}from"./ellipsis-vertical-CZUUuaw-.js";import{P as A}from"./pen-DhIR7sv9.js";import{S as T}from"./share-2-DF9qqgs_.js";import{T as E}from"./trash-2-Bhwmq7t6.js";const ne=()=>{const{classId:t}=R(),r=q(),{user:f}=U(),[I,N]=d.useState(!0),[a,S]=d.useState(null),[o,D]=d.useState([]),[i,L]=d.useState([]),[l,_]=d.useState("overview"),[K,Q]=d.useState(!1);d.useEffect(()=>{t&&f&&P()},[t,f]);const P=async()=>{try{N(!0);const[s,m,j]=await Promise.all([p.from("classes").select("*").eq("id",t).single(),p.from("class_members").select(`
            *,
            user:profiles(id, name, email, avatar_url)
          `).eq("class_id",t).eq("role","student"),p.from("activities").select("*").eq("class_id",t).order("created_at",{ascending:!1}).limit(10)]);if(s.error)throw s.error;if(m.error)throw m.error;if(j.error)throw j.error;S(s.data),D(m.data||[]),L(j.data||[])}catch(s){console.error("Erro ao carregar detalhes da turma:",s),x.error("Erro ao carregar turma")}finally{N(!1)}},c=async()=>{try{const s=await C.createInvite(t,{maxUses:50,expiresInHours:168}),m=C.getInviteLink(s.invitation_code);await navigator.clipboard.writeText(m),x.success("Link de convite copiado!",{description:"Compartilhe com seus alunos"})}catch(s){console.error("Erro ao gerar convite:",s),x.error("Erro ao gerar link de convite")}},w=async()=>{if(confirm("Tem certeza que deseja excluir esta turma? Esta ação não pode ser desfeita."))try{const{error:s}=await p.from("classes").delete().eq("id",t);if(s)throw s;x.success("Turma excluída com sucesso"),r("/dashboard/classes")}catch(s){console.error("Erro ao excluir turma:",s),x.error("Erro ao excluir turma")}};if(I)return e.jsx($,{message:"Carregando turma..."});if(!a)return e.jsx(v,{icon:b,title:"Turma não encontrada",description:"A turma que você está procurando não existe ou foi removida.",actionLabel:"Voltar para Turmas",onAction:()=>r("/dashboard/classes")});const z=[{label:"Turmas",path:"/dashboard/classes"},{label:a.name,path:`/dashboard/classes/${t}`}],B=[{id:"overview",label:"Visão Geral",icon:G},{id:"students",label:"Alunos",icon:b,count:o.length},{id:"activities",label:"Atividades",icon:h,count:i.length},{id:"settings",label:"Configurações",icon:V}];return e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsx(O,{items:z}),e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative overflow-hidden bg-gradient-to-br from-blue-600 via-purple-600 to-indigo-600 rounded-3xl p-8 text-white",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 1px 1px, white 1px, transparent 0)",backgroundSize:"40px 40px"}})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("button",{onClick:()=>r("/dashboard/classes"),className:"flex items-center gap-2 text-white/80 hover:text-white transition-colors mb-4",children:[e.jsx(F,{className:"w-4 h-4"}),"Voltar para Turmas"]}),e.jsx("h1",{className:"text-4xl font-bold mb-2",children:a.name}),a.description&&e.jsx("p",{className:"text-white/90 text-lg max-w-2xl",children:a.description}),a.subject&&e.jsxs("p",{className:"text-white/70 mt-2",children:["Disciplina: ",a.subject]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{variant:"outline",size:"sm",leftIcon:y,onClick:c,className:"bg-white/10 border-white/20 hover:bg-white/20 text-white",children:"Convidar Alunos"}),e.jsxs("div",{className:"relative group",children:[e.jsx("button",{className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors",children:e.jsx(J,{className:"w-5 h-5"})}),e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50 border border-border",children:[e.jsxs("button",{onClick:()=>r(`/dashboard/classes/${t}/edit`),className:"w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-muted transition-colors",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{children:"Editar Turma"})]}),e.jsxs("button",{onClick:c,className:"w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-muted transition-colors",children:[e.jsx(T,{className:"w-4 h-4"}),e.jsx("span",{children:"Compartilhar"})]}),e.jsx("div",{className:"border-t border-border"}),e.jsxs("button",{onClick:w,className:"w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-destructive/10 text-destructive transition-colors rounded-b-lg",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{children:"Excluir Turma"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(b,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/70",children:"Alunos"}),e.jsx("p",{className:"text-2xl font-bold",children:o.length})]})]})}),e.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(h,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/70",children:"Atividades"}),e.jsx("p",{className:"text-2xl font-bold",children:i.length})]})]})}),e.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(M,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/70",children:"Média"}),e.jsx("p",{className:"text-2xl font-bold",children:"--"})]})]})}),e.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(H,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/70",children:"Criada em"}),e.jsx("p",{className:"text-sm font-medium",children:new Date(a.created_at).toLocaleDateString("pt-BR")})]})]})})]})]})]}),e.jsx("div",{className:"border-b border-border",children:e.jsx("div",{className:"flex gap-1",children:B.map(s=>e.jsxs("button",{onClick:()=>_(s.id),className:`flex items-center gap-2 px-6 py-3 font-medium transition-colors relative ${l===s.id?"text-primary":"text-slate-700 dark:text-slate-300 hover:text-foreground"}`,children:[e.jsx(s.icon,{className:"w-4 h-4"}),s.label,s.count!==void 0&&e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-muted",children:s.count}),l===s.id&&e.jsx(g.div,{layoutId:"activeTab",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"})]},s.id))})}),e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[l==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(u,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Informações da Turma"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Nome"}),e.jsx("p",{className:"font-medium",children:a.name})]}),a.description&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Descrição"}),e.jsx("p",{className:"font-medium",children:a.description})]}),a.subject&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Disciplina"}),e.jsx("p",{className:"font-medium",children:a.subject})]}),a.class_code&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Código da Turma"}),e.jsx("p",{className:"font-medium font-mono",children:a.class_code})]})]})]})}),e.jsx(u,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Atividades Recentes"}),i.length===0?e.jsx(v,{icon:h,title:"Nenhuma atividade",description:"Crie a primeira atividade para esta turma"}):e.jsx("div",{className:"space-y-2",children:i.slice(0,5).map(s=>e.jsxs(k,{to:`/dashboard/activities/${s.id}`,className:"block p-3 rounded-lg border border-border hover:bg-muted/50 transition-colors",children:[e.jsx("p",{className:"font-medium line-clamp-1",children:s.title}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:new Date(s.created_at).toLocaleDateString("pt-BR")})]},s.id))})]})})]}),l==="students"&&e.jsx(u,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold",children:["Alunos (",o.length,")"]}),e.jsx(n,{variant:"gradient",size:"sm",leftIcon:y,onClick:c,children:"Convidar Alunos"})]}),o.length===0?e.jsx(v,{icon:b,title:"Nenhum aluno na turma",description:"Gere um link de convite para adicionar alunos",actionLabel:"Gerar Convite",onAction:c}):e.jsx("div",{className:"space-y-2",children:o.map(s=>e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-lg border border-border hover:bg-muted/50 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold",children:s.user?.name?.charAt(0)||"A"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:s.user?.name||"Aluno"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:s.user?.email})]}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300",children:"Ativo"})]},s.id))})]})}),l==="activities"&&e.jsx(u,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold",children:["Atividades (",i.length,")"]}),e.jsx(n,{variant:"gradient",size:"sm",leftIcon:h,onClick:()=>r("/dashboard/activities/new"),children:"Nova Atividade"})]}),i.length===0?e.jsx(v,{icon:h,title:"Nenhuma atividade criada",description:"Crie atividades para avaliar seus alunos",actionLabel:"Criar Atividade",onAction:()=>r("/dashboard/activities/new")}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map(s=>e.jsxs(k,{to:`/dashboard/activities/${s.id}`,className:"block p-4 rounded-lg border border-border hover:bg-muted/50 hover:border-primary/50 transition-all",children:[e.jsx("h4",{className:"font-medium mb-2 line-clamp-1",children:s.title}),s.description&&e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 line-clamp-2 mb-3",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:new Date(s.created_at).toLocaleDateString("pt-BR")}),s.due_date&&e.jsxs("span",{className:"px-2 py-1 rounded-full bg-warning/10 text-warning",children:["Prazo: ",new Date(s.due_date).toLocaleDateString("pt-BR")]})]})]},s.id))})]})}),l==="settings"&&e.jsx(u,{variant:"elevated",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-6",children:"Configurações da Turma"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(n,{variant:"outline",leftIcon:A,onClick:()=>r(`/dashboard/classes/${t}/edit`),children:"Editar Informações"}),e.jsx(n,{variant:"outline",leftIcon:T,onClick:c,children:"Gerar Novo Link de Convite"}),e.jsxs("div",{className:"border-t border-border pt-4",children:[e.jsx(n,{variant:"destructive",leftIcon:E,onClick:w,children:"Excluir Turma"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 mt-2",children:"Esta ação não pode ser desfeita. Todos os dados serão permanentemente removidos."})]})]})]})})]},l)]})};export{ne as default};
