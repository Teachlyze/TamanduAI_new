import{g as q,u as A,r,s as m,z as g,j as e,o as M,m as n,U as f,B as v,T as D,ah as y,K as U,$ as F,d as H,a0 as C}from"./main-NgjJy_CG.js";import{P as b}from"./PremiumCard-BGO_It48.js";import{P as o}from"./PremiumButton-DDGOGflQ.js";import{E as k}from"./EmptyState-Cb7n_MKP.js";import{B as S}from"./badge-DS8upoqS.js";import{P as Q}from"./plus-BItzgCLM.js";import{G as K}from"./grid-3x3-lItUO4Hb.js";import{L as O}from"./list-CKRPLVFM.js";import{A as V}from"./arrow-right-Cb_gU53R.js";import{S as W}from"./share-2-DF9qqgs_.js";const re=()=>{const d=q(),{user:x}=A(),[P,j]=r.useState(!0),[s,T]=r.useState([]),[w,u]=r.useState([]),[l,L]=r.useState(""),[p,N]=r.useState("grid");r.useEffect(()=>{x&&z()},[x]),r.useEffect(()=>{if(l){const a=s.filter(t=>t.name?.toLowerCase().includes(l.toLowerCase())||t.subject?.toLowerCase().includes(l.toLowerCase()));u(a)}else u(s)},[l,s]);const z=async()=>{try{j(!0);const{data:a,error:t}=await m.from("classes").select("*").eq("created_by",x.id).order("created_at",{ascending:!1});if(t)throw t;const i=await Promise.all((a||[]).map(async c=>{const[E,G,_]=await Promise.all([m.from("class_members").select("id",{count:"exact",head:!0}).eq("class_id",c.id).eq("role","student"),m.from("activities").select("id",{count:"exact",head:!0}).eq("class_id",c.id),m.from("submissions").select("grade").eq("class_id",c.id).not("grade","is",null)]),h=_.data||[],$=h.length>0?h.reduce((B,R)=>B+(R.grade||0),0)/h.length:0;return{...c,studentsCount:E.count||0,activitiesCount:G.count||0,averageGrade:$}}));T(i),u(i)}catch(a){console.error("Erro ao carregar turmas:",a),g.error("Erro ao carregar turmas")}finally{j(!1)}};return P?e.jsx(M,{message:"Carregando suas turmas..."}):e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs(n.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-500 via-cyan-500 to-teal-500 p-8 text-white",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"32px 32px"}})}),e.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(n.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.2},className:"whitespace-nowrap inline-flex items-center gap-2 min-w-fit bg-white/20 backdrop-blur-sm rounded-full px-4 py-2 mb-4",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"GestÃ£o de Turmas"})]}),e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Minhas Turmas ðŸ“š"}),e.jsx("p",{className:"text-white/90 text-lg",children:"Gerencie suas turmas, alunos e atividades"})]}),e.jsx(n.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.3},children:e.jsx(o,{leftIcon:Q,onClick:()=>d("/dashboard/classes/new"),className:"bg-white text-blue-600 hover:bg-white/90 shadow-lg whitespace-nowrap inline-flex items-center gap-2 min-w-fit font-semibold border-2 border-white/20 px-6 py-2.5",children:"Nova Turma"})})]}),e.jsx(n.div,{animate:{y:[0,-15,0],rotate:[0,10,0]},transition:{duration:4,repeat:1/0},className:"absolute top-10 right-20 text-6xl opacity-20",children:"ðŸ“š"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{title:"Total de Turmas",value:s.length,icon:v,gradient:"from-blue-500 to-cyan-500"},{title:"Total de Alunos",value:s.reduce((a,t)=>a+(t.studentsCount||0),0),icon:f,gradient:"from-green-500 to-emerald-500"},{title:"Performance MÃ©dia",value:s.length>0?`${(s.reduce((a,t)=>a+(t.averageGrade||0),0)/s.length).toFixed(1)}%`:"0%",icon:D,gradient:"from-purple-500 to-pink-500"}].map((a,t)=>e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.1},children:e.jsxs(b,{variant:"elevated",className:"relative overflow-hidden group hover:scale-105 transition-transform",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${a.gradient} opacity-5 group-hover:opacity-10 transition-opacity`}),e.jsxs("div",{className:"relative p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${a.gradient} text-white`,children:e.jsx(a.icon,{className:"w-6 h-6"})})}),e.jsx("div",{className:"text-3xl font-bold mb-1 text-slate-900 dark:text-white",children:a.value}),e.jsx("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:a.title})]})]})},a.title))}),e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsx(b,{variant:"elevated",className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"flex-1 relative w-full",children:[e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(U,{placeholder:"Buscar turmas por nome ou disciplina...",value:l,onChange:a=>L(a.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:p==="grid"?"default":"outline",size:"sm",onClick:()=>N("grid"),leftIcon:K,className:"whitespace-nowrap inline-flex items-center gap-2 min-w-fit px-4 py-2 bg-white dark:bg-slate-900 text-foreground border-border",children:"Grade"}),e.jsx(o,{variant:p==="list"?"default":"outline",size:"sm",onClick:()=>N("list"),leftIcon:O,className:"whitespace-nowrap inline-flex items-center gap-2 min-w-fit px-4 py-2 bg-white dark:bg-slate-900 text-foreground border-border",children:"Lista"})]})]})})}),w.length===0?s.length===0?e.jsx(k,{icon:v,title:"Nenhuma turma criada",description:"Crie sua primeira turma para comeÃ§ar a gerenciar alunos e atividades",action:{label:"Criar Primeira Turma",onClick:()=>d("/dashboard/classes/new")}}):e.jsx(k,{icon:y,title:"Nenhuma turma encontrada",description:"Tente ajustar sua busca"}):e.jsx("div",{className:`grid ${p==="grid"?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3":"grid-cols-1"} gap-4`,children:e.jsx(F,{children:w.map((a,t)=>e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9},transition:{delay:t*.05},layout:!0,children:e.jsxs(b,{variant:"elevated",className:"group relative overflow-hidden hover:scale-105 transition-all cursor-pointer",onClick:()=>d(`/dashboard/classes/${a.id}`),children:[e.jsxs("div",{className:`h-24 bg-gradient-to-r ${a.color||"from-blue-500 to-cyan-500"} relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 opacity-20",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"20px 20px"}})}),e.jsx("div",{className:"absolute bottom-4 left-4 right-4",children:e.jsx("h3",{className:"text-xl font-bold text-white truncate",children:a.name})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(S,{className:"bg-primary/10 text-primary",children:a.subject||"Geral"}),a.schedule&&e.jsxs(S,{variant:"outline",className:"bg-white dark:bg-slate-900 text-foreground border-border text-xs",children:[e.jsx(H,{className:"w-3 h-3 mr-1"}),(()=>{try{const i=new Date(a.schedule);return isNaN(i.getTime())?"HorÃ¡rio nÃ£o definido":i.toLocaleDateString("pt-BR",{weekday:"short",hour:"2-digit",minute:"2-digit"})}catch{return"HorÃ¡rio nÃ£o definido"}})()]})]}),a.description&&e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 line-clamp-2 mb-4",children:a.description}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-border",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:a.studentsCount}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:"alunos"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:a.activitiesCount}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:"atividades"})]})]}),e.jsx(V,{className:"w-5 h-5 text-muted-foreground group-hover:text-primary group-hover:translate-x-1 transition-all"})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(o,{size:"sm",variant:"outline",leftIcon:W,onClick:i=>{i.stopPropagation(),a.invite_code?(navigator.clipboard.writeText(a.invite_code),g.success("CÃ³digo copiado!")):g.error("CÃ³digo de convite nÃ£o disponÃ­vel")},className:"flex-1 whitespace-nowrap inline-flex items-center gap-2 min-w-fit px-3 py-2 bg-white dark:bg-slate-900 text-foreground border-border rounded-lg",children:"Convidar"}),e.jsx(o,{size:"sm",variant:"outline",leftIcon:C,onClick:i=>{i.stopPropagation(),d(`/dashboard/classes/${a.id}/edit`)},className:"whitespace-nowrap inline-flex items-center gap-2 min-w-fit px-3 py-2 bg-white dark:bg-slate-900 text-foreground border-border rounded-lg",children:e.jsx(C,{className:"w-4 h-4"})})]})]})]})},a.id))})})]})};export{re as default};
