import{g as A,u as I,r as o,s as c,z as i,j as e,o as R,p as d}from"./main-Bq8SWujy.js";import{P as b}from"./PremiumCard-DFrgcJpK.js";import{P as m}from"./PremiumButton-BPiMyuHl.js";import{B as z}from"./Breadcrumb-Cla5EEAT.js";import{A as B}from"./arrow-left-CQUPNNb_.js";import{C as M}from"./camera-C-1QjJrf.js";import{U as q}from"./upload-NagiCVEJ.js";import{U as F}from"./user-DoxquNKa.js";import{M as L}from"./mail-iM41uEnE.js";import{P as O}from"./phone-7n5-i6Gk.js";import{M as T}from"./map-pin-Dz5VM89j.js";import{B as G}from"./bell-CJaV6E7G.js";import{S as H}from"./save-Bsl1Ij5S.js";const oe=()=>{const u=A(),{user:r}=I(),[S,g]=o.useState(!0),[f,U]=o.useState("teacher"),[j,v]=o.useState(!1),[n,N]=o.useState(!1),[a,t]=o.useState({full_name:"",email:"",phone:"",bio:"",institution:"",subjects:[],preferences:{notifications:!0,emailDigest:!0,darkMode:!1}}),[p,w]=o.useState("");o.useEffect(()=>{if(r){const s=r?.user_metadata?.role||"teacher";U(s),k()}},[r]);const k=async()=>{try{g(!0);const{data:s,error:l}=await c.from("profiles").select("*").eq("id",r.id).single();if(l)throw l;s&&(t({full_name:s.full_name||"",email:s.email||r.email||"",phone:s.phone||"",bio:s.bio||"",institution:s.institution||"",subjects:s.subjects||[],preferences:s.preferences||{notifications:!0,emailDigest:!0,darkMode:!1}}),w(s.avatar_url||""))}catch(s){console.error("Erro ao carregar perfil:",s),i.error("Erro ao carregar perfil")}finally{g(!1)}},y=async s=>{const l=s.target.files?.[0];if(l)try{N(!0);const x=l.name.split(".").pop(),P=`avatars/${`${r.id}-${Date.now()}.${x}`}`,{error:E}=await c.storage.from("profiles").upload(P,l);if(E)throw E;const{data:$}=c.storage.from("profiles").getPublicUrl(P);w($.publicUrl),i.success("Avatar atualizado!")}catch(x){console.error("Erro ao fazer upload:",x),i.error("Erro ao fazer upload do avatar")}finally{N(!1)}},D=async()=>{try{v(!0);const{error:s}=await c.from("profiles").update({full_name:a.full_name,phone:a.phone,bio:a.bio,institution:a.institution,subjects:a.subjects,preferences:a.preferences,avatar_url:p,updated_at:new Date().toISOString()}).eq("id",r.id);if(s)throw s;i.success("Perfil atualizado com sucesso!"),u(`${f==="student"?"/students":f==="school"?"/school":"/dashboard"}/settings`)}catch(s){console.error("Erro ao salvar:",s),i.error("Erro ao salvar perfil")}finally{v(!1)}};if(S)return e.jsx(R,{message:"Carregando perfil..."});const h=()=>{switch(f){case"student":return"/students";case"school":return"/school";default:return"/dashboard"}},C=h(),_=[{label:"Dashboard",path:C},{label:"Configurações",path:`${C}/settings`},{label:"Editar Perfil",path:"/profile/edit"}];return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 p-6",children:e.jsxs("div",{className:"space-y-6 max-w-4xl mx-auto",children:[e.jsx(z,{items:_}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Editar Perfil"}),e.jsx("p",{className:"text-muted-foreground",children:"Atualize suas informações pessoais"})]}),e.jsx(m,{variant:"outline",leftIcon:B,onClick:()=>u(`${h()}/settings`),children:"Cancelar"})]}),e.jsx(b,{variant:"elevated",className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-4xl font-bold text-white overflow-hidden",children:p?e.jsx("img",{src:p,alt:"Avatar",className:"w-full h-full object-cover"}):a.full_name?.charAt(0)||r.email?.charAt(0)||"U"}),e.jsxs("label",{className:"absolute bottom-0 right-0 p-2 bg-primary rounded-full cursor-pointer hover:bg-primary/90 transition-colors",children:[e.jsx(M,{className:"w-4 h-4 text-white"}),e.jsx("input",{type:"file",accept:"image/*",onChange:y,className:"hidden",disabled:n})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-1",children:"Foto de Perfil"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Recomendamos uma imagem quadrada de pelo menos 200x200px"}),e.jsxs("label",{children:[e.jsx(m,{variant:"outline",size:"sm",leftIcon:q,disabled:n,as:"span",children:n?"Enviando...":"Fazer Upload"}),e.jsx("input",{type:"file",accept:"image/*",onChange:y,className:"hidden",disabled:n})]})]})]})}),e.jsxs(b,{variant:"elevated",className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(F,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-xl font-bold",children:"Informações Pessoais"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Nome Completo"}),e.jsx(d,{value:a.full_name,onChange:s=>t({...a,full_name:s.target.value}),placeholder:"Seu nome completo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"E-mail"}),e.jsx(d,{type:"email",value:a.email,disabled:!0,leftIcon:L,placeholder:"seu@email.com"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"E-mail não pode ser alterado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Telefone"}),e.jsx(d,{type:"tel",value:a.phone,onChange:s=>t({...a,phone:s.target.value}),leftIcon:O,placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Instituição"}),e.jsx(d,{value:a.institution,onChange:s=>t({...a,institution:s.target.value}),leftIcon:T,placeholder:"Nome da instituição"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Biografia"}),e.jsx("textarea",{value:a.bio,onChange:s=>t({...a,bio:s.target.value}),rows:4,className:"w-full px-4 py-3 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none",placeholder:"Conte um pouco sobre você..."})]})]})]}),e.jsxs(b,{variant:"elevated",className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(G,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-xl font-bold",children:"Preferências"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border border-border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Notificações Push"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receba alertas em tempo real"})]}),e.jsx("button",{onClick:()=>t({...a,preferences:{...a.preferences,notifications:!a.preferences.notifications}}),className:`w-12 h-6 rounded-full transition-colors ${a.preferences.notifications?"bg-primary":"bg-muted"}`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transition-transform ${a.preferences.notifications?"translate-x-6":"translate-x-0.5"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border border-border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Resumo Diário por E-mail"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receba um resumo das atividades do dia"})]}),e.jsx("button",{onClick:()=>t({...a,preferences:{...a.preferences,emailDigest:!a.preferences.emailDigest}}),className:`w-12 h-6 rounded-full transition-colors ${a.preferences.emailDigest?"bg-primary":"bg-muted"}`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transition-transform ${a.preferences.emailDigest?"translate-x-6":"translate-x-0.5"}`})})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx(m,{variant:"outline",onClick:()=>u(`${h()}/settings`),children:"Cancelar"}),e.jsx(m,{variant:"gradient",leftIcon:H,onClick:D,disabled:j,children:j?"Salvando...":"Salvar Alterações"})]})]})})};export{oe as default};
