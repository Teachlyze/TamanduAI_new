import{g as z,u as T,r as l,s as g,z as B,j as e,o as D,m as t,ag as f,C as w,c as y,ah as C,K as q,$ as F,d as R,U,T as M,O}from"./main-NgjJy_CG.js";import{P as b}from"./PremiumCard-BGO_It48.js";import{P as p}from"./PremiumButton-DDGOGflQ.js";import{E as k}from"./EmptyState-Cb7n_MKP.js";import{B as Q}from"./badge-DS8upoqS.js";import{P as G}from"./plus-BItzgCLM.js";import{C as K}from"./circle-check-big-dDW7KbJv.js";import{S}from"./square-pen-eBdyYMhc.js";import{F as V}from"./funnel-CchVKkoO.js";const te=()=>{const c=z(),{user:h}=T(),[P,j]=l.useState(!0),[r,A]=l.useState([]),[v,N]=l.useState([]),[o,E]=l.useState(""),[x,L]=l.useState("all");l.useEffect(()=>{h&&_()},[h]),l.useEffect(()=>{let a=r;o&&(a=a.filter(s=>s.title?.toLowerCase().includes(o.toLowerCase())||s.description?.toLowerCase().includes(o.toLowerCase())||s.classes?.name?.toLowerCase().includes(o.toLowerCase()))),x!=="all"&&(a=a.filter(s=>s.status===x)),N(a)},[o,x,r]);const _=async()=>{try{j(!0);const{data:a,error:s}=await g.from("activities").select("*").eq("created_by",h.id).order("created_at",{ascending:!1});if(s)throw s;const i=await Promise.all((a||[]).map(async n=>{const[u,d]=await Promise.all([g.from("submissions").select("id",{count:"exact",head:!0}).eq("activity_id",n.id),g.from("submissions").select("id",{count:"exact",head:!0}).eq("activity_id",n.id).not("grade","is",null)]);return{...n,totalSubmissions:u.count||0,gradedSubmissions:d.count||0,pendingCorrections:(u.count||0)-(d.count||0)}}));A(i),N(i)}catch(a){console.error("Erro ao carregar atividades:",a),B.error("Erro ao carregar atividades")}finally{j(!1)}},$=a=>{switch(a){case"published":return"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400";case"draft":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400";case"archived":return"bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-400";default:return"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}},I=a=>{switch(a){case"published":return"Publicada";case"draft":return"Rascunho";case"archived":return"Arquivada";default:return a}};if(P)return e.jsx(D,{message:"Carregando suas atividades..."});const m={total:r.length,published:r.filter(a=>a.status==="published").length,draft:r.filter(a=>a.status==="draft").length,pendingCorrections:r.reduce((a,s)=>a+(s.pendingCorrections||0),0)};return e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs(t.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-purple-500 via-pink-500 to-rose-500 p-8 text-white",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"32px 32px"}})}),e.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(t.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.2},className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm rounded-full px-4 py-2 mb-4",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Gestão de Atividades"})]}),e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Minhas Atividades 📝"}),e.jsx("p",{className:"text-slate-900 dark:text-white/90 text-lg",children:"Crie, gerencie e acompanhe as atividades das suas turmas"})]}),e.jsx(t.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.3},children:e.jsx(p,{leftIcon:G,onClick:()=>c("/dashboard/activities/new"),className:"bg-white text-purple-600 hover:bg-white/90 shadow-lg whitespace-nowrap inline-flex items-center gap-2 font-semibold border-2 border-white/20 min-w-fit px-6 py-2.5",children:"Nova Atividade"})})]}),e.jsx(t.div,{animate:{y:[0,-15,0],rotate:[0,-10,0]},transition:{duration:4,repeat:1/0},className:"absolute top-10 right-20 text-6xl opacity-20",children:"📝"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[{title:"Total",value:m.total,icon:f,gradient:"from-purple-500 to-pink-500"},{title:"Publicadas",value:m.published,icon:K,gradient:"from-green-500 to-emerald-500"},{title:"Rascunhos",value:m.draft,icon:S,gradient:"from-yellow-500 to-orange-500"},{title:"Para Corrigir",value:m.pendingCorrections,icon:w,gradient:"from-red-500 to-orange-500",urgent:m.pendingCorrections>0}].map((a,s)=>e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.1},children:e.jsxs(b,{variant:"elevated",className:`relative overflow-hidden group hover:scale-105 transition-transform ${a.urgent?"border-2 border-orange-300 dark:border-orange-700":""}`,children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${a.gradient} opacity-5 group-hover:opacity-10 transition-opacity`}),e.jsxs("div",{className:"relative p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${a.gradient} text-white`,children:e.jsx(a.icon,{className:"w-6 h-6"})}),a.urgent&&e.jsx(t.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},children:e.jsx(y,{className:"w-5 h-5 text-orange-600"})})]}),e.jsx("div",{className:"text-3xl font-bold mb-1",children:a.value}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a.title})]})]})},a.title))}),e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsx(b,{variant:"elevated",className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(q,{placeholder:"Buscar atividades...",value:o,onChange:a=>E(a.target.value),className:"pl-10"})]}),e.jsx("div",{className:"flex gap-2",children:["all","published","draft"].map(a=>e.jsx(p,{variant:x===a?"default":"outline",size:"sm",onClick:()=>L(a),leftIcon:V,className:"whitespace-nowrap inline-flex items-center gap-2 min-w-fit px-4 py-2 bg-white dark:bg-slate-900 text-foreground border-border",children:a==="all"?"Todas":a==="published"?"Publicadas":"Rascunhos"},a))})]})})}),v.length===0?r.length===0?e.jsx(k,{icon:f,title:"Nenhuma atividade criada",description:"Crie sua primeira atividade para começar a avaliar seus alunos",action:{label:"Criar Primeira Atividade",onClick:()=>c("/dashboard/activities/new")}}):e.jsx(k,{icon:C,title:"Nenhuma atividade encontrada",description:"Tente ajustar sua busca ou filtros"}):e.jsx("div",{className:"space-y-4",children:e.jsx(F,{children:v.map((a,s)=>{const i=a.due_date?Math.ceil((new Date(a.due_date)-new Date)/864e5):null,n=i!==null&&i<0,u=i!==null&&i>=0&&i<=3;return e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9},transition:{delay:s*.05},layout:!0,children:e.jsx(b,{variant:"elevated",className:`group relative overflow-hidden hover:scale-105 transition-all cursor-pointer ${u?"border-2 border-orange-300 dark:border-orange-700":""}`,onClick:()=>c(`/dashboard/activities/${a.id}`),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold group-hover:text-primary transition-colors",children:a.title}),e.jsx(Q,{className:$(a.status),children:I(a.status)})]}),a.classes&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("div",{className:`w-3 h-3 rounded-full bg-gradient-to-r ${a.classes.color||"from-blue-500 to-cyan-500"}`}),e.jsx("span",{children:a.classes.name}),e.jsx("span",{children:"•"}),e.jsx("span",{children:a.classes.subject})]})]}),(u||n)&&e.jsx(t.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},children:e.jsx(y,{className:`w-6 h-6 ${n?"text-red-600":"text-orange-600"}`})})]}),a.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-4",children:a.description}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-border",children:[e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[a.due_date&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:n?"text-red-600 font-semibold":"",children:new Date(a.due_date).toLocaleDateString("pt-BR")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:a.totalSubmissions}),e.jsx("span",{className:"text-muted-foreground",children:"submissões"})]}),a.pendingCorrections>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4 text-orange-600"}),e.jsx("span",{className:"font-medium text-orange-600",children:a.pendingCorrections}),e.jsx("span",{className:"text-muted-foreground",children:"para corrigir"})]}),a.max_score&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"font-medium",children:a.max_score}),e.jsx("span",{className:"text-muted-foreground",children:"pontos"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{size:"sm",variant:"outline",leftIcon:O,onClick:d=>{d.stopPropagation(),c(`/dashboard/activities/${a.id}`)},className:"whitespace-nowrap inline-flex items-center gap-2 min-w-fit px-4 py-2",children:"Ver"}),e.jsx(p,{size:"sm",variant:"outline",leftIcon:S,onClick:d=>{d.stopPropagation(),c(`/dashboard/activities/edit/${a.id}`)},className:"whitespace-nowrap inline-flex items-center gap-2 min-w-fit px-4 py-2",children:"Editar"})]})]})]})})},a.id)})})})]})};export{te as default};
